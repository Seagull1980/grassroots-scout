import{j as t,B as c,i as b,T as n,v as C,w as $,k as ae,a6 as se,G as i,C as ie,a as le,I as T,V as ne,bF as oe,ap as de,ay as ce,an as w,d as p,a8 as ue,J as he,K as pe,N as xe,F as k,t as F,u as W,q as A,O as u,au as I,Q as ge}from"./mui-vendor-rZ0WLTig.js";import{r as h}from"./react-vendor-CRXLTmIH.js";import{u as me,a as m}from"./admin-features-d6LVy8Ft.js";const ve=()=>{const{user:P}=me(),[y,z]=h.useState([]),[M,q]=h.useState([]),[Y,B]=h.useState(!0),[S,o]=h.useState(""),[E,f]=h.useState(""),[O,G]=h.useState(!1),[x,D]=h.useState(null),[s,j]=h.useState({childId:0,title:"",description:"",preferredLeagues:[],ageGroup:"",positions:[],preferredTeamGender:"Mixed",location:"",contactInfo:"",availability:{days:[],timeSlots:[],notes:""}}),_=["Goalkeeper","Defender","Midfielder","Forward","Centre-Back","Full-Back","Wing-Back","Defensive Midfielder","Central Midfielder","Attacking Midfielder","Winger","Striker"],R=["Premier League Youth","Championship Youth","League One Youth","National League Youth","County League","District League","Local Sunday League","School Football League","Academy League"],H=["Under 6","Under 7","Under 8","Under 9","Under 10","Under 11","Under 12","Under 13","Under 14","Under 15","Under 16"],V=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],J=["Morning (6:00-12:00)","Afternoon (12:00-18:00)","Evening (18:00-22:00)","Weekday Evenings","Weekend Mornings","Weekend Afternoons"];h.useEffect(()=>{P?.role==="Parent/Guardian"&&v()},[P]);const v=async()=>{try{B(!0);const[e,r]=await Promise.all([m.get("/api/children"),m.get("/api/child-player-availability")]);z(e.data.children),q(r.data.availability)}catch(e){console.error("Error loading data:",e),o("Failed to load data")}finally{B(!1)}},U=e=>{const r=new Date,a=new Date(e);let l=r.getFullYear()-a.getFullYear();const g=r.getMonth()-a.getMonth();return(g<0||g===0&&r.getDate()<a.getDate())&&l--,l},K=e=>`Under ${U(e)+1}`,d=(e,r)=>{if(e.includes(".")){const[a,l]=e.split(".");j(g=>({...g,[a]:{...g[a],[l]:r}}))}else j(a=>({...a,[e]:r}))},Q=e=>{const r=y.find(a=>a.id===e);if(r){const a=K(r.dateOfBirth),l=r.preferredPosition?[r.preferredPosition]:[];j(g=>({...g,childId:e,ageGroup:a,positions:l,title:`${r.firstName} ${r.lastName} - Player Available`}))}},X=async()=>{try{if(o(""),!s.childId||!s.title||!s.ageGroup||s.positions.length===0){o("Please fill in all required fields");return}await m.post("/api/child-player-availability",s),f("Player availability created successfully!"),G(!1),L(),v()}catch(e){console.error("Error creating availability:",e),o(e.response?.data?.error||"Failed to create player availability")}},Z=async()=>{if(x)try{if(o(""),!s.title||!s.ageGroup||s.positions.length===0){o("Please fill in all required fields");return}await m.put(`/api/child-player-availability/${x.id}`,s),f("Player availability updated successfully!"),D(null),L(),v()}catch(e){console.error("Error updating availability:",e),o(e.response?.data?.error||"Failed to update player availability")}},ee=async(e,r)=>{if(confirm(`Are you sure you want to remove "${r}"?`))try{await m.delete(`/api/child-player-availability/${e}`),f("Player availability removed successfully!"),v()}catch(a){console.error("Error deleting availability:",a),o(a.response?.data?.error||"Failed to remove player availability")}},te=async e=>{try{const r=e.status==="active"?"paused":"active";await m.put(`/api/child-player-availability/${e.id}`,{status:r}),f(`Player availability ${r==="active"?"activated":"paused"} successfully!`),v()}catch(r){console.error("Error toggling availability status:",r),o(r.response?.data?.error||"Failed to update availability status")}},L=()=>{j({childId:0,title:"",description:"",preferredLeagues:[],ageGroup:"",positions:[],preferredTeamGender:"Mixed",location:"",contactInfo:"",availability:{days:[],timeSlots:[],notes:""}})},re=e=>{D(e),j({childId:e.childId,title:e.title,description:e.description||"",preferredLeagues:e.preferredLeagues||[],ageGroup:e.ageGroup,positions:e.positions||[],preferredTeamGender:e.preferredTeamGender||"Mixed",location:e.location||"",contactInfo:e.contactInfo||"",availability:e.availability?{days:[],timeSlots:[],notes:""}:{days:[],timeSlots:[],notes:""}})},N=()=>{G(!1),D(null),L(),o("")};return P?.role!=="Parent/Guardian"?t.jsx(c,{p:3,children:t.jsx(b,{severity:"error",children:"Access denied. This page is only available to Parent/Guardian accounts."})}):t.jsxs(c,{p:3,children:[t.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[t.jsx(n,{variant:"h4",component:"h1",children:"Child Player Availability"}),t.jsx(C,{variant:"contained",startIcon:t.jsx($,{}),onClick:()=>G(!0),disabled:y.length===0,children:"Create Availability"})]}),S&&t.jsx(b,{severity:"error",sx:{mb:2},onClose:()=>o(""),children:S}),E&&t.jsx(b,{severity:"success",sx:{mb:2},onClose:()=>f(""),children:E}),y.length===0&&t.jsxs(b,{severity:"info",sx:{mb:2},children:["You need to add children to your account before creating player availability.",t.jsx(C,{href:"/children",sx:{ml:1},children:"Add Children"})]}),Y?t.jsx(n,{children:"Loading player availability..."}):M.length===0&&y.length>0?t.jsxs(ae,{sx:{p:3,textAlign:"center"},children:[t.jsx(se,{sx:{fontSize:64,color:"text.secondary",mb:2}}),t.jsx(n,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Player Availability Created Yet"}),t.jsx(n,{color:"text.secondary",mb:2,children:"Create player availability postings to help your children connect with football teams and coaches."}),t.jsx(C,{variant:"contained",startIcon:t.jsx($,{}),onClick:()=>G(!0),children:"Create First Availability"})]}):t.jsx(i,{container:!0,spacing:3,children:M.map(e=>t.jsx(i,{item:!0,xs:12,md:6,lg:4,children:t.jsx(ie,{children:t.jsxs(le,{children:[t.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[t.jsx(n,{variant:"h6",component:"h2",sx:{flex:1},children:e.title}),t.jsxs(c,{children:[t.jsx(T,{size:"small",onClick:()=>te(e),color:e.status==="active"?"success":"default",sx:{mr:1},children:e.status==="active"?t.jsx(ne,{}):t.jsx(oe,{})}),t.jsx(T,{size:"small",onClick:()=>re(e),sx:{mr:1},children:t.jsx(de,{})}),t.jsx(T,{size:"small",color:"error",onClick:()=>ee(e.id,e.title),children:t.jsx(ce,{})})]})]}),t.jsxs(w,{spacing:2,children:[t.jsxs(c,{children:[t.jsxs(n,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:[e.firstName," ",e.lastName]}),t.jsx(p,{label:e.status.toUpperCase(),size:"small",color:e.status==="active"?"success":"default",sx:{mb:1}})]}),t.jsxs(c,{children:[t.jsx(n,{variant:"subtitle2",gutterBottom:!0,children:"Age Group & Positions"}),t.jsx(n,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:e.ageGroup}),t.jsx(w,{direction:"row",spacing:1,flexWrap:"wrap",children:e.positions.map((r,a)=>t.jsx(p,{label:r,size:"small",variant:"outlined"},a))})]}),e.preferredLeagues&&e.preferredLeagues.length>0&&t.jsxs(c,{children:[t.jsx(n,{variant:"subtitle2",gutterBottom:!0,children:"Preferred Leagues"}),t.jsxs(w,{direction:"row",spacing:1,flexWrap:"wrap",children:[e.preferredLeagues.slice(0,2).map((r,a)=>t.jsx(p,{label:r,size:"small",color:"primary",variant:"outlined"},a)),e.preferredLeagues.length>2&&t.jsx(p,{label:`+${e.preferredLeagues.length-2} more`,size:"small",variant:"outlined"})]})]}),e.location&&t.jsxs(c,{display:"flex",alignItems:"center",children:[t.jsx(ue,{sx:{mr:1,fontSize:16,color:"text.secondary"}}),t.jsx(n,{variant:"body2",color:"text.secondary",children:e.location})]}),e.description&&t.jsx(n,{variant:"body2",color:"text.secondary",children:e.description.length>100?`${e.description.substring(0,100)}...`:e.description}),t.jsxs(n,{variant:"caption",color:"text.secondary",children:["Created: ",new Date(e.createdAt).toLocaleDateString()]})]})]})})},e.id))}),t.jsxs(he,{open:O||x!==null,onClose:N,maxWidth:"md",fullWidth:!0,children:[t.jsx(pe,{children:x?"Edit Player Availability":"Create Player Availability"}),t.jsxs(xe,{children:[S&&t.jsx(b,{severity:"error",sx:{mb:2},children:S}),t.jsxs(i,{container:!0,spacing:2,sx:{mt:1},children:[!x&&t.jsx(i,{item:!0,xs:12,children:t.jsxs(k,{fullWidth:!0,required:!0,children:[t.jsx(F,{children:"Select Child"}),t.jsx(W,{value:s.childId,label:"Select Child",onChange:e=>Q(Number(e.target.value)),children:y.map(e=>t.jsxs(A,{value:e.id,children:[e.firstName," ",e.lastName," (Age: ",U(e.dateOfBirth),")"]},e.id))})]})}),t.jsx(i,{item:!0,xs:12,children:t.jsx(u,{label:"Title",fullWidth:!0,required:!0,value:s.title,onChange:e=>d("title",e.target.value),placeholder:"e.g., Talented Midfielder Seeking Team"})}),t.jsx(i,{item:!0,xs:12,sm:6,children:t.jsxs(k,{fullWidth:!0,required:!0,children:[t.jsx(F,{children:"Age Group"}),t.jsx(W,{value:s.ageGroup,label:"Age Group",onChange:e=>d("ageGroup",e.target.value),children:H.map(e=>t.jsx(A,{value:e,children:e},e))})]})}),t.jsx(i,{item:!0,xs:12,sm:6,children:t.jsx(I,{multiple:!0,options:_,value:s.positions,onChange:(e,r)=>d("positions",r),renderTags:(e,r)=>e.map((a,l)=>t.jsx(p,{variant:"outlined",label:a,...r({index:l})})),renderInput:e=>t.jsx(u,{...e,label:"Positions",placeholder:"Select positions...",required:s.positions.length===0})})}),t.jsx(i,{item:!0,xs:12,sm:6,children:t.jsxs(k,{fullWidth:!0,required:!0,children:[t.jsx(F,{children:"Preferred Team Type"}),t.jsxs(W,{value:s.preferredTeamGender,label:"Preferred Team Type",onChange:e=>d("preferredTeamGender",e.target.value),children:[t.jsx(A,{value:"Boys",children:"Boys Team"}),t.jsx(A,{value:"Girls",children:"Girls Team"}),t.jsx(A,{value:"Mixed",children:"Mixed Team"})]})]})}),t.jsx(i,{item:!0,xs:12,children:t.jsx(I,{multiple:!0,options:R,value:s.preferredLeagues,onChange:(e,r)=>d("preferredLeagues",r),renderTags:(e,r)=>e.map((a,l)=>t.jsx(p,{variant:"outlined",label:a,...r({index:l})})),renderInput:e=>t.jsx(u,{...e,label:"Preferred Leagues",placeholder:"Select preferred leagues..."})})}),t.jsx(i,{item:!0,xs:12,children:t.jsx(u,{label:"Location",fullWidth:!0,value:s.location,onChange:e=>d("location",e.target.value),placeholder:"e.g., Manchester, Greater Manchester"})}),t.jsx(i,{item:!0,xs:12,children:t.jsx(u,{label:"Contact Information",fullWidth:!0,value:s.contactInfo,onChange:e=>d("contactInfo",e.target.value),placeholder:"How coaches can contact you (email, phone, etc.)"})}),t.jsx(i,{item:!0,xs:12,children:t.jsx(u,{label:"Description",fullWidth:!0,multiline:!0,rows:3,value:s.description,onChange:e=>d("description",e.target.value),placeholder:"Describe your child's football experience, strengths, and what kind of team they're looking for..."})}),t.jsx(i,{item:!0,xs:12,sm:6,children:t.jsx(I,{multiple:!0,options:V,value:s.availability.days,onChange:(e,r)=>d("availability.days",r),renderTags:(e,r)=>e.map((a,l)=>t.jsx(p,{variant:"outlined",label:a,...r({index:l})})),renderInput:e=>t.jsx(u,{...e,label:"Available Days",placeholder:"Select days..."})})}),t.jsx(i,{item:!0,xs:12,sm:6,children:t.jsx(I,{multiple:!0,options:J,value:s.availability.timeSlots,onChange:(e,r)=>d("availability.timeSlots",r),renderTags:(e,r)=>e.map((a,l)=>t.jsx(p,{variant:"outlined",label:a,...r({index:l})})),renderInput:e=>t.jsx(u,{...e,label:"Available Time Slots",placeholder:"Select time slots..."})})}),t.jsx(i,{item:!0,xs:12,children:t.jsx(u,{label:"Availability Notes",fullWidth:!0,value:s.availability.notes,onChange:e=>d("availability.notes",e.target.value),placeholder:"Any additional notes about availability..."})})]})]}),t.jsxs(ge,{children:[t.jsx(C,{onClick:N,children:"Cancel"}),t.jsxs(C,{onClick:x?Z:X,variant:"contained",children:[x?"Update":"Create"," Availability"]})]})]})]})};export{ve as default};
