import{j as e,z as F,B as l,a0 as c,I as T,Q as C,bw as _,s as n,aC as U,T as d,a1 as B,a2 as L,a3 as W,i as x,D as M,d as p,bp as N,bq as V,br as q,bs as K,G as o,$ as S,x as Q,a4 as Y,H as J,b8 as X}from"./mui-vendor-JAsu9f5S.js";import{r as h,u as Z}from"./react-vendor-BTglNIF_.js";import{a as G}from"./admin-features-R-myf6Sn.js";const ee=({onSearch:u,initialFilters:m={},loading:j=!1})=>{const[s,g]=h.useState({searchTerm:"",type:"both",league:"",ageGroup:"",position:"",location:"",sortBy:"newest",radius:50,...m}),[w,I]=h.useState([]),[y,A]=h.useState(!1),[b,v]=h.useState(!1),z=["Premier League","Championship","League One","League Two","National League","Sunday League"],D=["Under 6","Under 7","Under 8","Under 9","Under 10","Under 11","Under 12","Under 13","Under 14","Under 15","Under 16","Under 17","Under 18","Under 19","Under 20","Under 21","Senior","Veterans"],H=["Goalkeeper","Defender","Midfielder","Forward","Winger","Striker"],P=[{value:"newest",label:"Newest First"},{value:"oldest",label:"Oldest First"},{value:"alphabetical",label:"Alphabetical"}];h.useEffect(()=>{E()},[]);const E=async()=>{try{const a=await G.get("/search/history?limit=5");I(a.data.history)}catch(a){console.warn("Failed to load search history:",a)}},t=(a,r)=>{g(R=>({...R,[a]:r}))},f=()=>{u(s),v(!1)},k=()=>{g({searchTerm:"",type:"both",league:"",ageGroup:"",position:"",location:"",sortBy:"newest",radius:50})},$=a=>{const r={...s,searchTerm:a.searchTerm,...a.filters};g(r),u(r),v(!1)},O=async()=>{try{await G.delete("/search/history"),I([])}catch(a){console.error("Failed to clear search history:",a)}},i=()=>Object.entries(s).filter(([a,r])=>a==="searchTerm"||a==="type"||a==="sortBy"||a==="radius"?!1:r!=="").length;return e.jsxs(F,{elevation:2,sx:{p:3,mb:3},children:[e.jsxs(l,{sx:{display:"flex",gap:2,mb:2,alignItems:"flex-end"},children:[e.jsx(c,{fullWidth:!0,label:"Search teams and players",placeholder:"Enter keywords, team name, or location...",value:s.searchTerm,onChange:a=>t("searchTerm",a.target.value),onKeyPress:a=>a.key==="Enter"&&f(),InputProps:{endAdornment:e.jsxs(l,{sx:{display:"flex",alignItems:"center"},children:[s.searchTerm&&e.jsx(T,{size:"small",onClick:()=>t("searchTerm",""),children:e.jsx(C,{fontSize:"small"})}),e.jsx(T,{onClick:()=>v(!b),color:b?"primary":"default",children:e.jsx(_,{})})]})}}),e.jsx(n,{variant:"contained",onClick:f,disabled:j,startIcon:e.jsx(U,{}),sx:{minWidth:120,height:56},children:"Search"})]}),b&&w.length>0&&e.jsxs(F,{elevation:3,sx:{p:2,mb:2,maxHeight:300,overflowY:"auto",border:1,borderColor:"divider"},children:[e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(d,{variant:"subtitle2",color:"text.secondary",children:"Recent Searches"}),e.jsx(n,{size:"small",onClick:O,children:"Clear All"})]}),w.map((a,r)=>e.jsxs(l,{sx:{p:1,borderRadius:1,cursor:"pointer","&:hover":{bgcolor:"action.hover"}},onClick:()=>$(a),children:[e.jsx(d,{variant:"body2",children:a.searchTerm||"Advanced search"}),e.jsxs(d,{variant:"caption",color:"text.secondary",children:[a.resultsCount," results â€¢ ",new Date(a.searchedAt).toLocaleDateString()]})]},r))]}),e.jsxs(l,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:[e.jsxs(B,{size:"small",sx:{minWidth:120},children:[e.jsx(L,{children:"Type"}),e.jsxs(W,{value:s.type,label:"Type",onChange:a=>t("type",a.target.value),children:[e.jsx(x,{value:"both",children:"Both"}),e.jsx(x,{value:"vacancies",children:"Team Vacancies"}),e.jsx(x,{value:"players",children:"Player Availability"})]})]}),e.jsxs(B,{size:"small",sx:{minWidth:120},children:[e.jsx(L,{children:"Sort By"}),e.jsx(W,{value:s.sortBy,label:"Sort By",onChange:a=>t("sortBy",a.target.value),children:P.map(a=>e.jsx(x,{value:a.value,children:a.label},a.value))})]}),e.jsxs(n,{variant:"outlined",startIcon:e.jsx(M,{}),onClick:()=>A(!y),color:i()>0?"primary":"inherit",children:["Filters ",i()>0&&`(${i()})`]}),i()>0&&e.jsx(n,{variant:"text",startIcon:e.jsx(C,{}),onClick:k,size:"small",children:"Clear All"})]}),i()>0&&e.jsxs(l,{sx:{display:"flex",flexWrap:"wrap",gap:1,mb:2},children:[s.league&&e.jsx(p,{label:`League: ${s.league}`,onDelete:()=>t("league",""),size:"small",color:"primary"}),s.ageGroup&&e.jsx(p,{label:`Age: ${s.ageGroup}`,onDelete:()=>t("ageGroup",""),size:"small",color:"primary"}),s.position&&e.jsx(p,{label:`Position: ${s.position}`,onDelete:()=>t("position",""),size:"small",color:"primary"}),s.location&&e.jsx(p,{label:`Location: ${s.location}`,onDelete:()=>t("location",""),size:"small",color:"primary"})]}),e.jsxs(N,{expanded:y,onChange:()=>A(!y),children:[e.jsx(V,{expandIcon:e.jsx(q,{}),children:e.jsx(d,{variant:"subtitle2",children:"Advanced Filters"})}),e.jsxs(K,{children:[e.jsxs(o,{container:!0,spacing:3,children:[e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(S,{options:z,value:s.league,onChange:(a,r)=>t("league",r||""),renderInput:a=>e.jsx(c,{...a,label:"League",fullWidth:!0})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(S,{options:D,value:s.ageGroup,onChange:(a,r)=>t("ageGroup",r||""),renderInput:a=>e.jsx(c,{...a,label:"Age Group",fullWidth:!0})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(S,{options:H,value:s.position,onChange:(a,r)=>t("position",r||""),renderInput:a=>e.jsx(c,{...a,label:"Position",fullWidth:!0})})}),e.jsx(o,{item:!0,xs:12,sm:6,md:3,children:e.jsx(c,{fullWidth:!0,label:"Location",value:s.location,onChange:a=>t("location",a.target.value),InputProps:{startAdornment:e.jsx(Q,{sx:{mr:1,color:"text.secondary"}})}})}),e.jsxs(o,{item:!0,xs:12,children:[e.jsxs(d,{gutterBottom:!0,children:["Search Radius: ",s.radius," km"]}),e.jsx(Y,{value:s.radius,onChange:(a,r)=>t("radius",r),min:5,max:200,step:5,marks:[{value:5,label:"5km"},{value:50,label:"50km"},{value:100,label:"100km"},{value:200,label:"200km"}],valueLabelDisplay:"auto"})]})]}),e.jsx(J,{sx:{my:3}}),e.jsxs(l,{sx:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:2},children:[e.jsx(n,{variant:"outlined",onClick:k,startIcon:e.jsx(C,{}),children:"Clear All Filters"}),e.jsx(n,{variant:"contained",onClick:f,startIcon:e.jsx(U,{}),children:"Apply Filters"})]})]})]})]})},te=()=>{const u=Z(),m=j=>{u("/search",{state:{searchParams:j}})};return e.jsx(X,{maxWidth:"lg",sx:{mt:3,mb:3},children:e.jsx(ee,{onSearch:m})})};export{te as default};
