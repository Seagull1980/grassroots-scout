import{j as e,B as n,y as re,n as le,G as i,z as O,T as r,b as Te,s as j,af as ke,u as ne,J as Fe,C as F,a as L,g as Y,I as S,ag as V,q as Le,v as ie,N as oe,ab as ce,h as Ue,ah as We,ai as de,aj as ue,ak as Be,al as xe,am as Ge,an as De,ao as Ee,ap as J,aq as u,ar as $e,d as A,as as Me,at as Oe,k as Ye,au as he,l as Ve,a6 as me,a7 as pe,a8 as je,a0 as g,a1 as U,a2 as W,a3 as B,i as P,$ as Je,a9 as ge}from"./mui-vendor-C1HUv1lu.js";import{u as _e,r as c}from"./react-vendor-BW_9WhSV.js";import{t as d}from"./admin-features-DSNbd77k.js";const ye=({children:G,value:I,index:b,...t})=>e.jsx("div",{role:"tabpanel",hidden:I!==b,id:`roster-tabpanel-${b}`,"aria-labelledby":`roster-tab-${b}`,...t,children:I===b&&e.jsx(n,{sx:{p:3},children:G})}),Xe=()=>{const G=_e(),[I,b]=c.useState([]),[t,y]=c.useState(null),[v,_]=c.useState(null),[fe,H]=c.useState(!0),[D,K]=c.useState(0),[R,q]=c.useState(!1),[be,N]=c.useState(!1),[ve,w]=c.useState(!1),[f,E]=c.useState(null),[z,$]=c.useState(null),[o,m]=c.useState({teamName:"",clubName:"",ageGroup:"",league:"",maxSquadSize:""}),[l,x]=c.useState({playerName:"",bestPosition:"",alternativePositions:[],preferredFoot:"Right",age:"",contactInfo:"",notes:""}),[Q,h]=c.useState(null),[X,p]=c.useState(null),Z=["Goalkeeper","Centre-back","Left-back","Right-back","Defensive Midfielder","Central Midfielder","Attacking Midfielder","Left Wing","Right Wing","Striker","Centre Forward"],Ce=["Under 6","Under 7","Under 8","Under 9","Under 10","Under 11","Under 12","Under 13","Under 14","Under 15","Under 16","Under 17","Under 18","Under 19","Under 20","Under 21","Senior","Veterans"],Se=["Premier League Youth","Championship Youth","League One Youth","County League","Regional League","Local League","Sunday League","Community Football League","Youth Development League"];c.useEffect(()=>{T()},[]),c.useEffect(()=>{t&&Pe(t.id)},[t]);const T=async()=>{try{H(!0);const a=await d.getAll();if(b(a.rosters),a.rosters.length>0&&!t){const s=await d.getById(a.rosters[0].id);y(s.roster)}}catch(a){console.error("Error loading rosters:",a),h("Failed to load team rosters")}finally{H(!1)}},Pe=async a=>{try{const s=await d.getPositionAnalysis(a);_(s)}catch(s){console.error("Error loading position analysis:",s)}},Ie=async()=>{try{const a={...o,maxSquadSize:o.maxSquadSize?parseInt(o.maxSquadSize):null};await d.create(a),p("Team roster created successfully!"),N(!1),m({teamName:"",clubName:"",ageGroup:"",league:"",maxSquadSize:""}),T()}catch(a){console.error("Error creating roster:",a),h("Failed to create team roster")}},Ne=async()=>{if(f)try{const a={...o,maxSquadSize:o.maxSquadSize?parseInt(o.maxSquadSize):null};if(await d.update(f.id,a),p("Team roster updated successfully!"),N(!1),E(null),m({teamName:"",clubName:"",ageGroup:"",league:"",maxSquadSize:""}),T(),t&&t.id===f.id){const s=await d.getById(f.id);y(s.roster)}}catch(a){console.error("Error updating roster:",a),h("Failed to update team roster")}},we=async a=>{if(window.confirm("Are you sure you want to delete this team roster? This will remove all players."))try{await d.delete(a),p("Team roster deleted successfully!"),T(),t&&t.id===a&&(y(null),_(null))}catch(s){console.error("Error deleting roster:",s),h("Failed to delete team roster")}},ze=async()=>{if(t){if(t.maxSquadSize&&t.players.length>=t.maxSquadSize){h(`Cannot add player: Squad has reached maximum capacity of ${t.maxSquadSize} players`);return}try{const a={...l,age:l.age?parseInt(l.age):void 0};await d.addPlayer(t.id,a),p("Player added successfully!"),w(!1),x({playerName:"",bestPosition:"",alternativePositions:[],preferredFoot:"Right",age:"",contactInfo:"",notes:""});const s=await d.getById(t.id);y(s.roster)}catch(a){console.error("Error adding player:",a),h("Failed to add player")}}},Ae=async()=>{if(!(!t||!z))try{const a={...l,age:l.age?parseInt(l.age):void 0};await d.updatePlayer(t.id,z.id,a),p("Player updated successfully!"),w(!1),$(null),x({playerName:"",bestPosition:"",alternativePositions:[],preferredFoot:"Right",age:"",contactInfo:"",notes:""});const s=await d.getById(t.id);y(s.roster)}catch(a){console.error("Error updating player:",a),h("Failed to update player")}},Re=async a=>{if(t&&window.confirm("Are you sure you want to remove this player from the roster?"))try{await d.removePlayer(t.id,a),p("Player removed successfully!");const s=await d.getById(t.id);y(s.roster)}catch(s){console.error("Error removing player:",s),h("Failed to remove player")}},ee=a=>{a?(E(a),m({teamName:a.teamName,clubName:a.clubName||"",ageGroup:a.ageGroup,league:a.league,maxSquadSize:a.maxSquadSize?a.maxSquadSize.toString():""})):(E(null),m({teamName:"",clubName:"",ageGroup:"",league:"",maxSquadSize:""})),N(!0)},M=a=>{a?($(a),x({playerName:a.playerName,bestPosition:a.bestPosition,alternativePositions:a.alternativePositions,preferredFoot:a.preferredFoot,age:a.age?.toString()||"",contactInfo:a.contactInfo||"",notes:a.notes||""})):($(null),x({playerName:"",bestPosition:"",alternativePositions:[],preferredFoot:"Right",age:"",contactInfo:"",notes:""})),w(!0)},qe=async a=>{try{const s=await d.getById(a.id);y(s.roster),K(0)}catch(s){console.error("Error loading roster details:",s),h("Failed to load roster details")}},ae=(a,s)=>{if(s){const C=a>s;return e.jsxs(n,{component:"span",sx:{display:"inline-flex",alignItems:"center",gap:1},children:[e.jsxs("span",{children:[a,"/",s," players"]}),C&&e.jsx(A,{label:"Over Capacity",color:"warning",size:"small",icon:e.jsx(he,{})})]})}return`${a} players (unlimited)`},te=a=>{switch(a){case"high":return"error";case"medium":return"warning";case"low":return"success";default:return"primary"}},se=async a=>{const s=`${window.location.origin}/club-dashboard/${encodeURIComponent(a)}`;try{await navigator.clipboard.writeText(s),q(!0),p("Club link copied to clipboard!"),setTimeout(()=>q(!1),3e3)}catch{const k=document.createElement("textarea");k.value=s,document.body.appendChild(k),k.select(),document.execCommand("copy"),document.body.removeChild(k),q(!0),p("Club link copied to clipboard!"),setTimeout(()=>q(!1),3e3)}};return fe?e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",children:e.jsx(re,{})}):e.jsxs(n,{children:[Q&&e.jsx(le,{severity:"error",sx:{mb:2},onClose:()=>h(null),children:Q}),X&&e.jsx(le,{severity:"success",sx:{mb:2},onClose:()=>p(null),children:X}),e.jsxs(i,{container:!0,spacing:3,children:[e.jsx(i,{item:!0,xs:12,md:4,children:e.jsxs(O,{sx:{p:2},children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{variant:"h6",children:[e.jsx(Te,{sx:{mr:1,verticalAlign:"middle"}}),"Team Rosters"]}),e.jsx(j,{startIcon:e.jsx(ke,{}),onClick:()=>ee(),variant:"contained",size:"small",children:"New Team"})]}),I.length===0?e.jsxs(n,{textAlign:"center",py:4,children:[e.jsx(ne,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(r,{variant:"body1",color:"text.secondary",children:"No team rosters yet"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Create your first team to get started"})]}):e.jsx(Fe,{spacing:1,children:I.map(a=>e.jsx(F,{variant:t?.id===a.id?"elevation":"outlined",sx:{cursor:"pointer",bgcolor:t?.id===a.id?"action.selected":"inherit"},onClick:()=>qe(a),children:e.jsx(L,{sx:{p:2},children:e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",children:[e.jsxs(n,{flex:1,children:[e.jsx(r,{variant:"h6",noWrap:!0,children:a.teamName}),a.clubName&&e.jsxs(n,{display:"flex",alignItems:"center",gap:.5,children:[e.jsx(r,{variant:"caption",color:"primary",children:a.clubName}),e.jsx(Y,{title:R?"Copied!":"Copy club link",children:e.jsx(S,{size:"small",onClick:s=>{s.stopPropagation(),se(a.clubName)},sx:{p:.25},children:R?e.jsx(V,{fontSize:"small",color:"success"}):e.jsx(Le,{fontSize:"small"})})})]}),e.jsxs(r,{variant:"body2",color:"text.secondary",children:[a.ageGroup," • ",a.league]}),e.jsxs(n,{display:"flex",alignItems:"center",mt:1,children:[e.jsx(ie,{fontSize:"small",sx:{mr:1}}),e.jsx(r,{variant:"caption",children:ae(a.players?.length||0,a.maxSquadSize)})]})]}),e.jsxs(n,{children:[e.jsx(S,{size:"small",onClick:s=>{s.stopPropagation(),ee(a)},children:e.jsx(oe,{fontSize:"small"})}),e.jsx(S,{size:"small",color:"error",onClick:s=>{s.stopPropagation(),we(a.id)},children:e.jsx(ce,{fontSize:"small"})})]})]})})},a.id))})]})}),e.jsx(i,{item:!0,xs:12,md:8,children:t?e.jsxs(O,{sx:{p:0},children:[e.jsx(n,{p:2,borderBottom:1,borderColor:"divider",children:e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",children:[e.jsxs(n,{children:[e.jsx(r,{variant:"h5",children:t.teamName}),t.clubName&&e.jsx(r,{variant:"subtitle2",color:"primary",children:t.clubName}),e.jsxs(r,{variant:"subtitle1",color:"text.secondary",children:[t.ageGroup," • ",t.league]})]}),t.clubName&&e.jsxs(n,{display:"flex",gap:1,children:[e.jsx(Y,{title:"Copy club link to share",children:e.jsx(S,{size:"small",onClick:()=>se(t.clubName),color:R?"success":"primary",children:R?e.jsx(V,{}):e.jsx(Ue,{})})}),e.jsx(j,{variant:"outlined",size:"small",onClick:()=>G(`/club-dashboard/${encodeURIComponent(t.clubName)}`),children:"Club Dashboard"})]})]})}),e.jsxs(We,{value:D,onChange:(a,s)=>K(s),children:[e.jsx(de,{label:e.jsx(ue,{badgeContent:t.maxSquadSize?`${t.players.length}/${t.maxSquadSize}`:t.players.length,color:t.maxSquadSize&&t.players.length>t.maxSquadSize?"warning":"primary",children:"Players"}),icon:e.jsx(ie,{})}),e.jsx(de,{label:e.jsx(ue,{badgeContent:v?.summary.criticalGaps||0,color:"error",children:"Squad Analysis"}),icon:e.jsx(Be,{})})]}),e.jsxs(ye,{value:D,index:0,children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(r,{variant:"h6",children:["Squad (",ae(t.players.length,t.maxSquadSize),")"]}),(()=>{const a=t.maxSquadSize&&t.players.length>=t.maxSquadSize;return e.jsx(Y,{title:a?`Squad has reached maximum capacity of ${t.maxSquadSize} players`:"Add a new player to the squad",children:e.jsx("span",{children:e.jsx(j,{startIcon:e.jsx(xe,{}),onClick:()=>M(),variant:"contained",disabled:!!a,children:"Add Player"})})})})()]}),e.jsx(Ge,{children:e.jsxs(De,{children:[e.jsx(Ee,{children:e.jsxs(J,{children:[e.jsx(u,{children:"Player Name"}),e.jsx(u,{children:"Best Position"}),e.jsx(u,{children:"Alternative Positions"}),e.jsx(u,{children:"Preferred Foot"}),e.jsx(u,{children:"Age"}),e.jsx(u,{align:"right",children:"Actions"})]})}),e.jsxs($e,{children:[t.players.map(a=>e.jsxs(J,{children:[e.jsx(u,{children:e.jsxs(n,{children:[e.jsx(r,{variant:"body2",fontWeight:500,children:a.playerName}),a.contactInfo&&e.jsx(r,{variant:"caption",color:"text.secondary",children:a.contactInfo})]})}),e.jsx(u,{children:e.jsx(A,{label:a.bestPosition,size:"small",color:"primary"})}),e.jsx(u,{children:e.jsx(n,{children:a.alternativePositions.map((s,C)=>e.jsx(A,{label:s,size:"small",variant:"outlined",sx:{mr:.5,mb:.5}},C))})}),e.jsx(u,{children:a.preferredFoot}),e.jsx(u,{children:a.age||"N/A"}),e.jsxs(u,{align:"right",children:[e.jsx(S,{size:"small",onClick:()=>M(a),children:e.jsx(oe,{})}),e.jsx(S,{size:"small",color:"error",onClick:()=>Re(a.id),children:e.jsx(ce,{})})]})]},a.id)),t.players.length===0&&e.jsx(J,{children:e.jsxs(u,{colSpan:6,align:"center",sx:{py:4},children:[e.jsx(r,{variant:"body1",color:"text.secondary",children:"No players in this roster yet"}),e.jsx(j,{startIcon:e.jsx(xe,{}),onClick:()=>M(),sx:{mt:1},children:"Add First Player"})]})})]})]})})]}),e.jsx(ye,{value:D,index:1,children:v?e.jsxs(n,{children:[e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Squad Analysis"}),e.jsxs(i,{container:!0,spacing:2,mb:3,children:[e.jsx(i,{item:!0,xs:4,children:e.jsx(F,{children:e.jsxs(L,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"primary",children:v.summary.totalPlayers}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Total Players"})]})})}),e.jsx(i,{item:!0,xs:4,children:e.jsx(F,{children:e.jsxs(L,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"secondary",children:v.summary.activePositions}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Covered Positions"})]})})}),e.jsx(i,{item:!0,xs:4,children:e.jsx(F,{children:e.jsxs(L,{sx:{textAlign:"center"},children:[e.jsx(r,{variant:"h4",color:"error",children:v.summary.criticalGaps}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Critical Gaps"})]})})})]}),e.jsx(r,{variant:"h6",gutterBottom:!0,children:"Position Requirements"}),e.jsx(Me,{children:v.gaps.map((a,s)=>e.jsxs(Oe,{divider:!0,children:[e.jsx(Ye,{children:a.gap>0?e.jsx(he,{color:te(a.priority)}):e.jsx(V,{color:"success"})}),e.jsx(Ve,{primary:e.jsxs(n,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(r,{variant:"body1",children:a.position}),e.jsx(A,{label:a.priority,size:"small",color:te(a.priority)})]}),secondary:e.jsxs(r,{variant:"body2",children:["Current: ",a.currentCount," | Ideal: ",a.idealCount," |",a.gap>0?` Need: ${a.gap}`:" ✓ Covered"]})})]},s))})]}):e.jsxs(n,{textAlign:"center",py:4,children:[e.jsx(re,{}),e.jsx(r,{variant:"body2",sx:{mt:2},children:"Analyzing squad..."})]})})]}):e.jsxs(O,{sx:{p:4,textAlign:"center"},children:[e.jsx(ne,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(r,{variant:"h6",color:"text.secondary",children:"Select a team roster to view details"}),e.jsx(r,{variant:"body2",color:"text.secondary",children:"Create a new team or select an existing one from the list"})]})})]}),e.jsxs(me,{open:be,onClose:()=>N(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(pe,{children:f?"Edit Team Roster":"Create New Team Roster"}),e.jsx(je,{children:e.jsxs(i,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(i,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,label:"Team Name",value:o.teamName,onChange:a=>m({...o,teamName:a.target.value}),placeholder:"e.g., Manchester United Youth FC"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,label:"Club Name (Optional)",value:o.clubName,onChange:a=>m({...o,clubName:a.target.value}),placeholder:"e.g., Manchester United FC",helperText:"Link multiple teams under the same club"})}),e.jsx(i,{item:!0,xs:6,children:e.jsxs(U,{fullWidth:!0,children:[e.jsx(W,{children:"Age Group"}),e.jsx(B,{value:o.ageGroup,label:"Age Group",onChange:a=>m({...o,ageGroup:a.target.value}),children:Ce.map(a=>e.jsx(P,{value:a,children:a},a))})]})}),e.jsx(i,{item:!0,xs:6,children:e.jsx(Je,{fullWidth:!0,options:Se,value:o.league||null,onChange:(a,s)=>m({...o,league:s||""}),renderInput:a=>e.jsx(g,{...a,label:"League",placeholder:"Type to search leagues..."}),filterOptions:(a,{inputValue:s})=>s?a.filter(C=>C.toLowerCase().includes(s.toLowerCase())):a,noOptionsText:"No leagues found"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,label:"Maximum Squad Size",type:"number",value:o.maxSquadSize,onChange:a=>m({...o,maxSquadSize:a.target.value}),placeholder:"Leave empty for unlimited",helperText:"Maximum number of players allowed in the squad (leave empty for no limit)",inputProps:{min:1,max:100}})})]})}),e.jsxs(ge,{children:[e.jsx(j,{onClick:()=>N(!1),children:"Cancel"}),e.jsx(j,{onClick:f?Ne:Ie,variant:"contained",disabled:!o.teamName||!o.ageGroup||!o.league,children:f?"Update":"Create"})]})]}),e.jsxs(me,{open:ve,onClose:()=>w(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(pe,{children:z?"Edit Player":"Add New Player"}),e.jsx(je,{children:e.jsxs(i,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(g,{fullWidth:!0,label:"Player Name",value:l.playerName,onChange:a=>x({...l,playerName:a.target.value}),placeholder:"e.g., John Smith"})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(g,{fullWidth:!0,label:"Age",type:"number",value:l.age,onChange:a=>x({...l,age:a.target.value}),placeholder:"e.g., 16"})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(U,{fullWidth:!0,children:[e.jsx(W,{children:"Best Position"}),e.jsx(B,{value:l.bestPosition,label:"Best Position",onChange:a=>x({...l,bestPosition:a.target.value}),children:Z.map(a=>e.jsx(P,{value:a,children:a},a))})]})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsxs(U,{fullWidth:!0,children:[e.jsx(W,{children:"Preferred Foot"}),e.jsxs(B,{value:l.preferredFoot,label:"Preferred Foot",onChange:a=>x({...l,preferredFoot:a.target.value}),children:[e.jsx(P,{value:"Left",children:"Left"}),e.jsx(P,{value:"Right",children:"Right"}),e.jsx(P,{value:"Both",children:"Both"})]})]})}),e.jsx(i,{item:!0,xs:12,children:e.jsxs(U,{fullWidth:!0,children:[e.jsx(W,{children:"Alternative Positions"}),e.jsx(B,{multiple:!0,value:l.alternativePositions,label:"Alternative Positions",onChange:a=>x({...l,alternativePositions:a.target.value}),renderValue:a=>e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:a.map(s=>e.jsx(A,{label:s,size:"small"},s))}),children:Z.filter(a=>a!==l.bestPosition).map(a=>e.jsx(P,{value:a,children:a},a))})]})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,label:"Contact Information",value:l.contactInfo,onChange:a=>x({...l,contactInfo:a.target.value}),placeholder:"e.g., parent email, phone number"})}),e.jsx(i,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,multiline:!0,rows:3,label:"Notes",value:l.notes,onChange:a=>x({...l,notes:a.target.value}),placeholder:"Additional notes about the player..."})})]})}),e.jsxs(ge,{children:[e.jsx(j,{onClick:()=>w(!1),children:"Cancel"}),e.jsx(j,{onClick:z?Ae:ze,variant:"contained",disabled:!l.playerName||!l.bestPosition,children:z?"Update":"Add Player"})]})]})]})};export{Xe as T};
