var Ne=Object.defineProperty;var Ve=(m,s,t)=>s in m?Ne(m,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[s]=t;var he=(m,s,t)=>Ve(m,typeof s!="symbol"?s+"":s,t);import{j as e,B as n,T as i,g as Je,I as N,h as ee,R as se,i as M,k as F,d as V,l as Ue,m as E,D as He,e as U,n as Ye,o as q,p as Z,M as be,q as v,r as ve,s as xe,F as te,t as ae,u as ne,v as w,w as Qe,G as c,C as I,a as A,L as pe,x as qe,y as Ze,z as Ce,E as we,S as Ke,H as Xe,J as Se,K as ke,N as $e,O as _,Q as Te,U as ue,W as me,X as es,Y as ss,Z as ts,_ as as,$ as ns,a0 as rs,a1 as os,a2 as is,a3 as je,a4 as D,a5 as K,a6 as J,a7 as ls,a8 as cs,a9 as ds,aa as hs,ab as ye,ac as ge,ad as fe,ae as xs,af as X,ag as ps,ah as us,ai as ms,A as js,aj as ys}from"./mui-vendor-rZ0WLTig.js";import{r as y,u as Ie}from"./react-vendor-CRXLTmIH.js";import{u as Ae,a as H}from"./admin-features-d6LVy8Ft.js";import{L as gs,B as fs,C as bs,a as vs,b as Cs,P as ws,c as Ss,d as ks,A as $s,R as Ts,p as Is,e as As,f as Ps,i as Bs}from"./charts-vendor-B0AXBVgz.js";class Ds{constructor(){he(this,"apiBase","/api/analytics")}async getPlayerStats(s,t){return(await fetch(`${this.apiBase}/players/${s}/stats`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({period:t})})).json()}async getPlayerTrends(s,t,a){return(await fetch(`${this.apiBase}/players/${s}/trends`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({metric:t,period:a})})).json()}async getPlayerComparisons(s,t){return(await fetch(`${this.apiBase}/players/${s}/compare/${t}`)).json()}async getPlayerMatchHistory(s,t=10){return(await fetch(`${this.apiBase}/players/${s}/matches?limit=${t}`)).json()}async getTeamStats(s,t){return(await fetch(`${this.apiBase}/teams/${s}/stats`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({period:t})})).json()}async getTeamMatchHistory(s,t=10){return(await fetch(`${this.apiBase}/teams/${s}/matches?limit=${t}`)).json()}async getTeamPlayerRankings(s,t){return(await fetch(`${this.apiBase}/teams/${s}/rankings?metric=${t}`)).json()}async getLeagueTable(s,t){return(await fetch(`${this.apiBase}/leagues/${s}/table?season=${t}`)).json()}async getPerformancePredictions(s,t=5){return(await fetch(`${this.apiBase}/predictions/player/${s}?matches=${t}`)).json()}async getFormAnalysis(s){return(await fetch(`${this.apiBase}/analysis/form/player/${s}`)).json()}async getInjuryRiskAssessment(s){return(await fetch(`${this.apiBase}/analysis/injury-risk/${s}`)).json()}async getPerformanceGoals(s,t){const a=t?`${this.apiBase}/goals?userId=${s}&type=${t}`:`${this.apiBase}/goals?userId=${s}`;return(await fetch(a)).json()}async createPerformanceGoal(s){return(await fetch(`${this.apiBase}/goals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}async updatePerformanceGoal(s,t){return(await fetch(`${this.apiBase}/goals/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async getInjuryHistory(s){return(await fetch(`${this.apiBase}/injuries/player/${s}`)).json()}async logInjury(s){return(await fetch(`${this.apiBase}/injuries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}async updateInjuryStatus(s,t,a){return(await fetch(`${this.apiBase}/injuries/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t,actualReturnDate:a})})).json()}async getTrainingMetrics(s,t){return(await fetch(`${this.apiBase}/training/player/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({period:t})})).json()}async logTrainingSession(s){return(await fetch(`${this.apiBase}/training`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}async generateReport(s){return(await fetch(`${this.apiBase}/reports/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}async getReports(s,t){const a=t?`${this.apiBase}/reports?userId=${s}&type=${t}`:`${this.apiBase}/reports?userId=${s}`;return(await fetch(a)).json()}async exportReport(s,t){return(await fetch(`${this.apiBase}/reports/${s}/export?format=${t}`)).blob()}async getDashboards(s){return(await fetch(`${this.apiBase}/dashboards?userId=${s}`)).json()}async createDashboard(s){return(await fetch(`${this.apiBase}/dashboards`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json()}async updateDashboard(s,t){return(await fetch(`${this.apiBase}/dashboards/${s}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async searchPlayers(s,t){return(await fetch(`${this.apiBase}/search/players`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:s,filters:t})})).json()}async getTopPerformers(s,t,a=10){return(await fetch(`${this.apiBase}/leaderboards/${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({period:t,limit:a})})).json()}async getPersonalizedInsights(s){return(await fetch(`${this.apiBase}/insights/personalized/${s}`)).json()}async getTeamInsights(s){return(await fetch(`${this.apiBase}/insights/team/${s}`)).json()}async subscribeToLiveStats(s,t){const a=new EventSource(`${this.apiBase}/live/match/${s}`);return a.onmessage=l=>{const d=JSON.parse(l.data);t(d)},()=>{a.close()}}async calculateAge(s){const t=new Date(s),a=new Date,l=a.getFullYear()-t.getFullYear(),d=a.getMonth()-t.getMonth();return d<0||d===0&&a.getDate()<t.getDate()?l-1:l}formatPerformanceRating(s){return s>=9?"Exceptional":s>=8?"Excellent":s>=7?"Good":s>=6?"Average":s>=5?"Below Average":"Poor"}calculatePercentileRank(s,t){const a=t.sort((d,f)=>d-f),l=a.filter(d=>d<=s).length;return Math.round(l/a.length*100)}getFormTrend(s){if(s.length<3)return"stable";const t=s.slice(0,Math.floor(s.length/2)),a=s.slice(Math.floor(s.length/2)),l=t.reduce((x,p)=>x+p,0)/t.length,f=a.reduce((x,p)=>x+p,0)/a.length-l;return f>.3?"improving":f<-.3?"declining":"stable"}async getPlayerMatches(s,t){return(await fetch(`${this.apiBase}/players/${s}/matches`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({period:t})})).json()}async getPlayerTrainingSessions(s,t){return(await fetch(`${this.apiBase}/players/${s}/training`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({period:t})})).json()}async getPlayerInjuries(s){return(await fetch(`${this.apiBase}/players/${s}/injuries`)).json()}async getPlayerRatings(s,t){return(await fetch(`${this.apiBase}/players/${s}/ratings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({period:t})})).json()}async getDashboard(s){const t=await fetch(`${this.apiBase}/dashboard/${s}`);return t.status===404?null:t.json()}async getNotifications(s){return(await fetch(`${this.apiBase}/notifications/${s}`)).json()}async exportData(s,t){return(await fetch(`${this.apiBase}/export/${s}?format=${t}`)).blob()}}const P=new Ds;bs.register(vs,Cs,ws,Ss,ks,$s,Ts,Is,As,Ps,Bs);const Es=({targetType:m="player",targetId:s})=>{const{user:t}=Ae(),[a,l]=y.useState(0),[d,f]=y.useState({type:"season",label:"Current Season"}),[x,p]=y.useState(!1),[S,C]=y.useState(""),[g,R]=y.useState(null),[T,h]=y.useState(null),[u,O]=y.useState([]),[B,L]=y.useState([]),[W,o]=y.useState([]),[k,G]=y.useState([]),[j,$]=y.useState(!1),[Y,re]=y.useState(!1),[oe,ie]=y.useState(null),[le,Be]=y.useState("rating");y.useEffect(()=>{t&&(s||t.id)&&ce()},[t,m,s,d]);const ce=async()=>{try{p(!0),C("");const r=s||t?.id;if(!r)return;if(m==="player"){const[z,Q,Ee,_e]=await Promise.all([P.getPlayerStats(r,d),P.getPlayerTrends(r,le,d),P.getPlayerComparisons(r,"team"),P.getPerformanceGoals(t.id,"individual")]);R(z),O(Q),L(Ee),o(_e)}else{const[z,Q]=await Promise.all([P.getTeamStats(r,d),P.getPerformanceGoals(t.id,"team")]);h(z),o(Q)}const b=await P.getReports(t.id,m);G(b)}catch(r){C("Failed to load analytics data"),console.error("Analytics loading error:",r)}finally{p(!1)}},De=(r,b)=>{l(b)},Re=r=>{f(r)},Oe=async r=>{try{const b=await P.createPerformanceGoal({...r,playerId:m==="player"?s||t.id:void 0,teamId:m==="team"?s||t?.teamId:void 0,type:m==="player"?"individual":"team",isActive:!0,currentValue:0});o(z=>[...z,b]),$(!1)}catch{C("Failed to create goal")}},Ge=r=>({labels:r.map(b=>b.period),datasets:[{label:"Performance",data:r.map(b=>b.value),borderColor:"#1976d2",backgroundColor:"rgba(25, 118, 210, 0.1)",fill:!0}]}),We=r=>({labels:r.map(b=>b.metric),datasets:[{label:"Your Performance",data:r.map(b=>b.playerValue),backgroundColor:"#1976d2"},{label:"Team Average",data:r.map(b=>b.teamAverage),backgroundColor:"#dc004e"},{label:"League Average",data:r.map(b=>b.leagueAverage),backgroundColor:"#757575"}]}),Fe=()=>!g&&!T?null:e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:6,lg:3,children:e.jsx(I,{children:e.jsxs(A,{children:[e.jsxs(n,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(i,{variant:"h4",color:"primary",gutterBottom:!0,children:g?g.goals:T?.goalsFor||0}),e.jsxs(i,{variant:"subtitle2",color:"text.secondary",children:["Goals ",g?"Scored":"For"]})]}),e.jsx(Ke,{color:"primary",sx:{fontSize:40}})]}),g&&e.jsx(n,{mt:2,children:e.jsx(pe,{variant:"determinate",value:Math.min(g.goals*10,100),sx:{height:6,borderRadius:3}})})]})})}),e.jsx(c,{item:!0,xs:12,md:6,lg:3,children:e.jsx(I,{children:e.jsx(A,{children:e.jsxs(n,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(i,{variant:"h4",color:"success.main",gutterBottom:!0,children:g?g.assists:T?.wins||0}),e.jsx(i,{variant:"subtitle2",color:"text.secondary",children:g?"Assists":"Wins"})]}),e.jsx(q,{color:"success",sx:{fontSize:40}})]})})})}),e.jsx(c,{item:!0,xs:12,md:6,lg:3,children:e.jsx(I,{children:e.jsx(A,{children:e.jsxs(n,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(i,{variant:"h4",color:"info.main",gutterBottom:!0,children:g?`${g.formRating.toFixed(1)}`:`${T?.winRate.toFixed(0)||0}%`}),e.jsx(i,{variant:"subtitle2",color:"text.secondary",children:g?"Form Rating":"Win Rate"})]}),e.jsx(U,{color:"info",sx:{fontSize:40}})]})})})}),e.jsx(c,{item:!0,xs:12,md:6,lg:3,children:e.jsx(I,{children:e.jsx(A,{children:e.jsxs(n,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(i,{variant:"h4",color:"warning.main",gutterBottom:!0,children:g?g.minutesPlayed:T?.matchesPlayed||0}),e.jsx(i,{variant:"subtitle2",color:"text.secondary",children:g?"Minutes Played":"Matches Played"})]}),e.jsx(Xe,{color:"warning",sx:{fontSize:40}})]})})})})]}),de=()=>u.length===0?null:e.jsxs(F,{sx:{p:3,mb:3},children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(i,{variant:"h6",children:"Performance Trends"}),e.jsxs(te,{size:"small",sx:{minWidth:120},children:[e.jsx(ae,{children:"Metric"}),e.jsxs(ne,{value:le,onChange:r=>Be(r.target.value),label:"Metric",children:[e.jsx(v,{value:"rating",children:"Rating"}),e.jsx(v,{value:"goals",children:"Goals"}),e.jsx(v,{value:"assists",children:"Assists"}),e.jsx(v,{value:"fitness",children:"Fitness"})]})]})]}),e.jsx(n,{height:400,children:e.jsx(gs,{data:Ge(u),options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0},title:{display:!1}},scales:{y:{beginAtZero:!0}}}})})]}),Me=()=>B.length===0?null:e.jsxs(F,{sx:{p:3,mb:3},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,children:"Performance Comparison"}),e.jsx(n,{height:400,children:e.jsx(fs,{data:We(B),options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0}},scales:{y:{beginAtZero:!0}}}})})]}),Le=()=>e.jsxs(F,{sx:{p:3,mb:3},children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(i,{variant:"h6",children:"Performance Goals"}),e.jsx(w,{startIcon:e.jsx(Qe,{}),variant:"outlined",onClick:()=>$(!0),children:"Add Goal"})]}),W.length===0?e.jsx(M,{severity:"info",children:"No performance goals set. Create one to start tracking your progress!"}):e.jsx(c,{container:!0,spacing:2,children:W.map(r=>e.jsx(c,{item:!0,xs:12,md:6,lg:4,children:e.jsx(I,{children:e.jsxs(A,{children:[e.jsxs(n,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(q,{color:"primary",sx:{mr:1}}),e.jsx(i,{variant:"subtitle1",fontWeight:"bold",children:r.title})]}),e.jsx(i,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:r.description}),e.jsxs(n,{mt:2,children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",mb:1,children:[e.jsxs(i,{variant:"body2",children:[r.currentValue," / ",r.targetValue," ",r.unit]}),e.jsxs(i,{variant:"body2",fontWeight:"bold",children:[r.progress,"%"]})]}),e.jsx(pe,{variant:"determinate",value:r.progress,sx:{height:8,borderRadius:4}})]}),e.jsx(V,{size:"small",label:r.isActive?"Active":"Completed",color:r.isActive?"primary":"success",sx:{mt:1}})]})})},r.id))})]}),ze=()=>e.jsxs(F,{sx:{p:3},children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(i,{variant:"h6",children:"Analytics Reports"}),e.jsx(w,{startIcon:e.jsx(Z,{}),variant:"outlined",onClick:()=>re(!0),children:"Generate Report"})]}),k.length===0?e.jsx(M,{severity:"info",children:"No reports generated yet. Create a report to get detailed insights!"}):e.jsx(qe,{children:k.map(r=>e.jsxs(Ze,{divider:!0,children:[e.jsx(Ce,{children:e.jsx(Z,{})}),e.jsx(we,{primary:r.title,secondary:`Generated ${new Date(r.generatedAt).toLocaleDateString()}`}),e.jsx(w,{startIcon:e.jsx(xe,{}),size:"small",onClick:()=>P.exportReport(r.id,"pdf"),children:"Download"})]},r.id))})]});return e.jsxs(n,{sx:{p:3},children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsxs(i,{variant:"h4",fontWeight:"bold",children:[e.jsx(Je,{sx:{mr:1,verticalAlign:"middle"}}),"Advanced Analytics"]}),e.jsxs(n,{children:[e.jsx(N,{onClick:r=>ie(r.currentTarget),children:e.jsx(ee,{})}),e.jsx(N,{onClick:ce,disabled:x,children:e.jsx(se,{})})]})]}),S&&e.jsx(M,{severity:"error",sx:{mb:2},onClose:()=>C(""),children:S}),e.jsx(F,{sx:{p:2,mb:3},children:e.jsxs(n,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",children:[e.jsx(i,{variant:"subtitle1",fontWeight:"bold",children:"Period:"}),[{type:"season",label:"Current Season"},{type:"month",label:"This Month"},{type:"last_10_matches",label:"Last 10 Matches"}].map(r=>e.jsx(V,{label:r.label,onClick:()=>Re(r),color:d.type===r.type?"primary":"default",variant:d.type===r.type?"filled":"outlined"},r.type))]})}),e.jsx(F,{sx:{mb:3},children:e.jsxs(Ue,{value:a,onChange:De,variant:"scrollable",scrollButtons:"auto",children:[e.jsx(E,{label:"Overview",icon:e.jsx(He,{})}),e.jsx(E,{label:"Performance",icon:e.jsx(U,{})}),e.jsx(E,{label:"Comparisons",icon:e.jsx(Ye,{})}),e.jsx(E,{label:"Goals",icon:e.jsx(q,{})}),e.jsx(E,{label:"Reports",icon:e.jsx(Z,{})})]})}),x?e.jsx(n,{display:"flex",justifyContent:"center",p:4,children:e.jsx(i,{children:"Loading analytics data..."})}):e.jsxs(e.Fragment,{children:[a===0&&e.jsxs(n,{children:[Fe(),e.jsx(n,{mt:3,children:de()})]}),a===1&&de(),a===2&&Me(),a===3&&Le(),a===4&&ze()]}),e.jsx(Rs,{open:j,onClose:()=>$(!1),onSave:Oe,type:m}),e.jsx(Os,{open:Y,onClose:()=>re(!1),targetType:m,targetId:s||t?.id||""}),e.jsxs(be,{anchorEl:oe,open:!!oe,onClose:()=>ie(null),children:[e.jsxs(v,{onClick:()=>{},children:[e.jsx(ee,{sx:{mr:1}})," Settings"]}),e.jsxs(v,{onClick:()=>{},children:[e.jsx(ve,{sx:{mr:1}})," Share Dashboard"]}),e.jsxs(v,{onClick:()=>{},children:[e.jsx(xe,{sx:{mr:1}})," Export Data"]})]})]})},Rs=({open:m,onClose:s,onSave:t,type:a})=>{const[l,d]=y.useState({title:"",description:"",category:"goals",targetValue:0,unit:"goals",deadline:""}),f=()=>{t(l),d({title:"",description:"",category:"goals",targetValue:0,unit:"goals",deadline:""})};return e.jsxs(Se,{open:m,onClose:s,maxWidth:"sm",fullWidth:!0,children:[e.jsx(ke,{children:"Create Performance Goal"}),e.jsx($e,{children:e.jsxs(c,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(c,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,label:"Goal Title",value:l.title,onChange:x=>d(p=>({...p,title:x.target.value}))})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,multiline:!0,rows:3,label:"Description",value:l.description,onChange:x=>d(p=>({...p,description:x.target.value}))})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsxs(te,{fullWidth:!0,children:[e.jsx(ae,{children:"Category"}),e.jsxs(ne,{value:l.category,onChange:x=>d(p=>({...p,category:x.target.value})),label:"Category",children:[e.jsx(v,{value:"goals",children:"Goals"}),e.jsx(v,{value:"assists",children:"Assists"}),e.jsx(v,{value:"fitness",children:"Fitness"}),e.jsx(v,{value:"attendance",children:"Attendance"}),a==="team"&&e.jsx(v,{value:"wins",children:"Wins"}),a==="team"&&e.jsx(v,{value:"clean_sheets",children:"Clean Sheets"})]})]})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(_,{fullWidth:!0,type:"number",label:"Target Value",value:l.targetValue,onChange:x=>d(p=>({...p,targetValue:parseInt(x.target.value)}))})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(_,{fullWidth:!0,label:"Unit",value:l.unit,onChange:x=>d(p=>({...p,unit:x.target.value}))})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(_,{fullWidth:!0,type:"date",label:"Deadline",value:l.deadline,onChange:x=>d(p=>({...p,deadline:x.target.value})),InputLabelProps:{shrink:!0}})})]})}),e.jsxs(Te,{children:[e.jsx(w,{onClick:s,children:"Cancel"}),e.jsx(w,{onClick:f,variant:"contained",children:"Create Goal"})]})]})},Os=({open:m,onClose:s,targetType:t,targetId:a})=>{const[l,d]=y.useState({type:t,period:{type:"season",label:"Current Season"},includeCharts:!0,includeTables:!0,customMetrics:[]}),f=async()=>{try{await P.generateReport({...l,targetId:a}),s()}catch(x){console.error("Failed to generate report:",x)}};return e.jsxs(Se,{open:m,onClose:s,maxWidth:"sm",fullWidth:!0,children:[e.jsx(ke,{children:"Generate Analytics Report"}),e.jsx($e,{children:e.jsxs(c,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(c,{item:!0,xs:12,children:e.jsxs(te,{fullWidth:!0,children:[e.jsx(ae,{children:"Report Type"}),e.jsxs(ne,{value:l.type,onChange:x=>d(p=>({...p,type:x.target.value})),label:"Report Type",children:[e.jsx(v,{value:"player",children:"Player Performance"}),e.jsx(v,{value:"team",children:"Team Analysis"}),e.jsx(v,{value:"comparison",children:"Comparison Report"}),e.jsx(v,{value:"season",children:"Season Summary"})]})]})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(ue,{control:e.jsx(me,{checked:l.includeCharts,onChange:x=>d(p=>({...p,includeCharts:x.target.checked}))}),label:"Include Charts"})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(ue,{control:e.jsx(me,{checked:l.includeTables,onChange:x=>d(p=>({...p,includeTables:x.target.checked}))}),label:"Include Data Tables"})})]})}),e.jsxs(Te,{children:[e.jsx(w,{onClick:s,children:"Cancel"}),e.jsx(w,{onClick:f,variant:"contained",children:"Generate Report"})]})]})},Pe=({shareType:m,targetId:s,title:t,description:a,url:l,size:d="medium"})=>{const[f,x]=y.useState(null),[p,S]=y.useState({open:!1,message:"",severity:"success"}),C=l||`${window.location.origin}/details/${m}/${s}`,g=`${t} - ${a}`,R=j=>{x(j.currentTarget)},T=()=>{x(null)},h=async j=>{try{await fetch("/api/social/share",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({shareType:m==="player_availability"?"player":m,targetId:s,targetType:m,platform:j})})}catch($){console.warn("Failed to track share:",$)}},u=async(j,$)=>{try{$(),await h(j),T()}catch(Y){console.error("Share failed:",Y),S({open:!0,message:"Failed to share. Please try again.",severity:"error"})}},O=()=>{const j=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(C)}&quote=${encodeURIComponent(g)}`;window.open(j,"_blank","width=600,height=400")},B=()=>{const j=`https://twitter.com/intent/tweet?text=${encodeURIComponent(g)}&url=${encodeURIComponent(C)}&hashtags=GrassrootsFootball,Football`;window.open(j,"_blank","width=600,height=400")},L=()=>{const j=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(C)}`;window.open(j,"_blank","width=600,height=400")},W=()=>{const j=`https://wa.me/?text=${encodeURIComponent(`${g} ${C}`)}`;window.open(j,"_blank")},o=()=>{const j=encodeURIComponent(t),$=encodeURIComponent(`${a}

Check it out: ${C}

Shared from The Grassroots Hub`);window.location.href=`mailto:?subject=${j}&body=${$}`},k=async()=>{try{await navigator.clipboard.writeText(`${g}
${C}`),S({open:!0,message:"Link copied to clipboard!",severity:"success"})}catch{const $=document.createElement("textarea");$.value=`${g}
${C}`,document.body.appendChild($),$.select(),document.execCommand("copy"),document.body.removeChild($),S({open:!0,message:"Link copied to clipboard!",severity:"success"})}},G=[{name:"Facebook",icon:e.jsx(ts,{sx:{color:"#1877f2"}}),action:()=>u("facebook",O)},{name:"Twitter",icon:e.jsx(as,{sx:{color:"#1da1f2"}}),action:()=>u("twitter",B)},{name:"LinkedIn",icon:e.jsx(ns,{sx:{color:"#0077b5"}}),action:()=>u("linkedin",L)},{name:"WhatsApp",icon:e.jsx(rs,{sx:{color:"#25d366"}}),action:()=>u("whatsapp",W)},{name:"Email",icon:e.jsx(os,{sx:{color:"#ea4335"}}),action:()=>u("email",o)},{name:"Copy Link",icon:e.jsx(is,{}),action:()=>u("copy",k)}];return e.jsxs(n,{children:[e.jsx(es,{title:"Share",children:e.jsx(N,{onClick:R,size:d,sx:{color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"action.hover"}},children:e.jsx(ve,{})})}),e.jsx(be,{anchorEl:f,open:!!f,onClose:T,PaperProps:{sx:{minWidth:200,boxShadow:3}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:G.map(j=>e.jsxs(v,{onClick:j.action,sx:{py:1.5,"&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(Ce,{sx:{minWidth:36},children:j.icon}),e.jsx(we,{primary:j.name})]},j.name))}),e.jsx(ss,{open:p.open,autoHideDuration:3e3,onClose:()=>S(j=>({...j,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(M,{onClose:()=>S(j=>({...j,open:!1})),severity:p.severity,variant:"filled",children:p.message})})]})},Gs=({limit:m=6,showHeader:s=!0})=>{const t=Ie(),[a,l]=y.useState([]),[d,f]=y.useState(!0),[x,p]=y.useState("");y.useEffect(()=>{S()},[m]);const S=async()=>{try{f(!0),p("");const h=await H.get(`/recommendations?limit=${m}`);l(h.data.recommendations)}catch(h){p("Failed to load recommendations"),console.error("Error loading recommendations:",h)}finally{f(!1)}},C=h=>{const u=h.type==="vacancy"?`/search?tab=vacancies&id=${h.id}`:`/search?tab=players&id=${h.id}`;t(u),g("view_recommendation",h)},g=async(h,u)=>{try{await H.post("/engagement/track",{actionType:h,targetId:u.id,targetType:u.type==="vacancy"?"vacancy":"player_availability",metadata:{recommendationScore:u.score,source:"recommendations_widget"}})}catch(O){console.warn("Failed to track interaction:",O)}},R=h=>{const u=h.type==="vacancy";return e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(I,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:4}},children:e.jsxs(A,{sx:{flexGrow:1},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:2},children:[u?e.jsx(K,{sx:{color:"primary.main",mr:1}}):e.jsx(J,{sx:{color:"secondary.main",mr:1}}),e.jsx(V,{label:u?"Team Vacancy":"Player Available",color:u?"primary":"secondary",size:"small",variant:"outlined"})]}),e.jsx(i,{variant:"h6",component:"h3",gutterBottom:!0,children:h.title}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:h.description}),e.jsxs(n,{sx:{mb:2},children:[u?e.jsx(e.Fragment,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(K,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsxs(i,{variant:"body2",children:[h.metadata.position," • ",h.metadata.league]})]})}):e.jsx(e.Fragment,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(K,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsxs(i,{variant:"body2",children:[h.metadata.positions?.join(", ")," • ",h.metadata.preferredLeagues]})]})}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ls,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsx(i,{variant:"body2",children:h.metadata.ageGroup})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(cs,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsx(i,{variant:"body2",children:h.metadata.location})]}),e.jsxs(i,{variant:"caption",color:"text.secondary",children:["Posted by ",h.metadata.postedBy]})]}),e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:"auto"},children:[e.jsx(w,{variant:"contained",size:"small",onClick:()=>C(h),sx:{flexGrow:1,mr:1},children:"View Details"}),e.jsx(Pe,{shareType:h.type==="vacancy"?"vacancy":"player_availability",targetId:h.id,title:h.title,description:h.description,size:"small"})]})]})})},`${h.type}-${h.id}`)},T=()=>Array.from({length:m}).map((h,u)=>e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsx(I,{sx:{height:"100%"},children:e.jsxs(A,{children:[e.jsx(D,{variant:"rectangular",height:24,sx:{mb:2}}),e.jsx(D,{variant:"text",height:32,sx:{mb:1}}),e.jsx(D,{variant:"text",height:40,sx:{mb:2}}),e.jsx(D,{variant:"text",height:20,sx:{mb:1}}),e.jsx(D,{variant:"text",height:20,sx:{mb:1}}),e.jsx(D,{variant:"text",height:20,sx:{mb:2}}),e.jsx(D,{variant:"rectangular",height:36})]})})},u));return e.jsxs(n,{children:[s&&e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(je,{sx:{mr:1,color:"primary.main"}}),e.jsx(i,{variant:"h5",component:"h2",children:"Recommended for You"})]}),e.jsx(N,{onClick:S,disabled:d,sx:{color:"primary.main","&:hover":{backgroundColor:"primary.main",color:"white"}},children:e.jsx(se,{})})]}),x&&e.jsx(M,{severity:"error",sx:{mb:3},children:x}),e.jsx(c,{container:!0,spacing:3,children:d?T():a.length>0?a.map(R):e.jsx(c,{item:!0,xs:12,children:e.jsx(I,{sx:{textAlign:"center",py:4},children:e.jsxs(A,{children:[e.jsx(je,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No recommendations available"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"We're learning about your preferences. Check back soon for personalized recommendations!"}),e.jsx(w,{variant:"outlined",onClick:S,startIcon:e.jsx(se,{}),children:"Refresh"})]})})})}),a.length>0&&s&&e.jsx(n,{sx:{textAlign:"center",mt:3},children:e.jsx(w,{variant:"outlined",onClick:()=>t("/search"),size:"large",children:"Explore More Opportunities"})})]})},_s=()=>{const m=ds(),s=hs(m.breakpoints.down("md")),t=Ie(),{user:a}=Ae(),[l,d]=y.useState({totalViews:0,totalActions:0,bookmarksCount:0,alertsCount:0,weeklyGrowth:0}),[f,x]=y.useState([]),[p,S]=y.useState(!0),[C,g]=y.useState("");y.useEffect(()=>{T(),R()},[]);const R=async()=>{try{await H.post("/api/engagement/track",{actionType:"page_view",targetType:"dashboard",metadata:{timestamp:new Date().toISOString(),userAgent:navigator.userAgent}})}catch(o){console.warn("Failed to track page view:",o)}},T=async()=>{try{S(!0),d({totalViews:Math.floor(Math.random()*100)+20,totalActions:Math.floor(Math.random()*50)+10,bookmarksCount:Math.floor(Math.random()*15),alertsCount:Math.floor(Math.random()*10),weeklyGrowth:Math.floor(Math.random()*30)+5}),x([{id:1,type:"vacancy",title:"Midfielder Position Open",description:"Looking for experienced midfielder",createdAt:new Date().toISOString(),status:"active"},{id:2,type:"player_availability",title:"New Player Available",description:"Young striker seeking opportunities",createdAt:new Date(Date.now()-864e5).toISOString(),status:"available"}])}catch(o){g("Failed to load dashboard data"),console.error("Dashboard error:",o)}finally{S(!1)}},h=async(o,k={})=>{try{await H.post("/api/engagement/track",{actionType:o,metadata:{...k,source:"dashboard"}})}catch(G){console.warn("Failed to track action:",G)}},u=o=>{switch(h(`quick_action_${o}`),o){case"create_vacancy":t("/post-vacancy");break;case"create_availability":t("/post-availability");break;case"search":t("/search");break;case"calendar":t("/calendar");break;case"bookmarks":t("/bookmarks");break;case"alerts":t("/alerts");break}},O=()=>{const o=new Date().getHours();let k="Good morning";return o>=12&&o<17?k="Good afternoon":o>=17&&(k="Good evening"),`${k}, ${a?.firstName}!`},B=(o,k,G,j)=>e.jsx(I,{sx:{height:"100%"},children:e.jsx(A,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(n,{children:[e.jsx(i,{color:"textSecondary",gutterBottom:!0,variant:"overline",children:o}),e.jsx(i,{variant:"h4",component:"div",children:p?e.jsx(D,{width:60}):k}),j&&e.jsxs(n,{sx:{display:"flex",alignItems:"center",mt:1},children:[e.jsx(U,{sx:{fontSize:16,mr:.5,color:"success.main"}}),e.jsxs(i,{variant:"body2",sx:{color:"success.main"},children:["+",j,"% this week"]})]})]}),e.jsx(js,{sx:{bgcolor:"primary.main",width:56,height:56},children:G})]})})}),L=o=>e.jsx(I,{sx:{mb:2},children:e.jsx(A,{sx:{py:2},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(n,{sx:{flex:1},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(V,{label:o.type==="vacancy"?"Team Vacancy":"Player Available",size:"small",color:o.type==="vacancy"?"primary":"secondary",sx:{mr:1}}),o.status&&e.jsx(V,{label:o.status,size:"small",variant:"outlined"})]}),e.jsx(i,{variant:"body1",fontWeight:"medium",children:o.title}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:1},children:o.description}),e.jsx(i,{variant:"caption",color:"text.secondary",children:new Date(o.createdAt).toLocaleDateString()})]}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",alignItems:"center",ml:2},children:[e.jsx(N,{size:"small",onClick:()=>t(`/search?tab=${o.type}s&id=${o.id}`),children:e.jsx(X,{})}),e.jsx(Pe,{shareType:o.type==="vacancy"?"vacancy":"player_availability",targetId:o.id,title:o.title,description:o.description,size:"small"})]})]})})},o.id),W=[{icon:e.jsx(ye,{}),name:a?.role==="Coach"?"Post Vacancy":"Find Team",action:()=>u(a?.role==="Coach"?"create_vacancy":"search")},{icon:e.jsx(J,{}),name:a?.role==="Coach"?"Find Players":"Post Availability",action:()=>u(a?.role==="Coach"?"search":"create_availability")},{icon:e.jsx(ge,{}),name:"Calendar",action:()=>u("calendar")},{icon:e.jsx(fe,{}),name:"Bookmarks",action:()=>u("bookmarks")}];return e.jsxs(xs,{maxWidth:"lg",sx:{py:3},children:[e.jsxs(n,{sx:{mb:4},children:[e.jsx(i,{variant:"h4",component:"h1",gutterBottom:!0,children:O()}),e.jsx(i,{variant:"body1",color:"text.secondary",children:"Welcome to your grassroots football dashboard. Here's what's happening in your network."})]}),C&&e.jsx(M,{severity:"error",sx:{mb:3},children:C}),e.jsxs(c,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:B("Profile Views",l.totalViews,e.jsx(J,{}),l.weeklyGrowth)}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:B("Actions Taken",l.totalActions,e.jsx(U,{}))}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:B("Bookmarks",l.bookmarksCount,e.jsx(fe,{}))}),e.jsx(c,{item:!0,xs:12,sm:6,md:3,children:B("Active Alerts",l.alertsCount,e.jsx(ys,{}))})]}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(I,{children:e.jsxs(A,{children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2},children:[e.jsx(i,{variant:"h6",component:"h2",children:"Recent Activity"}),e.jsx(w,{size:"small",onClick:()=>t("/activity"),endIcon:e.jsx(X,{}),children:"View All"})]}),p?Array.from({length:3}).map((o,k)=>e.jsx(n,{sx:{mb:2},children:e.jsx(D,{variant:"rectangular",height:80,sx:{mb:1}})},k)):f.length>0?f.slice(0,3).map(L):e.jsx(n,{sx:{textAlign:"center",py:3},children:e.jsx(i,{color:"text.secondary",children:"No recent activity. Start exploring to see updates here!"})})]})})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(I,{children:e.jsxs(A,{children:[e.jsx(i,{variant:"h6",component:"h2",gutterBottom:!0,children:"Quick Actions"}),e.jsxs(c,{container:!0,spacing:2,children:[e.jsx(c,{item:!0,xs:6,children:e.jsx(w,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(ye,{}),onClick:()=>u(a?.role==="Coach"?"create_vacancy":"search"),sx:{py:2},children:a?.role==="Coach"?"Post Vacancy":"Find Team"})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(w,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(J,{}),onClick:()=>u(a?.role==="Coach"?"search":"create_availability"),sx:{py:2},children:a?.role==="Coach"?"Find Players":"Post Availability"})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(w,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(ge,{}),onClick:()=>u("calendar"),sx:{py:2},children:"Calendar"})}),e.jsx(c,{item:!0,xs:6,children:e.jsx(w,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(ee,{}),onClick:()=>t("/alerts"),sx:{py:2},children:"Alert Settings"})})]}),e.jsx(n,{sx:{mt:3},children:e.jsx(w,{fullWidth:!0,variant:"contained",startIcon:e.jsx(X,{}),onClick:()=>u("search"),size:"large",children:"Explore Opportunities"})})]})})}),e.jsx(c,{item:!0,xs:12,children:e.jsx(Gs,{limit:6,showHeader:!0})})]}),s&&e.jsx(ps,{ariaLabel:"Quick Actions",sx:{position:"fixed",bottom:16,right:16},icon:e.jsx(ms,{}),children:W.map(o=>e.jsx(us,{icon:o.icon,tooltipTitle:o.name,onClick:o.action},o.name))})]})};export{Es as A,_s as E,Gs as R,P as a};
