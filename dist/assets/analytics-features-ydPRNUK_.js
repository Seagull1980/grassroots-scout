import{j as e,B as o,g as P,I as U,h as V,M as D,i as M,k as N,l as q,m as Y,n as A,F as H,o as J,p as K,W as Q,E as X,q as Z,R,T as r,r as z,G as f,C as I,a as S,s as $,t as x,u as T,v as ee,d as te,w as ae,x as se}from"./mui-vendor-C1HUv1lu.js";import{r as p,u as oe}from"./react-vendor-BW_9WhSV.js";import{a as E}from"./admin-features-DSNbd77k.js";const ne=({shareType:l,targetId:y,title:j,description:h,url:w,size:g="medium"})=>{const[b,u]=p.useState(null),[m,i]=p.useState({open:!1,message:"",severity:"success"}),c=w||`${window.location.origin}/details/${l}/${y}`,d=`${j} - ${h}`,k=a=>{u(a.currentTarget)},v=()=>{u(null)},t=async a=>{try{await fetch("/api/social/share",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({shareType:l==="player_availability"?"player":l,targetId:y,targetType:l,platform:a})})}catch(n){console.warn("Failed to track share:",n)}},s=async(a,n)=>{try{n(),await t(a),v()}catch(G){console.error("Share failed:",G),i({open:!0,message:"Failed to share. Please try again.",severity:"error"})}},C=()=>{const a=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(c)}&quote=${encodeURIComponent(d)}`;window.open(a,"_blank","width=600,height=400")},F=()=>{const a=`https://twitter.com/intent/tweet?text=${encodeURIComponent(d)}&url=${encodeURIComponent(c)}&hashtags=GrassrootsFootball,Football`;window.open(a,"_blank","width=600,height=400")},L=()=>{const a=`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(c)}`;window.open(a,"_blank","width=600,height=400")},B=()=>{const a=`https://wa.me/?text=${encodeURIComponent(`${d} ${c}`)}`;window.open(a,"_blank")},_=()=>{const a=encodeURIComponent(j),n=encodeURIComponent(`${h}

Check it out: ${c}

Shared from The Grassroots Hub`);window.location.href=`mailto:?subject=${a}&body=${n}`},O=async()=>{try{await navigator.clipboard.writeText(`${d}
${c}`),i({open:!0,message:"Link copied to clipboard!",severity:"success"})}catch{const n=document.createElement("textarea");n.value=`${d}
${c}`,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),i({open:!0,message:"Link copied to clipboard!",severity:"success"})}},W=[{name:"Facebook",icon:e.jsx(H,{sx:{color:"#1877f2"}}),action:()=>s("facebook",C)},{name:"Twitter",icon:e.jsx(J,{sx:{color:"#1da1f2"}}),action:()=>s("twitter",F)},{name:"LinkedIn",icon:e.jsx(K,{sx:{color:"#0077b5"}}),action:()=>s("linkedin",L)},{name:"WhatsApp",icon:e.jsx(Q,{sx:{color:"#25d366"}}),action:()=>s("whatsapp",B)},{name:"Email",icon:e.jsx(X,{sx:{color:"#ea4335"}}),action:()=>s("email",_)},{name:"Copy Link",icon:e.jsx(Z,{}),action:()=>s("copy",O)}];return e.jsxs(o,{children:[e.jsx(P,{title:"Share",children:e.jsx(U,{onClick:k,size:g,sx:{color:"text.secondary","&:hover":{color:"primary.main",backgroundColor:"action.hover"}},children:e.jsx(V,{})})}),e.jsx(D,{anchorEl:b,open:!!b,onClose:v,PaperProps:{sx:{minWidth:200,boxShadow:3}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:W.map(a=>e.jsxs(M,{onClick:a.action,sx:{py:1.5,"&:hover":{backgroundColor:"action.hover"}},children:[e.jsx(N,{sx:{minWidth:36},children:a.icon}),e.jsx(q,{primary:a.name})]},a.name))}),e.jsx(Y,{open:m.open,autoHideDuration:3e3,onClose:()=>i(a=>({...a,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(A,{onClose:()=>i(a=>({...a,open:!1})),severity:m.severity,variant:"filled",children:m.message})})]})},le=({limit:l=6,showHeader:y=!0})=>{const j=oe(),[h,w]=p.useState([]),[g,b]=p.useState(!0),[u,m]=p.useState("");p.useEffect(()=>{i()},[l]);const i=async()=>{try{b(!0),m("");const t=await E.get(`/recommendations?limit=${l}`);w(t.data.recommendations)}catch(t){m("Failed to load recommendations"),console.error("Error loading recommendations:",t)}finally{b(!1)}},c=t=>{const s=t.type==="vacancy"?`/search?tab=vacancies&id=${t.id}`:`/search?tab=players&id=${t.id}`;j(s),d("view_recommendation",t)},d=async(t,s)=>{try{await E.post("/engagement/track",{actionType:t,targetId:s.id,targetType:s.type==="vacancy"?"vacancy":"player_availability",metadata:{recommendationScore:s.score,source:"recommendations_widget"}})}catch(C){console.warn("Failed to track interaction:",C)}},k=t=>{const s=t.type==="vacancy";return e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsx(I,{sx:{height:"100%",display:"flex",flexDirection:"column",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-2px)",boxShadow:4}},children:e.jsxs(S,{sx:{flexGrow:1},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:2},children:[s?e.jsx(T,{sx:{color:"primary.main",mr:1}}):e.jsx(ee,{sx:{color:"secondary.main",mr:1}}),e.jsx(te,{label:s?"Team Vacancy":"Player Available",color:s?"primary":"secondary",size:"small",variant:"outlined"})]}),e.jsx(r,{variant:"h6",component:"h3",gutterBottom:!0,children:t.title}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:2,display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.description}),e.jsxs(o,{sx:{mb:2},children:[s?e.jsx(e.Fragment,{children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(T,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsxs(r,{variant:"body2",children:[t.metadata.position," • ",t.metadata.league]})]})}):e.jsx(e.Fragment,{children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(T,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsxs(r,{variant:"body2",children:[t.metadata.positions?.join(", ")," • ",t.metadata.preferredLeagues]})]})}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ae,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsx(r,{variant:"body2",children:t.metadata.ageGroup})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(se,{sx:{fontSize:16,mr:1,color:"text.secondary"}}),e.jsx(r,{variant:"body2",children:t.metadata.location})]}),e.jsxs(r,{variant:"caption",color:"text.secondary",children:["Posted by ",t.metadata.postedBy]})]}),e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:"auto"},children:[e.jsx($,{variant:"contained",size:"small",onClick:()=>c(t),sx:{flexGrow:1,mr:1},children:"View Details"}),e.jsx(ne,{shareType:t.type==="vacancy"?"vacancy":"player_availability",targetId:t.id,title:t.title,description:t.description,size:"small"})]})]})})},`${t.type}-${t.id}`)},v=()=>Array.from({length:l}).map((t,s)=>e.jsx(f,{item:!0,xs:12,sm:6,md:4,children:e.jsx(I,{sx:{height:"100%"},children:e.jsxs(S,{children:[e.jsx(x,{variant:"rectangular",height:24,sx:{mb:2}}),e.jsx(x,{variant:"text",height:32,sx:{mb:1}}),e.jsx(x,{variant:"text",height:40,sx:{mb:2}}),e.jsx(x,{variant:"text",height:20,sx:{mb:1}}),e.jsx(x,{variant:"text",height:20,sx:{mb:1}}),e.jsx(x,{variant:"text",height:20,sx:{mb:2}}),e.jsx(x,{variant:"rectangular",height:36})]})})},s));return e.jsxs(o,{children:[y&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:3},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(R,{sx:{mr:1,color:"primary.main"}}),e.jsx(r,{variant:"h5",component:"h2",children:"Recommended for You"})]}),e.jsx(U,{onClick:i,disabled:g,sx:{color:"primary.main","&:hover":{backgroundColor:"primary.main",color:"white"}},children:e.jsx(z,{})})]}),u&&e.jsx(A,{severity:"error",sx:{mb:3},children:u}),e.jsx(f,{container:!0,spacing:3,children:g?v():h.length>0?h.map(k):e.jsx(f,{item:!0,xs:12,children:e.jsx(I,{sx:{textAlign:"center",py:4},children:e.jsxs(S,{children:[e.jsx(R,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(r,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No recommendations available"}),e.jsx(r,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"We're learning about your preferences. Check back soon for personalized recommendations!"}),e.jsx($,{variant:"outlined",onClick:i,startIcon:e.jsx(z,{}),children:"Refresh"})]})})})}),h.length>0&&y&&e.jsx(o,{sx:{textAlign:"center",mt:3},children:e.jsx($,{variant:"outlined",onClick:()=>j("/search"),size:"large",children:"Explore More Opportunities"})})]})};export{le as R,ne as S};
