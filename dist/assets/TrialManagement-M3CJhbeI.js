import{j as e,ae as W,i as J,B as o,ak as he,T as a,v as d,w as pe,k as Q,G as r,C as V,a as Y,d as v,a6 as je,f as ge,a8 as ye,ch as ve,bB as fe,cr as X,x as be,y as Ce,I as E,cs as Te,ct as Pe,p as Se,ay as ke,am as Ae,J as R,K as z,N as O,O as p,Q as L,ci as P,F as De,t as we,u as Ie,q as D,U as Fe,W as Ne,Y as We}from"./mui-vendor-rZ0WLTig.js";import{r as c,b as Ee}from"./react-vendor-CRXLTmIH.js";import{u as Re,a as y}from"./admin-features-d6LVy8Ft.js";import{L as ze,A as Oe,D as Le,T as Me}from"./team-features-lrg-PnxP.js";import"./messaging-features-dHWz0ZXd.js";const Ke=()=>{const{user:w}=Re(),[M,Z]=c.useState([]),[l,B]=c.useState(null),[j,ee]=c.useState([]),[te,$]=c.useState(!0),[I,se]=c.useState(null),[re,S]=c.useState(!1),[ae,f]=c.useState(!1),[le,k]=c.useState(!1),[i,g]=c.useState({title:"",description:"",trialDate:null,trialTime:null,location:"",maxPlayers:""}),[x,b]=c.useState({playerId:"",playerName:"",playerAge:"",playerPosition:""}),[u,m]=c.useState({overallRating:0,technicalSkills:0,physicalAttributes:0,mentalStrength:0,teamwork:0,privateNotes:"",strengths:"",areasForImprovement:"",recommendedForTeam:!1,status:"evaluating"}),[A,_]=c.useState({open:!1,message:"",severity:"success"});c.useEffect(()=>{w?.role==="Coach"&&q()},[w]);const q=async()=>{try{$(!0);const t=await y.get("/trial-lists");t.data.success&&Z(t.data.trialLists)}catch(t){console.error("Error fetching trial lists:",t),h("Failed to fetch trial lists","error")}finally{$(!1)}},C=async t=>{try{const s=await y.get(`/trial-lists/${t}`);s.data.success&&(B(s.data.trialList),ee(s.data.players))}catch(s){console.error("Error fetching trial list details:",s),h("Failed to fetch trial list details","error")}},ie=async()=>{try{const t={title:i.title,description:i.description||void 0};i.trialDate&&(t.trialDate=i.trialDate.toISOString().split("T")[0]),i.trialTime&&(t.trialTime=i.trialTime.toTimeString().split(" ")[0].substring(0,5)),i.location&&(t.location=i.location),i.maxPlayers&&(t.maxPlayers=parseInt(i.maxPlayers)),(await y.post("/trial-lists",t)).data.success&&(h("Trial list created successfully","success"),S(!1),xe(),q())}catch(t){console.error("Error creating trial list:",t);const s=t.response?.data?.error||"Failed to create trial list";h(s,"error")}},ne=async()=>{if(l)try{const t={playerId:parseInt(x.playerId),playerName:x.playerName,playerAge:x.playerAge?parseInt(x.playerAge):void 0,playerPosition:x.playerPosition||void 0};(await y.post(`/trial-lists/${l.id}/players`,t)).data.success&&(h("Player added successfully","success"),f(!1),ue(),C(l.id))}catch(t){console.error("Error adding player:",t);const s=t.response?.data?.error||"Failed to add player";h(s,"error")}},oe=async()=>{if(I)try{(await y.put(`/trial-evaluations/${I.id}`,u)).data.success&&(h("Player evaluation updated successfully","success"),k(!1),l&&C(l.id))}catch(t){console.error("Error updating evaluation:",t);const s=t.response?.data?.error||"Failed to update evaluation";h(s,"error")}},G=async(t,s)=>{const n=j.find(T=>T.id===t);if(!n)return;const N=s==="up"?n.ranking-1:n.ranking+1;if(!(N<1||N>j.length))try{(await y.put(`/trial-evaluations/${t}/ranking`,{newRanking:N})).data.success&&l&&C(l.id)}catch(T){console.error("Error moving player:",T);const me=T.response?.data?.error||"Failed to move player";h(me,"error")}},ce=async t=>{if(confirm("Are you sure you want to remove this player from the trial list?"))try{(await y.delete(`/trial-evaluations/${t}`)).data.success&&(h("Player removed successfully","success"),l&&C(l.id))}catch(s){console.error("Error removing player:",s);const n=s.response?.data?.error||"Failed to remove player";h(n,"error")}},de=t=>{se(t),m({overallRating:t.overallRating||0,technicalSkills:t.technicalSkills||0,physicalAttributes:t.physicalAttributes||0,mentalStrength:t.mentalStrength||0,teamwork:t.teamwork||0,privateNotes:t.privateNotes||"",strengths:t.strengths||"",areasForImprovement:t.areasForImprovement||"",recommendedForTeam:t.recommendedForTeam,status:t.status}),k(!0)},xe=()=>{g({title:"",description:"",trialDate:null,trialTime:null,location:"",maxPlayers:""})},ue=()=>{b({playerId:"",playerName:"",playerAge:"",playerPosition:""})},h=(t,s)=>{_({open:!0,message:t,severity:s})},K=()=>{_({...A,open:!1})},H=t=>t?new Date(t).toLocaleDateString():"Not set",U=t=>t?t.substring(0,5):"Not set",F=t=>{switch(t){case"active":return"primary";case"completed":return"success";case"cancelled":return"error";case"approved":return"success";case"rejected":return"error";case"pending":return"warning";default:return"default"}};return w?.role!=="Coach"?e.jsx(W,{maxWidth:"lg",sx:{mt:4,mb:4},children:e.jsx(J,{severity:"error",children:"Only coaches can access trial management features."})}):te?e.jsx(W,{maxWidth:"lg",sx:{mt:4,mb:4},children:e.jsx(o,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"300px",children:e.jsx(he,{})})}):e.jsx(ze,{dateAdapter:Oe,children:e.jsxs(W,{maxWidth:"lg",sx:{mt:4,mb:4},children:[l?e.jsxs(e.Fragment,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(a,{variant:"h4",component:"h1",children:l.title}),e.jsxs(o,{children:[e.jsx(d,{variant:"outlined",startIcon:e.jsx(X,{}),onClick:()=>f(!0),sx:{mr:1},children:"Add Player"}),e.jsx(d,{variant:"outlined",onClick:()=>B(null),children:"Back to Lists"})]})]}),e.jsx(V,{sx:{mb:3},children:e.jsxs(Y,{children:[e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Status: ",e.jsx(v,{label:l.status,color:F(l.status),size:"small"})]})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Players: ",j.length,l.maxPlayers?`/${l.maxPlayers}`:""]})}),l.trialDate&&e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Date & Time: ",H(l.trialDate)," at ",U(l.trialTime)]})}),l.location&&e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Location: ",l.location]})})]}),l.description&&e.jsx(a,{variant:"body1",sx:{mt:2},children:l.description})]})}),j.length===0?e.jsxs(Q,{sx:{p:4,textAlign:"center"},children:[e.jsx(a,{variant:"h6",color:"text.secondary",children:"No players added to this trial list yet."}),e.jsx(d,{variant:"contained",startIcon:e.jsx(X,{}),onClick:()=>f(!0),sx:{mt:2},children:"Add First Player"})]}):e.jsx(be,{children:j.map((t,s)=>e.jsxs(Ee.Fragment,{children:[e.jsx(Ce,{children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",width:"100%"},children:[e.jsx(o,{sx:{mr:2,minWidth:40},children:e.jsxs(a,{variant:"h6",color:"primary",children:["#",t.ranking]})}),e.jsxs(o,{sx:{flex:1},children:[e.jsx(a,{variant:"h6",children:t.playerName}),e.jsxs(o,{sx:{display:"flex",gap:1,mt:1},children:[t.playerAge&&e.jsx(v,{label:`Age ${t.playerAge}`,size:"small"}),t.playerPosition&&e.jsx(v,{label:t.playerPosition,size:"small",color:"secondary"}),e.jsx(v,{label:t.status,color:F(t.status),size:"small"}),t.overallRating&&e.jsx(v,{label:`${t.overallRating}/10`,color:"primary",size:"small"})]})]}),e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(E,{onClick:()=>G(t.id,"up"),disabled:s===0,size:"small",children:e.jsx(Te,{})}),e.jsx(E,{onClick:()=>G(t.id,"down"),disabled:s===j.length-1,size:"small",children:e.jsx(Pe,{})}),e.jsx(d,{variant:"outlined",size:"small",startIcon:e.jsx(Se,{}),onClick:()=>de(t),children:"Evaluate"}),e.jsx(E,{onClick:()=>ce(t.id),color:"error",size:"small",children:e.jsx(ke,{})})]})]})}),s<j.length-1&&e.jsx(Ae,{})]},t.id))})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(a,{variant:"h4",component:"h1",children:"Trial Management"}),e.jsx(d,{variant:"contained",startIcon:e.jsx(pe,{}),onClick:()=>S(!0),children:"Create New Trial List"})]}),M.length===0?e.jsxs(Q,{sx:{p:4,textAlign:"center"},children:[e.jsx(a,{variant:"h6",color:"text.secondary",children:"No trial lists created yet."}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Create your first trial list to start evaluating players for your team."})]}):e.jsx(r,{container:!0,spacing:3,children:M.map(t=>e.jsx(r,{item:!0,xs:12,md:6,lg:4,children:e.jsxs(V,{children:[e.jsxs(Y,{children:[e.jsx(a,{variant:"h6",gutterBottom:!0,children:t.title}),e.jsx(v,{label:t.status,color:F(t.status),size:"small",sx:{mb:1}}),t.description&&e.jsx(a,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:t.description}),e.jsxs(o,{sx:{mt:2},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(je,{fontSize:"small",sx:{mr:1}}),e.jsxs(a,{variant:"body2",children:[t.playerCount," players"]})]}),t.trialDate&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ge,{fontSize:"small",sx:{mr:1}}),e.jsxs(a,{variant:"body2",children:[H(t.trialDate)," at ",U(t.trialTime)]})]}),t.location&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ye,{fontSize:"small",sx:{mr:1}}),e.jsx(a,{variant:"body2",children:t.location})]}),t.avgRating&&e.jsxs(o,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(ve,{fontSize:"small",sx:{mr:1}}),e.jsxs(a,{variant:"body2",children:["Avg Rating: ",t.avgRating.toFixed(1),"/10"]})]})]})]}),e.jsx(fe,{children:e.jsx(d,{size:"small",onClick:()=>C(t.id),children:"View Details"})})]})},t.id))})]}),e.jsxs(R,{open:re,onClose:()=>S(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(z,{children:"Create New Trial List"}),e.jsx(O,{children:e.jsxs(r,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Trial List Title",value:i.title,onChange:t=>g(s=>({...s,title:t.target.value})),required:!0})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Description (Optional)",multiline:!0,rows:3,value:i.description,onChange:t=>g(s=>({...s,description:t.target.value}))})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsx(Le,{label:"Trial Date (Optional)",value:i.trialDate,onChange:t=>g(s=>({...s,trialDate:t})),sx:{width:"100%"}})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsx(Me,{label:"Trial Time (Optional)",value:i.trialTime,onChange:t=>g(s=>({...s,trialTime:t})),sx:{width:"100%"}})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsx(p,{fullWidth:!0,label:"Location (Optional)",value:i.location,onChange:t=>g(s=>({...s,location:t.target.value}))})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsx(p,{fullWidth:!0,label:"Max Players (Optional)",type:"number",value:i.maxPlayers,onChange:t=>g(s=>({...s,maxPlayers:t.target.value})),inputProps:{min:1,max:100}})})]})}),e.jsxs(L,{children:[e.jsx(d,{onClick:()=>S(!1),children:"Cancel"}),e.jsx(d,{onClick:ie,variant:"contained",disabled:!i.title.trim(),children:"Create Trial List"})]})]}),e.jsxs(R,{open:ae,onClose:()=>f(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(z,{children:"Add Player to Trial"}),e.jsx(O,{children:e.jsxs(r,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Player ID",type:"number",value:x.playerId,onChange:t=>b(s=>({...s,playerId:t.target.value})),required:!0,helperText:"Enter the player's user ID from the system"})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Player Name",value:x.playerName,onChange:t=>b(s=>({...s,playerName:t.target.value})),required:!0})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsx(p,{fullWidth:!0,label:"Age (Optional)",type:"number",value:x.playerAge,onChange:t=>b(s=>({...s,playerAge:t.target.value})),inputProps:{min:5,max:50}})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsx(p,{fullWidth:!0,label:"Position (Optional)",value:x.playerPosition,onChange:t=>b(s=>({...s,playerPosition:t.target.value}))})})]})}),e.jsxs(L,{children:[e.jsx(d,{onClick:()=>f(!1),children:"Cancel"}),e.jsx(d,{onClick:ne,variant:"contained",disabled:!x.playerId||!x.playerName.trim(),children:"Add Player"})]})]}),e.jsxs(R,{open:le,onClose:()=>k(!1),maxWidth:"md",fullWidth:!0,children:[e.jsxs(z,{children:["Evaluate Player: ",I?.playerName]}),e.jsx(O,{children:e.jsxs(r,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{variant:"h6",gutterBottom:!0,children:"Performance Ratings"})}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsx(a,{component:"legend",children:"Overall Rating"}),e.jsx(P,{value:u.overallRating,onChange:(t,s)=>{m(n=>({...n,overallRating:s||0}))},max:10})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsx(a,{component:"legend",children:"Technical Skills"}),e.jsx(P,{value:u.technicalSkills,onChange:(t,s)=>{m(n=>({...n,technicalSkills:s||0}))},max:10})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsx(a,{component:"legend",children:"Physical Attributes"}),e.jsx(P,{value:u.physicalAttributes,onChange:(t,s)=>{m(n=>({...n,physicalAttributes:s||0}))},max:10})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsx(a,{component:"legend",children:"Mental Strength"}),e.jsx(P,{value:u.mentalStrength,onChange:(t,s)=>{m(n=>({...n,mentalStrength:s||0}))},max:10})]}),e.jsxs(r,{item:!0,xs:12,sm:6,children:[e.jsx(a,{component:"legend",children:"Teamwork"}),e.jsx(P,{value:u.teamwork,onChange:(t,s)=>{m(n=>({...n,teamwork:s||0}))},max:10})]}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Strengths",value:u.strengths,onChange:t=>m(s=>({...s,strengths:t.target.value})),multiline:!0,rows:2})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Areas for Improvement",value:u.areasForImprovement,onChange:t=>m(s=>({...s,areasForImprovement:t.target.value})),multiline:!0,rows:2})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Private Notes",value:u.privateNotes,onChange:t=>m(s=>({...s,privateNotes:t.target.value})),multiline:!0,rows:4,helperText:"These notes are private and only visible to you"})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsxs(De,{fullWidth:!0,children:[e.jsx(we,{children:"Status"}),e.jsxs(Ie,{value:u.status,onChange:t=>m(s=>({...s,status:t.target.value})),children:[e.jsx(D,{value:"evaluating",children:"Evaluating"}),e.jsx(D,{value:"approved",children:"Approved"}),e.jsx(D,{value:"rejected",children:"Rejected"}),e.jsx(D,{value:"pending",children:"Pending Decision"})]})]})}),e.jsx(r,{item:!0,xs:12,sm:6,children:e.jsx(Fe,{control:e.jsx(Ne,{checked:u.recommendedForTeam,onChange:t=>m(s=>({...s,recommendedForTeam:t.target.checked}))}),label:"Recommend for Team"})})]})}),e.jsxs(L,{children:[e.jsx(d,{onClick:()=>k(!1),children:"Cancel"}),e.jsx(d,{onClick:oe,variant:"contained",children:"Save Evaluation"})]})]}),e.jsx(We,{open:A.open,autoHideDuration:6e3,onClose:K,children:e.jsx(J,{onClose:K,severity:A.severity,sx:{width:"100%"},children:A.message})})]})})};export{Ke as default};
