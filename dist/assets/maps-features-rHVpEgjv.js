import{j as e,i as it,B as g,ak as Rt,k as Z,G as w,v as p,al as $t,am as T,an as le,ao as Bt,ap as Ut,aq as Qe,ar as Nt,as as Ot,U as Wt,W as Xe,at as _t,aj as Tt,a1 as et,T as d,au as Yt,O as ce,F as qt,t as Ht,u as Kt,q as Q,av as Vt,C as Fe,a as Re,aw as tt,d as G,J as de,K as ue,N as ge,Q as me,M as Jt,E as Zt,ax as Qt,I as he,ay as at,Y as Xt,az as st,V as ea,aA as ta}from"./mui-vendor-rZ0WLTig.js";import{r as i,b as X,u as aa}from"./react-vendor-CRXLTmIH.js";import{i as Ne}from"./maps-vendor-PjF4sKa1.js";import{u as sa,e as pe,g as nt,b as ot}from"./admin-features-d6LVy8Ft.js";const U={apiKey:"AIzaSyCPOJ5YQDzy8pLMZGsqCxhQb_6VGd9Nxwk",libraries:["places","geometry","marker"],version:"weekly",defaultCenter:{lat:51.5074,lng:-.1278},defaultZoom:10,searchRadius:500,mapId:"GRASSROOTS_HUB_MAP",mapOptions:{disableDefaultUI:!1,zoomControl:!0,streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0}};""+btoa(`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#2196F3" width="24" height="24">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
      </svg>
    `),""+btoa(`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#4CAF50" width="24" height="24">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
      </svg>
    `),""+btoa(`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#FF5722" width="24" height="24">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>
    `),""+btoa(`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#FF9800" width="24" height="24">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
      </svg>
    `);const na=r=>{switch(r){case Ne.Status.LOADING:return e.jsx(g,{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",children:e.jsx(Rt,{})});case Ne.Status.FAILURE:return e.jsx(it,{severity:"error",sx:{m:2},children:e.jsxs(g,{children:[e.jsx("strong",{children:"Google Maps Loading Failed"}),e.jsx("br",{}),e.jsx("br",{}),"This is likely due to a billing or API configuration issue. To resolve:",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"1. Enable Billing:"}),e.jsx("br",{}),"â€¢ Go to Google Cloud Console: ",e.jsx("a",{href:"https://console.cloud.google.com/",target:"_blank",rel:"noopener noreferrer",children:"console.cloud.google.com"}),e.jsx("br",{}),"â€¢ Navigate to Billing and enable billing for your project",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"2. Enable Required APIs:"}),e.jsx("br",{}),"â€¢ Maps JavaScript API",e.jsx("br",{}),"â€¢ Places API",e.jsx("br",{}),"â€¢ Geocoding API",e.jsx("br",{}),"â€¢ Geometry API",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"3. Check API Key Restrictions:"}),e.jsx("br",{}),"â€¢ Ensure your API key is not restricted to specific domains",e.jsx("br",{}),"â€¢ Or add localhost and your domain to allowed referrers"]})});default:return e.jsx("div",{children:"Loading map..."})}},oa=({children:r})=>{const c=U.apiKey;return e.jsx(Ne.Wrapper,{apiKey:c,render:na,libraries:U.libraries,version:U.version,children:r})},ia=({center:r,zoom:c,children:f,onMapLoad:u,style:S={height:"400px",width:"100%"}})=>{const k=i.useRef(null),[b,I]=i.useState(),E=i.useCallback(()=>{if(k.current&&!b){const C=new google.maps.Map(k.current,{center:r,zoom:c,mapId:U.mapId,...U.mapOptions});I(C),u?.(C)}},[r,c,b,u]);return X.useEffect(()=>{E()},[E]),X.useEffect(()=>{b&&(b.setCenter(r),b.setZoom(c))},[b,r,c]),e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:k,style:S}),X.Children.map(f,C=>X.isValidElement(C)?X.cloneElement(C,{map:b}):C)]})},$e=(r,c)=>{const u=fe(c.lat-r.lat),S=fe(c.lng-r.lng),k=Math.sin(u/2)*Math.sin(u/2)+Math.cos(fe(r.lat))*Math.cos(fe(c.lat))*Math.sin(S/2)*Math.sin(S/2);return 6371*(2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)))},fe=r=>r*Math.PI/180,ma=async r=>new Promise(c=>{if(!window.google){c(null);return}new google.maps.Geocoder().geocode({address:r},(u,S)=>{if(S==="OK"&&u&&u[0]){const k=u[0],b={address:k.formatted_address,latitude:k.geometry.location.lat(),longitude:k.geometry.location.lng(),placeId:k.place_id};c(b)}else c(null)})}),ra=()=>new Promise(r=>{if(!navigator.geolocation){console.warn("Geolocation is not supported by this browser"),r({error:"Geolocation not supported",userMessage:"Geolocation is not supported by your browser. Please click on the map to set your location."});return}navigator.geolocation.getCurrentPosition(c=>{console.log("Location obtained successfully:",c.coords),r({lat:c.coords.latitude,lng:c.coords.longitude})},c=>{let f="Unknown error",u="warn",S="Could not get your location. Please try again.";switch(c.code){case 1:f="Location access denied by user",S="Location access denied. Please allow location permissions and try again.",u="info";break;case 2:f="Location information unavailable (GPS/network issue)",S="Location unavailable. Please check your GPS/network connection and try again.";break;case 3:f="Location request timed out after 15 seconds",S="Location request timed out. Please try again or click on the map manually.";break;default:f=`Unknown geolocation error (code: ${c.code})`,S="Location error occurred. Please try clicking on the map manually."}u==="info"?console.info("Geolocation:",f,{code:c.code,message:c.message}):console.warn("Geolocation failed:",f,{code:c.code,message:c.message,error:c}),r({error:f,userMessage:S})},{timeout:15e3,enableHighAccuracy:!0,maximumAge:6e4})}),Be=r=>r<1?`${Math.round(r*1e3)}m`:`${r.toFixed(1)}km`,la=({position:r,map:c,title:f,icon:u,onClick:S,children:k})=>{const[b,I]=i.useState(),[E,C]=i.useState();return i.useEffect(()=>{if(!c)return;let A;if(window.google?.maps?.marker?.AdvancedMarkerElement)try{let x;typeof u=="string"&&u.includes("red-dot")?x=new google.maps.marker.PinElement({background:"#EA4335",borderColor:"#C5221F",glyphColor:"#FFFFFF"}):typeof u=="string"&&u.includes("blue-dot")&&(x=new google.maps.marker.PinElement({background:"#4285F4",borderColor:"#1A73E8",glyphColor:"#FFFFFF"})),A=new google.maps.marker.AdvancedMarkerElement({position:r,map:c,title:f,content:x?.element}),console.log("AdvancedMarkerElement created:",{position:r,title:f})}catch(x){console.warn("Failed to create AdvancedMarkerElement, falling back to legacy marker:",x),A=new google.maps.Marker({position:r,map:c,title:f,icon:u}),console.log("Legacy Marker created:",{position:r,title:f})}else A=new google.maps.Marker({position:r,map:c,title:f,icon:u}),console.log("Legacy Marker created (API not available):",{position:r,title:f});if(I(A),k){const x=new google.maps.InfoWindow;C(x)}return()=>{A&&(A instanceof google.maps.Marker?A.setMap(null):window.google?.maps?.marker?.AdvancedMarkerElement&&A instanceof google.maps.marker.AdvancedMarkerElement&&(A.map=null))}},[c,r,f,u,k]),i.useEffect(()=>{if(!b)return;const A=()=>{if(console.log("Marker clicked!",{title:f,position:r}),S?.(),E&&k){const F=document.createElement("div");E.setContent(F),b instanceof google.maps.Marker?E.open(c,b):(E.setPosition(r),E.open(c))}};let x;return(b instanceof google.maps.Marker||window.google?.maps?.marker?.AdvancedMarkerElement&&b instanceof google.maps.marker.AdvancedMarkerElement)&&(x=b.addListener("click",A)),()=>{x&&google.maps.event.removeListener(x)}},[b,S,E,k,c,r]),null},Ue="grassroots-hub-saved-regions",ha=({searchType:r})=>{const{user:c}=sa(),f=aa(),[u,S]=i.useState(U.defaultCenter),[k,b]=i.useState(U.defaultZoom),[I,E]=i.useState(U.searchRadius),[C,A]=i.useState([]),[x,F]=i.useState(null),[,ee]=i.useState(!1),[P,rt]=i.useState(),[R,Y]=i.useState({isActive:!1,mode:"view",currentPolygon:null}),[q,xe]=i.useState(!1),[$,te]=i.useState([]),[ye,ae]=i.useState([]),[O,ve]=i.useState(null),[y,je]=i.useState(null),[M,be]=i.useState(!1),[W,we]=i.useState([]),[lt,se]=i.useState(!1),[H,Oe]=i.useState(""),[ct,Se]=i.useState(!1),[dt,ut]=i.useState(null),[ke,m]=i.useState({open:!1,message:"",severity:"success"}),[L,Ce]=i.useState(new Set),[z,We]=i.useState(!1),[gt,ne]=i.useState(!1),[B,_e]=i.useState({subject:"",message:""}),[v,mt]=i.useState(!1),[oe,Le]=i.useState(!1),[Ae,Te]=i.useState(null),[Me,ie]=i.useState(!1),[K,ht]=i.useState([]),[pt,V]=i.useState(!1),[h,Ie]=i.useState(""),[j,De]=i.useState(""),[Ee,ft]=i.useState(!1),xt=["County League","Regional League","Youth League","Premier Youth League","Championship Youth","Local League"],yt=["Under 6","Under 7","Under 8","Under 9","Under 10","Under 11","Under 12","Under 13","Under 14","Under 15","Under 16","Under 17","Under 18","Under 19","Under 20","Under 21","Senior","Veterans"],Ye=()=>{const t=[{item:{id:"test-1",title:"Striker Needed - Arsenal Youth FC",description:"We are looking for a talented striker to join our Under 16 team. Great coaching and facilities available.",league:"Premier Youth League",ageGroup:"Under 16",position:"Striker",location:"North London",contactInfo:"coach@arsenalyouth.com",status:"active",createdAt:"2024-10-01",firstName:"John",lastName:"Smith",postedBy:"1",locationData:{address:"North London, UK",latitude:51.5558,longitude:-.1088}},distance:2.1,type:"vacancy"},{item:{id:"test-2",title:"Midfielder Position Available",description:"Chelsea Youth looking for a creative midfielder. Join our successful Under 18 squad.",league:"Championship Youth",ageGroup:"Under 18",position:"Midfielder",location:"West London",contactInfo:"recruitment@chelseayouth.com",status:"active",createdAt:"2024-10-02",firstName:"Sarah",lastName:"Johnson",postedBy:"2",locationData:{address:"West London, UK",latitude:51.4816,longitude:-.1909}},distance:3.8,type:"vacancy"},{item:{id:"test-3",title:"Goalkeeper Opportunity",description:"Tottenham Youth FC seeking a reliable goalkeeper for our Under 17 team. Excellent development program.",league:"Premier Youth League",ageGroup:"Under 17",position:"Goalkeeper",location:"North London",contactInfo:"youth@tottenham.com",status:"active",createdAt:"2024-10-03",firstName:"Mike",lastName:"Williams",postedBy:"3",locationData:{address:"North London, UK",latitude:51.6042,longitude:-.0664}},distance:1.9,type:"vacancy"}],a=[{item:{id:"player-1",title:"Experienced Midfielder Available",description:"Creative midfielder with excellent passing ability. Looking for a competitive team to develop further.",preferredLeagues:["Premier Youth League","Championship Youth"],ageGroup:"Under 17",positions:["Central Midfielder","Attacking Midfielder"],location:"East London",contactInfo:"alex.thompson@email.com",postedBy:"101",createdAt:"2024-10-01",status:"active",locationData:{address:"East London, UK",latitude:51.5154,longitude:.0033}},distance:4.2,type:"availability"},{item:{id:"player-2",title:"Defensive Player Seeking Team",description:"Strong defender with great leadership qualities. Captain of school team.",preferredLeagues:["County League","Youth League"],ageGroup:"Under 16",positions:["Centre-Back","Left-Back"],location:"South London",contactInfo:"emma.davis@email.com",postedBy:"102",createdAt:"2024-10-02",status:"active",locationData:{address:"South London, UK",latitude:51.4632,longitude:-.1115}},distance:2.7,type:"availability"}];return[...t,...a]};i.useEffect(()=>{const t=localStorage.getItem(Ue);if(t)try{const a=JSON.parse(t).map(n=>({...n,createdAt:new Date(n.createdAt),coordinates:n.coordinates.map(s=>new google.maps.LatLng(s.lat,s.lng))}));we(a)}catch(a){console.error("Error loading saved regions:",a)}},[]),i.useEffect(()=>{c&&re()},[c]),i.useEffect(()=>{const t=()=>{const a=navigator.userAgent||"",n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a),s=window.innerWidth<768;mt(n||s)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),i.useEffect(()=>{if(!v)return;const t=s=>{Te(s.touches[0].clientY),ie(!1)},a=s=>{if(Ae===null)return;const o=s.touches[0].clientY,l=Ae-o;l>50&&!Me?(ie(!0),Le(!0)):l<-50&&!Me&&(ie(!0),Le(!1))},n=()=>{Te(null),ie(!1)};return document.addEventListener("touchstart",t),document.addEventListener("touchmove",a),document.addEventListener("touchend",n),()=>{document.removeEventListener("touchstart",t),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",n)}},[Ae,Me,v]);const Pe=i.useCallback(()=>{if(!P||$.length<3)return;y&&y.setMap(null),ye.forEach(a=>{"setMap"in a&&typeof a.setMap=="function"?a.setMap(null):google.maps.event.removeListener(a)}),ae([]),O&&(O.setMap(null),ve(null));const t=new google.maps.Polygon({paths:$,strokeColor:"#2196F3",strokeOpacity:.8,strokeWeight:3,fillColor:"#2196F3",fillOpacity:.2,editable:!0,draggable:!0,map:P});je(t),Y(a=>({...a,isActive:!1,mode:"edit",currentPolygon:t})),be(!0),xe(!1),te([]),Ve(t),_(t),m({open:!0,message:"Search area drawn! You can now save this region or edit it by dragging the corners.",severity:"success"})},[P,$,y,ye]);i.useEffect(()=>{const t=a=>{q&&(a.key==="Enter"&&$.length>=3?(a.preventDefault(),Pe()):a.key==="Escape"&&(a.preventDefault(),Je()))};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[q,$,Pe]);const re=async()=>{try{const t=await pe.getAll();ht(t.alerts)}catch(t){console.error("Error loading email alerts:",t)}},ze=t=>{const a=new Set(L);a.has(t)?a.delete(t):a.add(t),Ce(a)},vt=()=>{const t=new Set(C.map((a,n)=>`${a.type}_${n}`));Ce(t)},qe=()=>{Ce(new Set),We(!1)},He=()=>C.filter((t,a)=>L.has(`${t.type}_${a}`)),jt=async()=>{const t=He(),a=t.map(async n=>{const s=n.item;return n.type==="vacancy"?fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({recipientId:s.postedBy,subject:B.subject,message:B.message,relatedVacancyId:s.id,messageType:"vacancy_interest"})}):fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({recipientId:s.postedBy,subject:B.subject,message:B.message,relatedPlayerAvailabilityId:s.id,messageType:"player_inquiry"})})});try{await Promise.all(a),m({open:!0,message:`Successfully contacted ${t.length} ${t.length===1?"person":"people"}!`,severity:"success"}),ne(!1),qe()}catch(n){console.error("Bulk contact error:",n),m({open:!0,message:"Some messages failed to send. Please try again.",severity:"error"})}},Ke=async t=>{if(!c){m({open:!0,message:"Please log in to create email alerts",severity:"error"});return}try{const a={alertType:t};if(t==="new_match"){if(a.filters={league:h||void 0,ageGroup:j||void 0,radius:M?void 0:I,center:M?void 0:u},M&&y){const n=y.getPath(),s=[];for(let o=0;o<n.getLength();o++){const l=n.getAt(o);s.push({lat:l.lat(),lng:l.lng()})}a.searchRegion={name:`Search Area ${new Date().toLocaleDateString()}`,coordinates:s}}}else if(t==="saved_search"&&y){const n=y.getPath(),s=[];for(let o=0;o<n.getLength();o++){const l=n.getAt(o);s.push({lat:l.lat(),lng:l.lng()})}a.searchRegion={name:H||`Search Area ${new Date().toLocaleDateString()}`,coordinates:s},a.filters={league:h||void 0,ageGroup:j||void 0}}await pe.create(a),m({open:!0,message:"Email alert created successfully! You'll be notified of new matches.",severity:"success"}),re(),V(!1)}catch(a){console.error("Error creating email alert:",a),m({open:!0,message:"Failed to create email alert. Please try again.",severity:"error"})}},bt=async t=>{try{await pe.delete(t),m({open:!0,message:"Email alert deleted",severity:"success"}),re()}catch(a){console.error("Error deleting email alert:",a),m({open:!0,message:"Failed to delete email alert",severity:"error"})}},wt=async(t,a)=>{try{await pe.update(t,{isActive:a}),m({open:!0,message:`Email alert ${a?"enabled":"disabled"}`,severity:"success"}),re()}catch(n){console.error("Error updating email alert:",n),m({open:!0,message:"Failed to update email alert",severity:"error"})}},St=i.useCallback(t=>{rt(t);const a=l=>{if(q&&l.latLng){const D=[...$,l.latLng];te(D);const Ft=new google.maps.Marker({position:l.latLng,map:t,icon:{path:google.maps.SymbolPath.CIRCLE,scale:4,fillColor:"#2196F3",fillOpacity:1,strokeColor:"#1976D2",strokeWeight:2}});if(O&&O.setMap(null),D.length>1){const Ge=new google.maps.Polyline({path:D,strokeColor:"#2196F3",strokeWeight:2,strokeOpacity:.8,map:t});ve(Ge)}ae(Ge=>[...Ge,Ft])}},n=l=>{q&&$.length>=3&&Pe()},s=t.addListener("click",a),o=t.addListener("dblclick",n);ae([s,o])},[q,$]),Ve=t=>{google.maps.event.addListener(t.getPath(),"set_at",()=>{_(t)}),google.maps.event.addListener(t.getPath(),"insert_at",()=>{_(t)}),google.maps.event.addListener(t,"dragend",()=>{_(t)})},kt=()=>{if(!y||!H.trim())return;const t=y.getPath(),a=[];for(let l=0;l<t.getLength();l++)a.push(t.getAt(l));const n={id:Date.now().toString(),name:H.trim(),coordinates:a,createdAt:new Date,isVisible:!0},s=[...W,n];we(s);const o=s.map(l=>({...l,coordinates:l.coordinates.map(D=>({lat:D.lat(),lng:D.lng()}))}));localStorage.setItem(Ue,JSON.stringify(o)),se(!1),Oe(""),m({open:!0,message:`Search region "${n.name}" saved successfully!`,severity:"success"})},Ct=t=>{y&&y.setMap(null);const a=new google.maps.Polygon({paths:t.coordinates,strokeColor:"#2196F3",strokeOpacity:.8,strokeWeight:3,fillColor:"#2196F3",fillOpacity:.2,editable:!0,draggable:!0,map:P});je(a),be(!0),Y(s=>({...s,mode:"edit",currentPolygon:a})),Ve(a);const n=new google.maps.LatLngBounds;t.coordinates.forEach(s=>n.extend(s)),P?.fitBounds(n),_(a),Se(!1),m({open:!0,message:`Loaded search region "${t.name}"`,severity:"success"})},Lt=t=>{const a=W.filter(s=>s.id!==t);we(a);const n=a.map(s=>({...s,coordinates:s.coordinates.map(o=>({lat:o.lat(),lng:o.lng()}))}));localStorage.setItem(Ue,JSON.stringify(n)),m({open:!0,message:"Search region deleted",severity:"success"})},N=i.useCallback(async(t,a)=>{ee(!0);try{const n=[];if((r==="vacancies"||r==="both")&&(await nt()).forEach(o=>{if(o.locationData){if(h&&o.league!==h||j&&o.ageGroup!==j)return;const l=$e(t,{lat:o.locationData.latitude,lng:o.locationData.longitude});l<=a&&n.push({item:{...o,id:o.id.toString(),postedBy:o.postedBy.toString()},distance:l,type:"vacancy"})}}),(r==="availability"||r==="both")&&(await ot()).forEach(o=>{if(o.locationData){if(h&&!o.preferredLeagues.includes(h)||j&&o.ageGroup!==j)return;const l=$e(t,{lat:o.locationData.latitude,lng:o.locationData.longitude});l<=a&&n.push({item:o,distance:l,type:"availability"})}}),n.length===0){const o=Ye().filter(l=>{if(r==="vacancies"&&l.type!=="vacancy"||r==="availability"&&l.type!=="availability")return!1;if(h){if(l.type==="vacancy"){if(l.item.league!==h)return!1}else if(!l.item.preferredLeagues?.includes(h))return!1}if(j&&l.item.ageGroup!==j)return!1;if(l.item.locationData){const D=$e(t,{lat:l.item.locationData.latitude,lng:l.item.locationData.longitude});if(D>a)return!1;l.distance=D}return!0});o.sort((l,D)=>(l.distance||0)-(D.distance||0)),A(o),m({open:!0,message:`Showing ${o.length} test results. Add real data through the dashboard to see actual listings.`,severity:"success"})}else n.sort((s,o)=>(s.distance||0)-(o.distance||0)),A(n)}catch(n){console.error("âŒ Error searching area:",n)}finally{ee(!1)}},[r,h,j]),_=i.useCallback(async t=>{ee(!0);try{const a=[];if((r==="vacancies"||r==="both")&&(await nt()).forEach(s=>{if(s.locationData){if(h&&s.league!==h||j&&s.ageGroup!==j)return;const o=new google.maps.LatLng(s.locationData.latitude,s.locationData.longitude);google.maps.geometry.poly.containsLocation(o,t)&&a.push({item:{...s,id:s.id.toString(),postedBy:s.postedBy.toString()},distance:0,type:"vacancy"})}}),(r==="availability"||r==="both")&&(await ot()).forEach(s=>{if(s.locationData){if(h&&!s.preferredLeagues.includes(h)||j&&s.ageGroup!==j)return;const o=new google.maps.LatLng(s.locationData.latitude,s.locationData.longitude);google.maps.geometry.poly.containsLocation(o,t)&&a.push({item:s,distance:0,type:"availability"})}}),a.length===0){const s=Ye().filter(o=>{if(r==="vacancies"&&o.type!=="vacancy"||r==="availability"&&o.type!=="availability")return!1;if(h){if(o.type==="vacancy"){if(o.item.league!==h)return!1}else if(!o.item.preferredLeagues?.includes(h))return!1}if(j&&o.item.ageGroup!==j)return!1;if(o.item.locationData){const l=new google.maps.LatLng(o.item.locationData.latitude,o.item.locationData.longitude);if(!google.maps.geometry.poly.containsLocation(l,t))return!1}return!0});A(s),m({open:!0,message:`Showing ${s.length} test results in drawn area. Add real data through the dashboard to see actual listings.`,severity:"success"})}else A(a)}catch(a){console.error("âŒ Error searching drawn area:",a)}finally{ee(!1)}},[r,h,j]);i.useEffect(()=>{M||N(u,I)},[r,h,j]);const At=()=>{Y(t=>({...t,isActive:!0,mode:"draw"})),xe(!0),te([]),m({open:!0,message:"Click on the map to start drawing your search area. Double-click or press Enter to finish.",severity:"success"})},Je=()=>{y&&(y.setMap(null),je(null)),be(!1),Y({isActive:!1,mode:"view",currentPolygon:null}),xe(!1),te([]),ye.forEach(t=>{"setMap"in t&&typeof t.setMap=="function"?t.setMap(null):google.maps.event.removeListener(t)}),ae([]),O&&(O.setMap(null),ve(null)),N(u,I)},Mt=()=>{y&&(Y(t=>({...t,mode:"edit"})),y.setEditable(!0),m({open:!0,message:"Edit mode: Drag the corners to adjust your search area.",severity:"success"}))},It=()=>{y&&se(!0)},Dt=t=>{ut(t.currentTarget),Se(!0)},J=()=>{M&&y?_(y):N(u,I)},Et=async()=>{try{if(!navigator.geolocation){m({open:!0,message:"Geolocation is not supported by your browser. Please click on the map to set your search center.",severity:"error"});return}location.protocol!=="https:"&&location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&console.warn("Geolocation may require HTTPS in production"),m({open:!0,message:"Getting your location...",severity:"success"});const t=await ra();if(t&&"lat"in t&&"lng"in t)console.log("Location obtained successfully:",t),S(t),b(15),N(t,I),m({open:!0,message:"Location found! Map centered on your position.",severity:"success"});else if(t&&"error"in t)m({open:!0,message:t.userMessage,severity:"error"});else if("permissions"in navigator)try{const a=await navigator.permissions.query({name:"geolocation"});console.log("Geolocation permission status:",a.state);let n="Could not get your location. ";switch(a.state){case"denied":n+="Location access is blocked. Please enable it in your browser settings and try again.";break;case"prompt":n+="Please allow location access when prompted and try again.";break;default:n+="Please try again or click on the map to set your search center manually."}m({open:!0,message:n,severity:"error"})}catch(a){console.warn("Could not check permission status:",a),m({open:!0,message:"Location access needed. Please allow location permissions and try again, or click on the map to set your search center manually.",severity:"error"})}else m({open:!0,message:"Location access needed. Please allow location permissions and try again, or click on the map to set your search center manually.",severity:"error"})}catch(t){console.error("Unexpected error in handleMyLocation:",t),m({open:!0,message:"Unexpected error accessing location. Please try clicking on the map manually.",severity:"error"})}},Pt=t=>{E(t),M||N(u,t)},Ze=i.useCallback(t=>{if(t.latLng&&!R.isActive&&!M){const a={lat:t.latLng.lat(),lng:t.latLng.lng()};S(a),N(a,I)}},[I,N,R.isActive,M]);i.useEffect(()=>{if(P){const t=P.addListener("click",Ze);return()=>google.maps.event.removeListener(t)}},[P,Ze]);const zt=()=>C.map(t=>{const a=t.item;if(!a.locationData)return null;const n={lat:a.locationData.latitude,lng:a.locationData.longitude},s=t.type==="vacancy"?"https://maps.google.com/mapfiles/ms/icons/red-dot.png":"https://maps.google.com/mapfiles/ms/icons/blue-dot.png";return e.jsx(la,{position:n,icon:s,title:a.title,onClick:()=>{console.log("MapSearch: Marker onClick called for item:",a.id,a.title),F(t)}},`${t.type}-${a.id}`)}),Gt=()=>{if(console.log("renderSelectedItemDialog called, selectedResult:",x),!x)return null;const t=x.item;return console.log("Dialog will render for item:",t.id,t.title),e.jsxs(de,{open:!!x,onClose:()=>F(null),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ue,{children:e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(d,{variant:"h6",children:t.title}),e.jsx(he,{onClick:()=>F(null),size:"small",children:e.jsx(st,{})})]})}),e.jsxs(ge,{children:[e.jsxs(g,{mb:2,children:[e.jsx(G,{label:x.type==="vacancy"?"Team Vacancy":"Player Available",color:x.type==="vacancy"?"primary":"secondary",size:"small"}),x.distance&&e.jsx(G,{label:`${Be(x.distance)} away`,variant:"outlined",size:"small",sx:{ml:1}})]}),e.jsx(d,{variant:"body1",paragraph:!0,children:t.description}),e.jsxs(w,{container:!0,spacing:2,children:[e.jsxs(w,{item:!0,xs:6,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"League"}),e.jsx(d,{variant:"body2",children:"league"in t?t.league:t.preferredLeagues.join(", ")})]}),e.jsxs(w,{item:!0,xs:6,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"Age Group"}),e.jsx(d,{variant:"body2",children:t.ageGroup})]}),e.jsxs(w,{item:!0,xs:6,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"Position"}),e.jsx(d,{variant:"body2",children:"position"in t?t.position:t.positions?.join(", ")||"N/A"})]}),e.jsxs(w,{item:!0,xs:6,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"Location"}),e.jsx(d,{variant:"body2",children:t.location})]})]}),e.jsxs(g,{mt:2,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"Contact Information"}),e.jsx(d,{variant:"body2",children:t.contactInfo})]})]}),e.jsxs(me,{children:[e.jsx(p,{startIcon:e.jsx(ea,{}),onClick:()=>{const a=new URLSearchParams;x.type==="vacancy"?(a.set("tab","0"),a.set("league","league"in t?t.league:""),a.set("ageGroup",t.ageGroup),a.set("position","position"in t?t.position:"")):(a.set("tab","1"),a.set("ageGroup",t.ageGroup),"preferredLeagues"in t&&t.preferredLeagues.length>0&&a.set("league",t.preferredLeagues[0]),"positions"in t&&t.positions&&t.positions.length>0&&a.set("position",t.positions[0])),a.set("location",t.location),a.set("highlightId",t.id),f(`/search?${a.toString()}`),F(null)},variant:"contained",children:"View Details"}),t.locationData&&e.jsx(p,{startIcon:e.jsx(ta,{}),onClick:()=>{const a=`https://www.google.com/maps/dir/?api=1&destination=${t.locationData.latitude},${t.locationData.longitude}`;window.open(a,"_blank")},children:"Get Directions"}),e.jsx(p,{onClick:()=>F(null),children:"Close"})]})]})};return e.jsx(oa,{children:e.jsxs(g,{children:[e.jsx(Z,{elevation:2,sx:{p:2,mb:2},children:e.jsx(w,{container:!0,spacing:2,alignItems:"center",children:e.jsx(w,{item:!0,xs:12,children:e.jsxs(g,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",children:[e.jsx(p,{startIcon:e.jsx($t,{}),onClick:()=>ft(!Ee),variant:Ee?"contained":"outlined",size:"small",children:"Filters"}),e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsxs(le,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(p,{startIcon:e.jsx(Bt,{}),onClick:At,variant:R.isActive?"contained":"outlined",size:"small",disabled:R.isActive,children:R.isActive?"Drawing...":"Draw Area"}),y&&e.jsxs(e.Fragment,{children:[e.jsx(p,{startIcon:e.jsx(Ut,{}),onClick:Mt,variant:R.mode==="edit"?"contained":"outlined",size:"small",color:"primary",children:"Edit"}),e.jsx(p,{startIcon:e.jsx(Qe,{}),onClick:It,variant:"outlined",size:"small",color:"success",children:"Save"}),e.jsx(p,{startIcon:e.jsx(Nt,{}),onClick:Je,variant:"outlined",size:"small",color:"secondary",children:"Clear"})]}),W.length>0&&e.jsxs(p,{startIcon:e.jsx(Ot,{}),onClick:Dt,variant:"outlined",size:"small",children:["Saved (",W.length,")"]})]}),e.jsx(Wt,{control:e.jsx(Xe,{checked:M,disabled:!y,size:"small"}),label:"Use Drawn Area",disabled:!y}),e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsx(p,{startIcon:e.jsx(_t,{}),onClick:Et,variant:"outlined",size:v?"large":"small",disabled:M,sx:{minHeight:v?44:"auto",fontSize:v?"0.9rem":"0.875rem"},children:"My Location"}),c&&e.jsxs(e.Fragment,{children:[e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsx(p,{startIcon:e.jsx(Tt,{}),onClick:()=>V(!0),variant:"outlined",size:v?"large":"small",color:"secondary",sx:{minHeight:v?44:"auto",fontSize:v?"0.9rem":"0.875rem"},children:v?`Alerts (${K.filter(t=>t.isActive).length})`:`Email Alerts (${K.filter(t=>t.isActive).length})`})]}),C.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsx(p,{onClick:()=>We(!z),variant:z?"contained":"outlined",size:v?"large":"small",sx:{minHeight:v?44:"auto",fontSize:v?"0.9rem":"0.875rem"},children:z?"Exit Multi-Select":"Multi-Select"}),z&&e.jsxs(le,{direction:"row",spacing:1,children:[e.jsx(p,{onClick:vt,size:v?"large":"small",disabled:L.size===C.length,sx:{minHeight:v?44:"auto",fontSize:v?"0.9rem":"0.875rem"},children:"Select All"}),e.jsxs(p,{onClick:qe,size:v?"large":"small",disabled:L.size===0,sx:{minHeight:v?44:"auto",fontSize:v?"0.9rem":"0.875rem"},children:["Clear (",L.size,")"]}),e.jsxs(p,{onClick:()=>ne(!0),variant:"contained",size:v?"large":"small",disabled:L.size===0,startIcon:e.jsx(et,{}),sx:{minHeight:v?44:"auto",fontSize:v?"0.9rem":"0.875rem"},children:["Contact (",L.size,")"]})]})]})]})})})}),Ee&&e.jsxs(Z,{elevation:2,sx:{p:2,mb:2},children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Search Filters"}),e.jsxs(w,{container:!0,spacing:2,children:[e.jsx(w,{item:!0,xs:12,sm:4,children:e.jsx(Yt,{fullWidth:!0,size:"small",options:xt,value:h||null,onChange:(t,a)=>{Ie(a||""),setTimeout(J,100)},renderInput:t=>e.jsx(ce,{...t,label:"League",placeholder:"Type to search leagues..."}),filterOptions:(t,{inputValue:a})=>a?t.filter(n=>n.toLowerCase().includes(a.toLowerCase())):t,noOptionsText:"No leagues found"})}),e.jsx(w,{item:!0,xs:12,sm:4,children:e.jsxs(qt,{fullWidth:!0,size:"small",children:[e.jsx(Ht,{children:"Age Group"}),e.jsxs(Kt,{value:j,label:"Age Group",onChange:t=>{De(t.target.value),setTimeout(J,100)},children:[e.jsx(Q,{value:"",children:"All Age Groups"}),yt.map(t=>e.jsx(Q,{value:t,children:t},t))]})]})}),e.jsx(w,{item:!0,xs:12,sm:4,children:e.jsx(p,{onClick:()=>{Ie(""),De(""),setTimeout(J,100)},variant:"outlined",size:"small",fullWidth:!0,children:"Clear Filters"})})]})]}),!M&&e.jsx(Z,{elevation:2,sx:{p:2,mb:2},children:e.jsxs(w,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(w,{item:!0,xs:12,md:4,children:e.jsxs(g,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(d,{variant:"body2",children:"Search Radius:"}),e.jsx(g,{sx:{width:150},children:e.jsx(Vt,{value:I,onChange:(t,a)=>Pt(a),min:1,max:100,valueLabelDisplay:"auto",valueLabelFormat:t=>`${t}km`})})]})}),e.jsx(w,{item:!0,xs:12,md:8,children:e.jsx(d,{variant:"body2",color:"textSecondary",children:R.isActive?"Click on the map to start drawing a search area. Double-click to finish.":R.mode==="edit"?"Edit mode: Drag the corners to adjust your search area":"Click on the map to search different areas or draw a custom search area"})})]})}),e.jsx(Z,{elevation:2,children:e.jsxs(ia,{center:u,zoom:k,onMapLoad:St,style:{height:"500px",width:"100%"},children:[zt(),P&&!M&&e.jsx("div",{ref:t=>{t&&P&&new google.maps.Circle({strokeColor:"#2196F3",strokeOpacity:.8,strokeWeight:2,fillColor:"#2196F3",fillOpacity:.1,map:P,center:u,radius:I*1e3})}})]})}),v&&e.jsxs(Z,{elevation:3,sx:{position:"fixed",bottom:oe?0:-300,left:0,right:0,transition:"bottom 0.3s ease-in-out",zIndex:1e3,maxHeight:"60vh",overflow:"hidden"},children:[e.jsx(g,{sx:{p:1,textAlign:"center",borderBottom:1,borderColor:"divider",cursor:"pointer"},onClick:()=>Le(!oe),children:e.jsx(d,{variant:"body2",color:"text.secondary",children:oe?"ðŸ“± Swipe down to hide":`ðŸ“± Swipe up to show ${C.length} results`})}),oe&&e.jsx(g,{sx:{overflow:"auto",maxHeight:"calc(60vh - 48px)"},children:C.map((t,a)=>{const n=`${t.type}_${a}`,s=L.has(n);return e.jsx(Fe,{sx:{m:1,border:s?2:0,borderColor:"primary.main"},children:e.jsx(Re,{sx:{p:2},children:e.jsxs(g,{display:"flex",alignItems:"flex-start",gap:1,children:[z&&e.jsx(tt,{checked:s,onChange:()=>ze(n),size:"large"}),e.jsxs(g,{flex:1,onClick:()=>!z&&F(t),children:[e.jsx(d,{variant:"h6",component:"h3",sx:{fontSize:"1rem"},children:t.item.title}),e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsx(G,{label:t.type==="vacancy"?"Team":"Player",color:t.type==="vacancy"?"primary":"secondary",size:"small"}),t.distance&&t.distance>0&&e.jsx(d,{variant:"body2",color:"primary",children:Be(t.distance)})]}),e.jsx(d,{variant:"body2",color:"textSecondary",children:t.item.description.length>60?`${t.item.description.substring(0,60)}...`:t.item.description})]})]})})},n)})})]}),e.jsxs(g,{mt:2,children:[e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(d,{variant:"h6",children:["Search Results (",C.length,")"]}),e.jsxs(g,{display:"flex",gap:1,flexWrap:"wrap",children:[h&&e.jsx(G,{label:`League: ${h}`,size:"small",onDelete:()=>{Ie(""),setTimeout(J,100)}}),j&&e.jsx(G,{label:`Age: ${j}`,size:"small",onDelete:()=>{De(""),setTimeout(J,100)}}),M&&e.jsx(G,{label:"Custom Area",size:"small",color:"primary"}),z&&L.size>0&&e.jsx(G,{label:`${L.size} Selected`,size:"small",color:"success",variant:"filled"})]})]}),e.jsx(w,{container:!0,spacing:2,children:C.map((t,a)=>{const n=`${t.type}_${a}`,s=L.has(n);return e.jsx(w,{item:!0,xs:12,md:6,children:e.jsx(Fe,{sx:{cursor:"pointer","&:hover":{elevation:4},border:s?2:0,borderColor:"primary.main",position:"relative"},onClick:()=>z?ze(n):F(t),children:e.jsxs(Re,{children:[z&&e.jsx(g,{position:"absolute",top:8,right:8,children:e.jsx(tt,{checked:s,onChange:()=>ze(n),onClick:o=>o.stopPropagation()})}),e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",sx:{pr:z?5:0},children:[e.jsx(d,{variant:"h6",component:"h3",children:t.item.title}),e.jsx(G,{label:t.type==="vacancy"?"Team":"Player",color:t.type==="vacancy"?"primary":"secondary",size:"small"})]}),e.jsx(d,{variant:"body2",color:"textSecondary",paragraph:!0,children:t.item.description.length>100?`${t.item.description.substring(0,100)}...`:t.item.description}),e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(d,{variant:"body2",children:["position"in t.item?t.item.position:t.item.positions?.join(", ")||"N/A"," â€¢ ",t.item.ageGroup]}),t.distance&&t.distance>0?e.jsx(d,{variant:"body2",color:"primary",children:Be(t.distance)}):M?e.jsx(d,{variant:"body2",color:"secondary",children:"In Area"}):null]})]})})},`${t.type}-${t.item.id}-${a}`)})})]}),Gt(),e.jsxs(de,{open:lt,onClose:()=>se(!1),children:[e.jsx(ue,{children:"Save Search Region"}),e.jsx(ge,{children:e.jsx(ce,{autoFocus:!0,margin:"dense",label:"Region Name",fullWidth:!0,variant:"outlined",value:H,onChange:t=>Oe(t.target.value),placeholder:"e.g., North London, City Center, etc."})}),e.jsxs(me,{children:[e.jsx(p,{onClick:()=>se(!1),children:"Cancel"}),e.jsx(p,{onClick:kt,variant:"contained",disabled:!H.trim(),children:"Save"})]})]}),e.jsxs(Jt,{anchorEl:dt,open:ct,onClose:()=>Se(!1),PaperProps:{style:{maxHeight:400,width:"300px"}},children:[e.jsx(Q,{disabled:!0,children:e.jsx(d,{variant:"subtitle2",children:"Saved Search Regions"})}),e.jsx(T,{}),W.map(t=>e.jsxs(Q,{dense:!0,children:[e.jsx(Zt,{primary:t.name,secondary:`Saved ${t.createdAt.toLocaleDateString()}`,onClick:()=>Ct(t),style:{cursor:"pointer"}}),e.jsx(Qt,{children:e.jsx(he,{edge:"end",size:"small",onClick:a=>{a.stopPropagation(),Lt(t.id)},children:e.jsx(at,{fontSize:"small"})})})]},t.id)),W.length===0&&e.jsx(Q,{disabled:!0,children:e.jsx(d,{variant:"body2",color:"textSecondary",children:"No saved regions yet"})})]}),e.jsx(Xt,{open:ke.open,autoHideDuration:4e3,onClose:()=>m(t=>({...t,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(it,{onClose:()=>m(t=>({...t,open:!1})),severity:ke.severity,sx:{width:"100%"},children:ke.message})}),e.jsxs(de,{open:pt,onClose:()=>V(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(ue,{children:e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(d,{variant:"h6",children:"Email Alerts"}),e.jsx(he,{onClick:()=>V(!1),size:"small",children:e.jsx(st,{})})]})}),e.jsx(ge,{children:e.jsxs(le,{spacing:3,children:[e.jsxs(g,{children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Create New Alert"}),e.jsx(d,{variant:"body2",color:"textSecondary",paragraph:!0,children:"Get notified when new matches are found for your search criteria."}),e.jsxs(w,{container:!0,spacing:2,children:[e.jsxs(w,{item:!0,xs:12,sm:6,children:[e.jsx(p,{startIcon:e.jsx(et,{}),onClick:()=>Ke("new_match"),variant:"outlined",fullWidth:!0,disabled:!c,children:"Alert for Current Search"}),e.jsxs(d,{variant:"caption",display:"block",sx:{mt:1},children:[M?"Custom area":`${I}km radius`,h&&` â€¢ ${h}`,j&&` â€¢ ${j}`]})]}),y&&e.jsxs(w,{item:!0,xs:12,sm:6,children:[e.jsx(p,{startIcon:e.jsx(Qe,{}),onClick:()=>Ke("saved_search"),variant:"outlined",fullWidth:!0,disabled:!c,children:"Alert for Saved Region"}),e.jsx(d,{variant:"caption",display:"block",sx:{mt:1},children:"Custom drawn area with current filters"})]})]})]}),e.jsx(T,{}),e.jsxs(g,{children:[e.jsxs(d,{variant:"h6",gutterBottom:!0,children:["Your Active Alerts (",K.filter(t=>t.isActive).length,")"]}),K.length===0?e.jsx(d,{variant:"body2",color:"textSecondary",children:"No email alerts created yet."}):e.jsx(le,{spacing:2,children:K.map(t=>e.jsx(Fe,{variant:"outlined",children:e.jsx(Re,{children:e.jsxs(g,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",children:[e.jsxs(g,{flex:1,children:[e.jsxs(g,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(G,{label:t.alertType==="new_match"?"Search Alert":"Region Alert",size:"small",color:t.alertType==="new_match"?"primary":"secondary"}),e.jsx(G,{label:t.isActive?"Active":"Inactive",size:"small",color:t.isActive?"success":"default"})]}),e.jsx(d,{variant:"body2",color:"textSecondary",children:t.searchRegion?e.jsxs(e.Fragment,{children:["Custom region: ",t.searchRegion.name]}):e.jsxs(e.Fragment,{children:[t.filters?.radius?`${t.filters.radius}km radius`:"Location-based search",t.filters?.league&&` â€¢ ${t.filters.league}`,t.filters?.ageGroup&&` â€¢ ${t.filters.ageGroup}`]})}),e.jsxs(d,{variant:"caption",color:"textSecondary",children:["Created: ",new Date(t.createdAt).toLocaleDateString()]})]}),e.jsxs(g,{display:"flex",gap:1,children:[e.jsx(Xe,{checked:t.isActive,onChange:a=>wt(t.id,a.target.checked),size:"small"}),e.jsx(he,{onClick:()=>bt(t.id),size:"small",color:"error",children:e.jsx(at,{fontSize:"small"})})]})]})})},t.id))})]})]})}),e.jsx(me,{children:e.jsx(p,{onClick:()=>V(!1),children:"Close"})})]}),e.jsxs(de,{open:gt,onClose:()=>ne(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ue,{children:["Contact Multiple ",L.size>0&&Array.from(L).some(t=>t.startsWith("vacancy"))?"Teams":"Players"]}),e.jsxs(ge,{children:[e.jsxs(d,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Send a message to ",L.size," selected ",L.size===1?"contact":"contacts"]}),e.jsx(ce,{fullWidth:!0,label:"Subject",value:B.subject,onChange:t=>_e(a=>({...a,subject:t.target.value})),sx:{mb:2}}),e.jsx(ce,{fullWidth:!0,label:"Message",multiline:!0,rows:6,value:B.message,onChange:t=>_e(a=>({...a,message:t.target.value})),placeholder:"Introduce yourself and explain your interest...",sx:{mb:2}}),e.jsxs(g,{sx:{p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Selected contacts:"}),He().slice(0,3).map((t,a)=>e.jsxs(d,{variant:"body2",children:["â€¢ ",t.item.title," (",t.type==="vacancy"?"Team":"Player",")"]},a)),L.size>3&&e.jsxs(d,{variant:"body2",color:"text.secondary",children:["... and ",L.size-3," more"]})]})]}),e.jsxs(me,{children:[e.jsx(p,{onClick:()=>ne(!1),children:"Cancel"}),e.jsxs(p,{onClick:jt,variant:"contained",disabled:!B.subject.trim()||!B.message.trim(),children:["Send Messages (",L.size,")"]})]})]})]})})};export{oa as G,ha as M,ma as g};
