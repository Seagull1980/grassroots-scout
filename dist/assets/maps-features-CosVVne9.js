const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/admin-features-R-myf6Sn.js","assets/mui-vendor-JAsu9f5S.js","assets/react-vendor-BTglNIF_.js"])))=>i.map(i=>d[i]);
import{j as e,n as lt,B as h,y as Ut,z as X,G as I,s as y,D as Nt,H as T,J as ee,K as Bt,N as Tt,O as Xe,Q as _t,U as Ot,X as Wt,Y as et,Z as Yt,_ as Vt,E as tt,T as d,$ as qt,a0 as de,a1 as Ht,a2 as Kt,a3 as Jt,i as te,a4 as Zt,C as Fe,a as $e,a5 as at,d as R,a6 as ue,a7 as ge,a8 as me,a9 as he,M as Qt,l as Xt,aa as ea,I as pe,ab as st,m as ta,ac as nt,ad as aa,V as sa,ae as na}from"./mui-vendor-JAsu9f5S.js";import{r,a as ae,u as oa}from"./react-vendor-BTglNIF_.js";import{i as Be}from"./maps-vendor-5en1VuuU.js";import{u as ia,e as fe,g as ot,b as ra}from"./admin-features-R-myf6Sn.js";const N={apiKey:"AIzaSyCPOJ5YQDzy8pLMZGsqCxhQb_6VGd9Nxwk",libraries:["places","geometry","marker"],version:"weekly",defaultCenter:{lat:51.5074,lng:-.1278},defaultZoom:10,searchRadius:500,mapId:"GRASSROOTS_HUB_MAP",mapOptions:{disableDefaultUI:!1,zoomControl:!0,streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!0}};""+btoa(`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#2196F3" width="24" height="24">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
      </svg>
    `),""+btoa(`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#4CAF50" width="24" height="24">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
      </svg>
    `),""+btoa(`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#FF5722" width="24" height="24">
        <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
      </svg>
    `),""+btoa(`
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#FF9800" width="24" height="24">
        <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
      </svg>
    `);const la=i=>{switch(i){case Be.Status.LOADING:return e.jsx(h,{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",children:e.jsx(Ut,{})});case Be.Status.FAILURE:return e.jsx(lt,{severity:"error",sx:{m:2},children:e.jsxs(h,{children:[e.jsx("strong",{children:"Google Maps Loading Failed"}),e.jsx("br",{}),e.jsx("br",{}),"This is likely due to a billing or API configuration issue. To resolve:",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"1. Enable Billing:"}),e.jsx("br",{}),"â€¢ Go to Google Cloud Console: ",e.jsx("a",{href:"https://console.cloud.google.com/",target:"_blank",rel:"noopener noreferrer",children:"console.cloud.google.com"}),e.jsx("br",{}),"â€¢ Navigate to Billing and enable billing for your project",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"2. Enable Required APIs:"}),e.jsx("br",{}),"â€¢ Maps JavaScript API",e.jsx("br",{}),"â€¢ Places API",e.jsx("br",{}),"â€¢ Geocoding API",e.jsx("br",{}),"â€¢ Geometry API",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"3. Check API Key Restrictions:"}),e.jsx("br",{}),"â€¢ Ensure your API key is not restricted to specific domains",e.jsx("br",{}),"â€¢ Or add localhost and your domain to allowed referrers"]})});default:return e.jsx("div",{children:"Loading map..."})}},ca=({children:i})=>{const c=N.apiKey;return e.jsx(Be.Wrapper,{apiKey:c,render:la,libraries:N.libraries,version:N.version,children:i})},da=({center:i,zoom:c,children:p,onMapLoad:g,style:S={height:"400px",width:"100%"}})=>{const k=r.useRef(null),[m,x]=r.useState(),C=r.useCallback(()=>{if(k.current&&!m){const v=new google.maps.Map(k.current,{center:i,zoom:c,mapId:N.mapId,...N.mapOptions});x(v),g?.(v)}},[i,c,m,g]);return ae.useEffect(()=>{C()},[C]),ae.useEffect(()=>{m&&(m.setCenter(i),m.setZoom(c))},[m,i,c]),e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:k,style:S}),ae.Children.map(p,v=>ae.isValidElement(v)?ae.cloneElement(v,{map:m}):v)]})},it=(i,c)=>{const g=ye(c.lat-i.lat),S=ye(c.lng-i.lng),k=Math.sin(g/2)*Math.sin(g/2)+Math.cos(ye(i.lat))*Math.cos(ye(c.lat))*Math.sin(S/2)*Math.sin(S/2);return 6371*(2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k)))},ye=i=>i*Math.PI/180,ja=async i=>new Promise(c=>{if(!window.google){c(null);return}new google.maps.Geocoder().geocode({address:i},(g,S)=>{if(S==="OK"&&g&&g[0]){const k=g[0],m={address:k.formatted_address,latitude:k.geometry.location.lat(),longitude:k.geometry.location.lng(),placeId:k.place_id};c(m)}else c(null)})}),ua=()=>new Promise(i=>{if(!navigator.geolocation){console.warn("Geolocation is not supported by this browser"),i({error:"Geolocation not supported",userMessage:"Geolocation is not supported by your browser. Please click on the map to set your location."});return}navigator.geolocation.getCurrentPosition(c=>{console.log("Location obtained successfully:",c.coords),i({lat:c.coords.latitude,lng:c.coords.longitude})},c=>{let p="Unknown error",g="warn",S="Could not get your location. Please try again.";switch(c.code){case 1:p="Location access denied by user",S="Location access denied. Please allow location permissions and try again.",g="info";break;case 2:p="Location information unavailable (GPS/network issue)",S="Location unavailable. Please check your GPS/network connection and try again.";break;case 3:p="Location request timed out after 15 seconds",S="Location request timed out. Please try again or click on the map manually.";break;default:p=`Unknown geolocation error (code: ${c.code})`,S="Location error occurred. Please try clicking on the map manually."}g==="info"?console.info("Geolocation:",p,{code:c.code,message:c.message}):console.warn("Geolocation failed:",p,{code:c.code,message:c.message,error:c}),i({error:p,userMessage:S})},{timeout:15e3,enableHighAccuracy:!0,maximumAge:6e4})}),Ue=i=>i<1?`${Math.round(i*1e3)}m`:`${i.toFixed(1)}km`,ga="modulepreload",ma=function(i){return"/"+i},rt={},ha=function(c,p,g){let S=Promise.resolve();if(p&&p.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),x=m?.nonce||m?.getAttribute("nonce");S=Promise.allSettled(p.map(C=>{if(C=ma(C),C in rt)return;rt[C]=!0;const v=C.endsWith(".css"),A=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${C}"]${A}`))return;const u=document.createElement("link");if(u.rel=v?"stylesheet":ga,v||(u.as="script"),u.crossOrigin="",u.href=C,x&&u.setAttribute("nonce",x),document.head.appendChild(u),v)return new Promise((P,_)=>{u.addEventListener("load",P),u.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${C}`)))})}))}function k(m){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=m,window.dispatchEvent(x),!x.defaultPrevented)throw m}return S.then(m=>{for(const x of m||[])x.status==="rejected"&&k(x.reason);return c().catch(k)})},pa=({position:i,map:c,title:p,icon:g,onClick:S,children:k})=>{const[m,x]=r.useState(),[C,v]=r.useState();return r.useEffect(()=>{if(!c)return;let A;if(window.google?.maps?.marker?.AdvancedMarkerElement)try{let u;typeof g=="string"&&g.includes("red-dot")?u=new google.maps.marker.PinElement({background:"#EA4335",borderColor:"#C5221F",glyphColor:"#FFFFFF"}):typeof g=="string"&&g.includes("blue-dot")&&(u=new google.maps.marker.PinElement({background:"#4285F4",borderColor:"#1A73E8",glyphColor:"#FFFFFF"})),A=new google.maps.marker.AdvancedMarkerElement({position:i,map:c,title:p,content:u?.element}),console.log("AdvancedMarkerElement created:",{position:i,title:p})}catch(u){console.warn("Failed to create AdvancedMarkerElement, falling back to legacy marker:",u),A=new google.maps.Marker({position:i,map:c,title:p,icon:g}),console.log("Legacy Marker created:",{position:i,title:p})}else A=new google.maps.Marker({position:i,map:c,title:p,icon:g}),console.log("Legacy Marker created (API not available):",{position:i,title:p});if(x(A),k){const u=new google.maps.InfoWindow;v(u)}return()=>{A&&(A instanceof google.maps.Marker?A.setMap(null):window.google?.maps?.marker?.AdvancedMarkerElement&&A instanceof google.maps.marker.AdvancedMarkerElement&&(A.map=null))}},[c,i,p,g,k]),r.useEffect(()=>{if(!m)return;const A=()=>{if(console.log("Marker clicked!",{title:p,position:i}),S?.(),C&&k){const P=document.createElement("div");C.setContent(P),m instanceof google.maps.Marker?C.open(c,m):(C.setPosition(i),C.open(c))}};let u;return(m instanceof google.maps.Marker||window.google?.maps?.marker?.AdvancedMarkerElement&&m instanceof google.maps.marker.AdvancedMarkerElement)&&(u=m.addListener("click",A)),()=>{u&&google.maps.event.removeListener(u)}},[m,S,C,k,c,i]),null},Ne="grassroots-hub-saved-regions",ba=({searchType:i})=>{const{user:c}=ia(),p=oa(),[g,S]=r.useState(N.defaultCenter),[k,m]=r.useState(N.defaultZoom),[x,C]=r.useState(N.searchRadius),[v,A]=r.useState([]),[u,P]=r.useState(null),[,_]=r.useState(!1),[z,ct]=r.useState(),[F,V]=r.useState({isActive:!1,mode:"view",currentPolygon:null}),[q,xe]=r.useState(!1),[$,se]=r.useState([]),[ve,ne]=r.useState([]),[O,je]=r.useState(null),[j,be]=r.useState(null),[D,we]=r.useState(!1),[W,Se]=r.useState([]),[dt,oe]=r.useState(!1),[H,Te]=r.useState(""),[ut,ke]=r.useState(!1),[gt,mt]=r.useState(null),[Ce,f]=r.useState({open:!1,message:"",severity:"success"}),[M,Le]=r.useState(new Set),[G,_e]=r.useState(!1),[ht,ie]=r.useState(!1),[U,Oe]=r.useState({subject:"",message:""}),[b,pt]=r.useState(!1),[re,Ae]=r.useState(!1),[Ie,We]=r.useState(null),[Me,le]=r.useState(!1),[K,ft]=r.useState([]),[yt,J]=r.useState(!1),[w,De]=r.useState(""),[L,Ee]=r.useState(""),[Pe,xt]=r.useState(!1),[Z,Ye]=r.useState("training"),vt=["County League","Regional League","Youth League","Premier Youth League","Championship Youth","Local League"],jt=["Under 6","Under 7","Under 8","Under 9","Under 10","Under 11","Under 12","Under 13","Under 14","Under 15","Under 16","Under 17","Under 18","Under 19","Under 20","Under 21","Senior","Veterans"],Ve=()=>{const t=[{item:{id:"test-1",title:"Striker Needed - Arsenal Youth FC",description:"We are looking for a talented striker to join our Under 16 team. Great coaching and facilities available.",league:"Premier Youth League",ageGroup:"Under 16",position:"Striker",location:"North London",contactInfo:"coach@arsenalyouth.com",status:"active",createdAt:"2024-10-01",firstName:"John",lastName:"Smith",postedBy:"1",locationData:{address:"North London, UK",latitude:51.5558,longitude:-.1088}},distance:2.1,type:"vacancy"},{item:{id:"test-2",title:"Midfielder Position Available",description:"Chelsea Youth looking for a creative midfielder. Join our successful Under 18 squad.",league:"Championship Youth",ageGroup:"Under 18",position:"Midfielder",location:"West London",contactInfo:"recruitment@chelseayouth.com",status:"active",createdAt:"2024-10-02",firstName:"Sarah",lastName:"Johnson",postedBy:"2",locationData:{address:"West London, UK",latitude:51.4816,longitude:-.1909}},distance:3.8,type:"vacancy"},{item:{id:"test-3",title:"Goalkeeper Opportunity",description:"Tottenham Youth FC seeking a reliable goalkeeper for our Under 17 team. Excellent development program.",league:"Premier Youth League",ageGroup:"Under 17",position:"Goalkeeper",location:"North London",contactInfo:"youth@tottenham.com",status:"active",createdAt:"2024-10-03",firstName:"Mike",lastName:"Williams",postedBy:"3",locationData:{address:"North London, UK",latitude:51.6042,longitude:-.0664}},distance:1.9,type:"vacancy"}],a=[{item:{id:"player-1",title:"Experienced Midfielder Available",description:"Creative midfielder with excellent passing ability. Looking for a competitive team to develop further.",preferredLeagues:["Premier Youth League","Championship Youth"],ageGroup:"Under 17",positions:["Central Midfielder","Attacking Midfielder"],location:"East London",contactInfo:"alex.thompson@email.com",postedBy:"101",createdAt:"2024-10-01",status:"active",locationData:{address:"East London, UK",latitude:51.5154,longitude:.0033}},distance:4.2,type:"availability"},{item:{id:"player-2",title:"Defensive Player Seeking Team",description:"Strong defender with great leadership qualities. Captain of school team.",preferredLeagues:["County League","Youth League"],ageGroup:"Under 16",positions:["Centre-Back","Left-Back"],location:"South London",contactInfo:"emma.davis@email.com",postedBy:"102",createdAt:"2024-10-02",status:"active",locationData:{address:"South London, UK",latitude:51.4632,longitude:-.1115}},distance:2.7,type:"availability"}];return[...t,...a]};r.useEffect(()=>{const t=localStorage.getItem(Ne);if(t)try{const a=JSON.parse(t).map(n=>({...n,createdAt:new Date(n.createdAt),coordinates:n.coordinates.map(s=>new google.maps.LatLng(s.lat,s.lng))}));Se(a)}catch(a){console.error("Error loading saved regions:",a)}},[]),r.useEffect(()=>{c&&ce()},[c]),r.useEffect(()=>{const t=()=>{const a=navigator.userAgent||"",n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a),s=window.innerWidth<768;pt(n||s)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),r.useEffect(()=>{if(!b)return;const t=s=>{We(s.touches[0].clientY),le(!1)},a=s=>{if(Ie===null)return;const l=s.touches[0].clientY,o=Ie-l;o>50&&!Me?(le(!0),Ae(!0)):o<-50&&!Me&&(le(!0),Ae(!1))},n=()=>{We(null),le(!1)};return document.addEventListener("touchstart",t),document.addEventListener("touchmove",a),document.addEventListener("touchend",n),()=>{document.removeEventListener("touchstart",t),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",n)}},[Ie,Me,b]);const ze=r.useCallback(()=>{if(!z||$.length<3)return;j&&j.setMap(null),ve.forEach(a=>{"setMap"in a&&typeof a.setMap=="function"?a.setMap(null):google.maps.event.removeListener(a)}),ne([]),O&&(O.setMap(null),je(null));const t=new google.maps.Polygon({paths:$,strokeColor:"#2196F3",strokeOpacity:.8,strokeWeight:3,fillColor:"#2196F3",fillOpacity:.2,editable:!0,draggable:!0,map:z});be(t),V(a=>({...a,isActive:!1,mode:"edit",currentPolygon:t})),we(!0),xe(!1),se([]),Je(t),Y(t),f({open:!0,message:"Search area drawn! You can now save this region or edit it by dragging the corners.",severity:"success"})},[z,$,j,ve]);r.useEffect(()=>{const t=a=>{q&&(a.key==="Enter"&&$.length>=3?(a.preventDefault(),ze()):a.key==="Escape"&&(a.preventDefault(),Ze()))};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[q,$,ze]);const ce=async()=>{try{const t=await fe.getAll();ft(t.alerts)}catch(t){console.error("Error loading email alerts:",t)}},Ge=t=>{const a=new Set(M);a.has(t)?a.delete(t):a.add(t),Le(a)},bt=()=>{const t=new Set(v.map((a,n)=>`${a.type}_${n}`));Le(t)},qe=()=>{Le(new Set),_e(!1)},He=()=>v.filter((t,a)=>M.has(`${t.type}_${a}`)),wt=async()=>{const t=He(),a=t.map(async n=>{const s=n.item;return n.type==="vacancy"?fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({recipientId:s.postedBy,subject:U.subject,message:U.message,relatedVacancyId:s.id,messageType:"vacancy_interest"})}):fetch("/api/messages",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({recipientId:s.postedBy,subject:U.subject,message:U.message,relatedPlayerAvailabilityId:s.id,messageType:"player_inquiry"})})});try{await Promise.all(a),f({open:!0,message:`Successfully contacted ${t.length} ${t.length===1?"person":"people"}!`,severity:"success"}),ie(!1),qe()}catch(n){console.error("Bulk contact error:",n),f({open:!0,message:"Some messages failed to send. Please try again.",severity:"error"})}},Ke=async t=>{if(!c){f({open:!0,message:"Please log in to create email alerts",severity:"error"});return}try{const a={alertType:t};if(t==="new_match"){if(a.filters={league:w||void 0,ageGroup:L||void 0,radius:D?void 0:x,center:D?void 0:g},D&&j){const n=j.getPath(),s=[];for(let l=0;l<n.getLength();l++){const o=n.getAt(l);s.push({lat:o.lat(),lng:o.lng()})}a.searchRegion={name:`Search Area ${new Date().toLocaleDateString()}`,coordinates:s}}}else if(t==="saved_search"&&j){const n=j.getPath(),s=[];for(let l=0;l<n.getLength();l++){const o=n.getAt(l);s.push({lat:o.lat(),lng:o.lng()})}a.searchRegion={name:H||`Search Area ${new Date().toLocaleDateString()}`,coordinates:s},a.filters={league:w||void 0,ageGroup:L||void 0}}await fe.create(a),f({open:!0,message:"Email alert created successfully! You'll be notified of new matches.",severity:"success"}),ce(),J(!1)}catch(a){console.error("Error creating email alert:",a),f({open:!0,message:"Failed to create email alert. Please try again.",severity:"error"})}},St=async t=>{try{await fe.delete(t),f({open:!0,message:"Email alert deleted",severity:"success"}),ce()}catch(a){console.error("Error deleting email alert:",a),f({open:!0,message:"Failed to delete email alert",severity:"error"})}},kt=async(t,a)=>{try{await fe.update(t,{isActive:a}),f({open:!0,message:`Email alert ${a?"enabled":"disabled"}`,severity:"success"}),ce()}catch(n){console.error("Error updating email alert:",n),f({open:!0,message:"Failed to update email alert",severity:"error"})}},Ct=r.useCallback(t=>{ct(t);const a=o=>{if(q&&o.latLng){const E=[...$,o.latLng];se(E);const $t=new google.maps.Marker({position:o.latLng,map:t,icon:{path:google.maps.SymbolPath.CIRCLE,scale:4,fillColor:"#2196F3",fillOpacity:1,strokeColor:"#1976D2",strokeWeight:2}});if(O&&O.setMap(null),E.length>1){const Re=new google.maps.Polyline({path:E,strokeColor:"#2196F3",strokeWeight:2,strokeOpacity:.8,map:t});je(Re)}ne(Re=>[...Re,$t])}},n=o=>{q&&$.length>=3&&ze()},s=t.addListener("click",a),l=t.addListener("dblclick",n);ne([s,l])},[q,$]),Je=t=>{google.maps.event.addListener(t.getPath(),"set_at",()=>{Y(t)}),google.maps.event.addListener(t.getPath(),"insert_at",()=>{Y(t)}),google.maps.event.addListener(t,"dragend",()=>{Y(t)})},Lt=()=>{if(!j||!H.trim())return;const t=j.getPath(),a=[];for(let o=0;o<t.getLength();o++)a.push(t.getAt(o));const n={id:Date.now().toString(),name:H.trim(),coordinates:a,createdAt:new Date,isVisible:!0},s=[...W,n];Se(s);const l=s.map(o=>({...o,coordinates:o.coordinates.map(E=>({lat:E.lat(),lng:E.lng()}))}));localStorage.setItem(Ne,JSON.stringify(l)),oe(!1),Te(""),f({open:!0,message:`Search region "${n.name}" saved successfully!`,severity:"success"})},At=t=>{j&&j.setMap(null);const a=new google.maps.Polygon({paths:t.coordinates,strokeColor:"#2196F3",strokeOpacity:.8,strokeWeight:3,fillColor:"#2196F3",fillOpacity:.2,editable:!0,draggable:!0,map:z});be(a),we(!0),V(s=>({...s,mode:"edit",currentPolygon:a})),Je(a);const n=new google.maps.LatLngBounds;t.coordinates.forEach(s=>n.extend(s)),z?.fitBounds(n),Y(a),ke(!1),f({open:!0,message:`Loaded search region "${t.name}"`,severity:"success"})},It=t=>{const a=W.filter(s=>s.id!==t);Se(a);const n=a.map(s=>({...s,coordinates:s.coordinates.map(l=>({lat:l.lat(),lng:l.lng()}))}));localStorage.setItem(Ne,JSON.stringify(n)),f({open:!0,message:"Search region deleted",severity:"success"})},B=r.useCallback(async(t,a)=>{_(!0);try{const n=[];if(i==="vacancies"||i==="both")try{const{getTeamVacanciesWithLocationType:s}=await ha(async()=>{const{getTeamVacanciesWithLocationType:o}=await import("./admin-features-R-myf6Sn.js").then(E=>E.q);return{getTeamVacanciesWithLocationType:o}},__vite__mapDeps([0,1,2])),l=await s({latitude:t.lat,longitude:t.lng,radius:a,locationType:Z,hasVacancies:!0});l.trainingLocations&&l.trainingLocations.length>0&&l.trainingLocations.forEach(o=>{n.push({item:{id:o.id.toString(),title:o.teamName||o.title,description:o.description||"",league:o.league||"",ageGroup:o.ageGroup||"",position:o.position||"",location:o.location||"",contactInfo:o.contactEmail||"",status:"active",createdAt:o.date||new Date().toISOString(),firstName:"Coach",lastName:"Team",postedBy:"1",locationData:{latitude:o.latitude,longitude:o.longitude,address:o.locationData?.address||o.location,postcode:o.locationData?.postcode||""}},distance:o.distance,type:"vacancy"})})}catch(s){console.error("Error fetching team vacancies:",s)}if((i==="availability"||i==="both")&&(await ot()).forEach(l=>{if(l.locationData){if(w&&!l.preferredLeagues.includes(w)||L&&l.ageGroup!==L)return;const o=it(t,{lat:l.locationData.latitude,lng:l.locationData.longitude});o<=a&&n.push({item:l,distance:o,type:"availability"})}}),n.length===0){const l=Ve().filter(o=>{if(i==="vacancies"&&o.type!=="vacancy"||i==="availability"&&o.type!=="availability")return!1;if(w){if(o.type==="vacancy"){if(o.item.league!==w)return!1}else if(!o.item.preferredLeagues?.includes(w))return!1}if(L&&o.item.ageGroup!==L)return!1;if(o.item.locationData){const E=it(t,{lat:o.item.locationData.latitude,lng:o.item.locationData.longitude});if(E>a)return!1;o.distance=E}return!0});l.sort((o,E)=>(o.distance||0)-(E.distance||0)),A(l),f({open:!0,message:`Showing ${l.length} test results. Add real data through the dashboard to see actual listings.`,severity:"success"})}else n.sort((s,l)=>(s.distance||0)-(l.distance||0)),A(n)}catch(n){console.error("âŒ Error searching area:",n)}finally{_(!1)}},[i,w,L]),Y=r.useCallback(async t=>{_(!0);try{const a=[];if((i==="vacancies"||i==="both")&&(await ra()).forEach(s=>{if(s.locationData){if(w&&s.league!==w||L&&s.ageGroup!==L)return;const l=new google.maps.LatLng(s.locationData.latitude,s.locationData.longitude);google.maps.geometry.poly.containsLocation(l,t)&&a.push({item:{...s,id:s.id.toString(),postedBy:s.postedBy.toString()},distance:0,type:"vacancy"})}}),(i==="availability"||i==="both")&&(await ot()).forEach(s=>{if(s.locationData){if(w&&!s.preferredLeagues.includes(w)||L&&s.ageGroup!==L)return;const l=new google.maps.LatLng(s.locationData.latitude,s.locationData.longitude);google.maps.geometry.poly.containsLocation(l,t)&&a.push({item:s,distance:0,type:"availability"})}}),a.length===0){const s=Ve().filter(l=>{if(i==="vacancies"&&l.type!=="vacancy"||i==="availability"&&l.type!=="availability")return!1;if(w){if(l.type==="vacancy"){if(l.item.league!==w)return!1}else if(!l.item.preferredLeagues?.includes(w))return!1}if(L&&l.item.ageGroup!==L)return!1;if(l.item.locationData){const o=new google.maps.LatLng(l.item.locationData.latitude,l.item.locationData.longitude);if(!google.maps.geometry.poly.containsLocation(o,t))return!1}return!0});A(s),f({open:!0,message:`Showing ${s.length} test results in drawn area. Add real data through the dashboard to see actual listings.`,severity:"success"})}else A(a)}catch(a){console.error("âŒ Error searching drawn area:",a)}finally{_(!1)}},[i,w,L,Z]);r.useEffect(()=>{D||B(g,x)},[i,w,L,Z]);const Mt=()=>{V(t=>({...t,isActive:!0,mode:"draw"})),xe(!0),se([]),f({open:!0,message:"Click on the map to start drawing your search area. Double-click or press Enter to finish.",severity:"success"})},Ze=()=>{j&&(j.setMap(null),be(null)),we(!1),V({isActive:!1,mode:"view",currentPolygon:null}),xe(!1),se([]),ve.forEach(t=>{"setMap"in t&&typeof t.setMap=="function"?t.setMap(null):google.maps.event.removeListener(t)}),ne([]),O&&(O.setMap(null),je(null)),B(g,x)},Dt=()=>{j&&(V(t=>({...t,mode:"edit"})),j.setEditable(!0),f({open:!0,message:"Edit mode: Drag the corners to adjust your search area.",severity:"success"}))},Et=()=>{j&&oe(!0)},Pt=t=>{mt(t.currentTarget),ke(!0)},Q=()=>{D&&j?Y(j):B(g,x)},zt=async()=>{try{if(!navigator.geolocation){f({open:!0,message:"Geolocation is not supported by your browser. Please click on the map to set your search center.",severity:"error"});return}location.protocol!=="https:"&&location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&console.warn("Geolocation may require HTTPS in production"),f({open:!0,message:"Getting your location...",severity:"success"});const t=await ua();if(t&&"lat"in t&&"lng"in t)console.log("Location obtained successfully:",t),S(t),m(15),B(t,x),f({open:!0,message:"Location found! Map centered on your position.",severity:"success"});else if(t&&"error"in t)f({open:!0,message:t.userMessage,severity:"error"});else if("permissions"in navigator)try{const a=await navigator.permissions.query({name:"geolocation"});console.log("Geolocation permission status:",a.state);let n="Could not get your location. ";switch(a.state){case"denied":n+="Location access is blocked. Please enable it in your browser settings and try again.";break;case"prompt":n+="Please allow location access when prompted and try again.";break;default:n+="Please try again or click on the map to set your search center manually."}f({open:!0,message:n,severity:"error"})}catch(a){console.warn("Could not check permission status:",a),f({open:!0,message:"Location access needed. Please allow location permissions and try again, or click on the map to set your search center manually.",severity:"error"})}else f({open:!0,message:"Location access needed. Please allow location permissions and try again, or click on the map to set your search center manually.",severity:"error"})}catch(t){console.error("Unexpected error in handleMyLocation:",t),f({open:!0,message:"Unexpected error accessing location. Please try clicking on the map manually.",severity:"error"})}},Gt=t=>{C(t),D||B(g,t)},Qe=r.useCallback(t=>{if(t.latLng&&!F.isActive&&!D){const a={lat:t.latLng.lat(),lng:t.latLng.lng()};S(a),B(a,x)}},[x,B,F.isActive,D]);r.useEffect(()=>{if(z){const t=z.addListener("click",Qe);return()=>google.maps.event.removeListener(t)}},[z,Qe]);const Rt=()=>v.map(t=>{const a=t.item;if(!a.locationData)return null;const n={lat:a.locationData.latitude,lng:a.locationData.longitude},s=t.type==="vacancy"?"https://maps.google.com/mapfiles/ms/icons/red-dot.png":"https://maps.google.com/mapfiles/ms/icons/blue-dot.png";return e.jsx(pa,{position:n,icon:s,title:a.title,onClick:()=>{console.log("MapSearch: Marker onClick called for item:",a.id,a.title),P(t)}},`${t.type}-${a.id}`)}),Ft=()=>{if(console.log("renderSelectedItemDialog called, selectedResult:",u),!u)return null;const t=u.item;return console.log("Dialog will render for item:",t.id,t.title),e.jsxs(ue,{open:!!u,onClose:()=>P(null),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ge,{children:e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(d,{variant:"h6",children:t.title}),e.jsx(pe,{onClick:()=>P(null),size:"small",children:e.jsx(nt,{})})]})}),e.jsxs(me,{children:[e.jsxs(h,{mb:2,children:[e.jsx(R,{label:u.type==="vacancy"?"Team Vacancy":"Player Available",color:u.type==="vacancy"?"primary":"secondary",size:"small"}),u.distance&&e.jsx(R,{label:`${Ue(u.distance)} away`,variant:"outlined",size:"small",sx:{ml:1}})]}),e.jsx(d,{variant:"body1",paragraph:!0,children:t.description}),e.jsxs(I,{container:!0,spacing:2,children:[e.jsxs(I,{item:!0,xs:6,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"League"}),e.jsx(d,{variant:"body2",children:"league"in t?t.league:t.preferredLeagues.join(", ")})]}),e.jsxs(I,{item:!0,xs:6,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"Age Group"}),e.jsx(d,{variant:"body2",children:t.ageGroup})]}),e.jsxs(I,{item:!0,xs:6,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"Position"}),e.jsx(d,{variant:"body2",children:"position"in t?t.position:t.positions?.join(", ")||"N/A"})]}),e.jsxs(I,{item:!0,xs:6,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"Location"}),e.jsx(d,{variant:"body2",children:t.location})]})]}),e.jsxs(h,{mt:2,children:[e.jsx(d,{variant:"subtitle2",color:"textSecondary",children:"Connect"}),e.jsxs(d,{variant:"body2",color:"text.secondary",children:["Use the messaging feature to connect with this ",u.type==="vacancy"?"team":"player"]}),e.jsx(y,{variant:"contained",color:"primary",fullWidth:!0,sx:{mt:1},startIcon:e.jsx(aa,{}),onClick:()=>{console.log("Sending message - Full item:",t),console.log("Selected result type:",u.type),console.log("Item ID:",t.id,"Type:",typeof t.id),P(null),p("/messages",{state:{recipientId:String(t.postedBy),recipientName:u.type==="vacancy"?t.title:`${t.firstName||"Player"} ${t.lastName||""}`.trim(),context:u.type==="vacancy"?`Regarding: ${t.title}`:`Regarding player availability in ${t.ageGroup}`,relatedVacancyId:u.type==="vacancy"?String(t.id):void 0,relatedPlayerAvailabilityId:u.type==="availability"?String(t.id):void 0,messageType:u.type==="vacancy"?"vacancy_interest":"player_inquiry"}})},children:"Send Message"})]})]}),e.jsxs(he,{children:[e.jsx(y,{startIcon:e.jsx(sa,{}),onClick:()=>{const a=new URLSearchParams;u.type==="vacancy"?(a.set("tab","0"),a.set("league","league"in t?t.league:""),a.set("ageGroup",t.ageGroup),a.set("position","position"in t?t.position:"")):(a.set("tab","1"),a.set("ageGroup",t.ageGroup),"preferredLeagues"in t&&t.preferredLeagues.length>0&&a.set("league",t.preferredLeagues[0]),"positions"in t&&t.positions&&t.positions.length>0&&a.set("position",t.positions[0])),a.set("location",t.location),a.set("highlightId",t.id),p(`/search?${a.toString()}`),P(null)},variant:"contained",children:"View Details"}),t.locationData&&e.jsx(y,{startIcon:e.jsx(na,{}),onClick:()=>{const a=`https://www.google.com/maps/dir/?api=1&destination=${t.locationData.latitude},${t.locationData.longitude}`;window.open(a,"_blank")},children:"Get Directions"}),e.jsx(y,{onClick:()=>P(null),children:"Close"})]})]})};return e.jsx(ca,{children:e.jsxs(h,{children:[e.jsx(X,{elevation:2,sx:{p:2,mb:2},children:e.jsx(I,{container:!0,spacing:2,alignItems:"center",children:e.jsx(I,{item:!0,xs:12,children:e.jsxs(h,{display:"flex",alignItems:"center",gap:2,flexWrap:"wrap",children:[e.jsx(y,{startIcon:e.jsx(Nt,{}),onClick:()=>xt(!Pe),variant:Pe?"contained":"outlined",size:"small",children:"Filters"}),e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsxs(ee,{direction:"row",spacing:1,children:[e.jsx(y,{variant:Z==="training"?"contained":"outlined",size:"small",onClick:()=>Ye("training"),children:"Training"}),e.jsx(y,{variant:Z==="match"?"contained":"outlined",size:"small",onClick:()=>Ye("match"),children:"Match"})]}),e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsxs(ee,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(y,{startIcon:e.jsx(Bt,{}),onClick:Mt,variant:F.isActive?"contained":"outlined",size:"small",disabled:F.isActive,children:F.isActive?"Drawing...":"Draw Area"}),j&&e.jsxs(e.Fragment,{children:[e.jsx(y,{startIcon:e.jsx(Tt,{}),onClick:Dt,variant:F.mode==="edit"?"contained":"outlined",size:"small",color:"primary",children:"Edit"}),e.jsx(y,{startIcon:e.jsx(Xe,{}),onClick:Et,variant:"outlined",size:"small",color:"success",children:"Save"}),e.jsx(y,{startIcon:e.jsx(_t,{}),onClick:Ze,variant:"outlined",size:"small",color:"secondary",children:"Clear"})]}),W.length>0&&e.jsxs(y,{startIcon:e.jsx(Ot,{}),onClick:Pt,variant:"outlined",size:"small",children:["Saved (",W.length,")"]})]}),e.jsx(Wt,{control:e.jsx(et,{checked:D,disabled:!j,size:"small"}),label:"Use Drawn Area",disabled:!j}),e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsx(y,{startIcon:e.jsx(Yt,{}),onClick:zt,variant:"outlined",size:b?"large":"small",disabled:D,sx:{minHeight:b?44:"auto",fontSize:b?"0.9rem":"0.875rem"},children:"My Location"}),c&&e.jsxs(e.Fragment,{children:[e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsx(y,{startIcon:e.jsx(Vt,{}),onClick:()=>J(!0),variant:"outlined",size:b?"large":"small",color:"secondary",sx:{minHeight:b?44:"auto",fontSize:b?"0.9rem":"0.875rem"},children:b?`Alerts (${K.filter(t=>t.isActive).length})`:`Email Alerts (${K.filter(t=>t.isActive).length})`})]}),v.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(T,{orientation:"vertical",flexItem:!0}),e.jsx(y,{onClick:()=>_e(!G),variant:G?"contained":"outlined",size:b?"large":"small",sx:{minHeight:b?44:"auto",fontSize:b?"0.9rem":"0.875rem"},children:G?"Exit Multi-Select":"Multi-Select"}),G&&e.jsxs(ee,{direction:"row",spacing:1,children:[e.jsx(y,{onClick:bt,size:b?"large":"small",disabled:M.size===v.length,sx:{minHeight:b?44:"auto",fontSize:b?"0.9rem":"0.875rem"},children:"Select All"}),e.jsxs(y,{onClick:qe,size:b?"large":"small",disabled:M.size===0,sx:{minHeight:b?44:"auto",fontSize:b?"0.9rem":"0.875rem"},children:["Clear (",M.size,")"]}),e.jsxs(y,{onClick:()=>ie(!0),variant:"contained",size:b?"large":"small",disabled:M.size===0,startIcon:e.jsx(tt,{}),sx:{minHeight:b?44:"auto",fontSize:b?"0.9rem":"0.875rem"},children:["Contact (",M.size,")"]})]})]})]})})})}),Pe&&e.jsxs(X,{elevation:2,sx:{p:2,mb:2},children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Search Filters"}),e.jsxs(I,{container:!0,spacing:2,children:[e.jsx(I,{item:!0,xs:12,sm:4,children:e.jsx(qt,{fullWidth:!0,size:"small",options:vt,value:w||null,onChange:(t,a)=>{De(a||""),setTimeout(Q,100)},renderInput:t=>e.jsx(de,{...t,label:"League",placeholder:"Type to search leagues..."}),filterOptions:(t,{inputValue:a})=>a?t.filter(n=>n.toLowerCase().includes(a.toLowerCase())):t,noOptionsText:"No leagues found"})}),e.jsx(I,{item:!0,xs:12,sm:4,children:e.jsxs(Ht,{fullWidth:!0,size:"small",children:[e.jsx(Kt,{children:"Age Group"}),e.jsxs(Jt,{value:L,label:"Age Group",onChange:t=>{Ee(t.target.value),setTimeout(Q,100)},children:[e.jsx(te,{value:"",children:"All Age Groups"}),jt.map(t=>e.jsx(te,{value:t,children:t},t))]})]})}),e.jsx(I,{item:!0,xs:12,sm:4,children:e.jsx(y,{onClick:()=>{De(""),Ee(""),setTimeout(Q,100)},variant:"outlined",size:"small",fullWidth:!0,children:"Clear Filters"})})]})]}),!D&&e.jsx(X,{elevation:2,sx:{p:2,mb:2},children:e.jsxs(I,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(I,{item:!0,xs:12,md:4,children:e.jsxs(h,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(d,{variant:"body2",children:"Search Radius:"}),e.jsx(h,{sx:{width:150},children:e.jsx(Zt,{value:x,onChange:(t,a)=>Gt(a),min:1,max:100,valueLabelDisplay:"auto",valueLabelFormat:t=>`${t}km`})})]})}),e.jsx(I,{item:!0,xs:12,md:8,children:e.jsx(d,{variant:"body2",color:"textSecondary",children:F.isActive?"Click on the map to start drawing a search area. Double-click to finish.":F.mode==="edit"?"Edit mode: Drag the corners to adjust your search area":"Click on the map to search different areas or draw a custom search area"})})]})}),e.jsx(X,{elevation:2,children:e.jsxs(da,{center:g,zoom:k,onMapLoad:Ct,style:{height:"500px",width:"100%"},children:[Rt(),z&&!D&&e.jsx("div",{ref:t=>{t&&z&&new google.maps.Circle({strokeColor:"#2196F3",strokeOpacity:.8,strokeWeight:2,fillColor:"#2196F3",fillOpacity:.1,map:z,center:g,radius:x*1e3})}})]})}),b&&e.jsxs(X,{elevation:3,sx:{position:"fixed",bottom:re?0:-300,left:0,right:0,transition:"bottom 0.3s ease-in-out",zIndex:1e3,maxHeight:"60vh",overflow:"hidden"},children:[e.jsx(h,{sx:{p:1,textAlign:"center",borderBottom:1,borderColor:"divider",cursor:"pointer"},onClick:()=>Ae(!re),children:e.jsx(d,{variant:"body2",color:"text.secondary",children:re?"ðŸ“± Swipe down to hide":`ðŸ“± Swipe up to show ${v.length} results`})}),re&&e.jsx(h,{sx:{overflow:"auto",maxHeight:"calc(60vh - 48px)"},children:v.map((t,a)=>{const n=`${t.type}_${a}`,s=M.has(n);return e.jsx(Fe,{sx:{m:1,border:s?2:0,borderColor:"primary.main"},children:e.jsx($e,{sx:{p:2},children:e.jsxs(h,{display:"flex",alignItems:"flex-start",gap:1,children:[G&&e.jsx(at,{checked:s,onChange:()=>Ge(n),size:"large"}),e.jsxs(h,{flex:1,onClick:()=>!G&&P(t),children:[e.jsx(d,{variant:"h6",component:"h3",sx:{fontSize:"1rem"},children:t.item.title}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsx(R,{label:t.type==="vacancy"?"Team":"Player",color:t.type==="vacancy"?"primary":"secondary",size:"small"}),t.distance&&t.distance>0&&e.jsx(d,{variant:"body2",color:"primary",children:Ue(t.distance)})]}),e.jsx(d,{variant:"body2",color:"textSecondary",children:t.item.description.length>60?`${t.item.description.substring(0,60)}...`:t.item.description})]})]})})},n)})})]}),e.jsxs(h,{mt:2,children:[e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsxs(d,{variant:"h6",children:["Search Results (",v.length,")"]}),e.jsxs(h,{display:"flex",gap:1,flexWrap:"wrap",children:[w&&e.jsx(R,{label:`League: ${w}`,size:"small",onDelete:()=>{De(""),setTimeout(Q,100)}}),L&&e.jsx(R,{label:`Age: ${L}`,size:"small",onDelete:()=>{Ee(""),setTimeout(Q,100)}}),D&&e.jsx(R,{label:"Custom Area",size:"small",color:"primary"}),G&&M.size>0&&e.jsx(R,{label:`${M.size} Selected`,size:"small",color:"success",variant:"filled"})]})]}),e.jsx(I,{container:!0,spacing:2,children:v.map((t,a)=>{const n=`${t.type}_${a}`,s=M.has(n);return e.jsx(I,{item:!0,xs:12,md:6,children:e.jsx(Fe,{sx:{cursor:"pointer","&:hover":{elevation:4},border:s?2:0,borderColor:"primary.main",position:"relative"},onClick:()=>G?Ge(n):P(t),children:e.jsxs($e,{children:[G&&e.jsx(h,{position:"absolute",top:8,right:8,children:e.jsx(at,{checked:s,onChange:()=>Ge(n),onClick:l=>l.stopPropagation()})}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",sx:{pr:G?5:0},children:[e.jsx(d,{variant:"h6",component:"h3",children:t.item.title}),e.jsx(R,{label:t.type==="vacancy"?"Team":"Player",color:t.type==="vacancy"?"primary":"secondary",size:"small"})]}),e.jsx(d,{variant:"body2",color:"textSecondary",paragraph:!0,children:t.item.description.length>100?`${t.item.description.substring(0,100)}...`:t.item.description}),e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(d,{variant:"body2",children:["position"in t.item?t.item.position:t.item.positions?.join(", ")||"N/A"," â€¢ ",t.item.ageGroup]}),t.distance&&t.distance>0?e.jsx(d,{variant:"body2",color:"primary",children:Ue(t.distance)}):D?e.jsx(d,{variant:"body2",color:"secondary",children:"In Area"}):null]})]})})},`${t.type}-${t.item.id}-${a}`)})})]}),Ft(),e.jsxs(ue,{open:dt,onClose:()=>oe(!1),children:[e.jsx(ge,{children:"Save Search Region"}),e.jsx(me,{children:e.jsx(de,{autoFocus:!0,margin:"dense",label:"Region Name",fullWidth:!0,variant:"outlined",value:H,onChange:t=>Te(t.target.value),placeholder:"e.g., North London, City Center, etc."})}),e.jsxs(he,{children:[e.jsx(y,{onClick:()=>oe(!1),children:"Cancel"}),e.jsx(y,{onClick:Lt,variant:"contained",disabled:!H.trim(),children:"Save"})]})]}),e.jsxs(Qt,{anchorEl:gt,open:ut,onClose:()=>ke(!1),PaperProps:{style:{maxHeight:400,width:"300px"}},children:[e.jsx(te,{disabled:!0,children:e.jsx(d,{variant:"subtitle2",children:"Saved Search Regions"})}),e.jsx(T,{}),W.map(t=>e.jsxs(te,{dense:!0,children:[e.jsx(Xt,{primary:t.name,secondary:`Saved ${t.createdAt.toLocaleDateString()}`,onClick:()=>At(t),style:{cursor:"pointer"}}),e.jsx(ea,{children:e.jsx(pe,{edge:"end",size:"small",onClick:a=>{a.stopPropagation(),It(t.id)},children:e.jsx(st,{fontSize:"small"})})})]},t.id)),W.length===0&&e.jsx(te,{disabled:!0,children:e.jsx(d,{variant:"body2",color:"textSecondary",children:"No saved regions yet"})})]}),e.jsx(ta,{open:Ce.open,autoHideDuration:4e3,onClose:()=>f(t=>({...t,open:!1})),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(lt,{onClose:()=>f(t=>({...t,open:!1})),severity:Ce.severity,sx:{width:"100%"},children:Ce.message})}),e.jsxs(ue,{open:yt,onClose:()=>J(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(ge,{children:e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(d,{variant:"h6",children:"Email Alerts"}),e.jsx(pe,{onClick:()=>J(!1),size:"small",children:e.jsx(nt,{})})]})}),e.jsx(me,{children:e.jsxs(ee,{spacing:3,children:[e.jsxs(h,{children:[e.jsx(d,{variant:"h6",gutterBottom:!0,children:"Create New Alert"}),e.jsx(d,{variant:"body2",color:"textSecondary",paragraph:!0,children:"Get notified when new matches are found for your search criteria."}),e.jsxs(I,{container:!0,spacing:2,children:[e.jsxs(I,{item:!0,xs:12,sm:6,children:[e.jsx(y,{startIcon:e.jsx(tt,{}),onClick:()=>Ke("new_match"),variant:"outlined",fullWidth:!0,disabled:!c,children:"Alert for Current Search"}),e.jsxs(d,{variant:"caption",display:"block",sx:{mt:1},children:[D?"Custom area":`${x}km radius`,w&&` â€¢ ${w}`,L&&` â€¢ ${L}`]})]}),j&&e.jsxs(I,{item:!0,xs:12,sm:6,children:[e.jsx(y,{startIcon:e.jsx(Xe,{}),onClick:()=>Ke("saved_search"),variant:"outlined",fullWidth:!0,disabled:!c,children:"Alert for Saved Region"}),e.jsx(d,{variant:"caption",display:"block",sx:{mt:1},children:"Custom drawn area with current filters"})]})]})]}),e.jsx(T,{}),e.jsxs(h,{children:[e.jsxs(d,{variant:"h6",gutterBottom:!0,children:["Your Active Alerts (",K.filter(t=>t.isActive).length,")"]}),K.length===0?e.jsx(d,{variant:"body2",color:"textSecondary",children:"No email alerts created yet."}):e.jsx(ee,{spacing:2,children:K.map(t=>e.jsx(Fe,{variant:"outlined",children:e.jsx($e,{children:e.jsxs(h,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",children:[e.jsxs(h,{flex:1,children:[e.jsxs(h,{display:"flex",alignItems:"center",gap:1,mb:1,children:[e.jsx(R,{label:t.alertType==="new_match"?"Search Alert":"Region Alert",size:"small",color:t.alertType==="new_match"?"primary":"secondary"}),e.jsx(R,{label:t.isActive?"Active":"Inactive",size:"small",color:t.isActive?"success":"default"})]}),e.jsx(d,{variant:"body2",color:"textSecondary",children:t.searchRegion?e.jsxs(e.Fragment,{children:["Custom region: ",t.searchRegion.name]}):e.jsxs(e.Fragment,{children:[t.filters?.radius?`${t.filters.radius}km radius`:"Location-based search",t.filters?.league&&` â€¢ ${t.filters.league}`,t.filters?.ageGroup&&` â€¢ ${t.filters.ageGroup}`]})}),e.jsxs(d,{variant:"caption",color:"textSecondary",children:["Created: ",new Date(t.createdAt).toLocaleDateString()]})]}),e.jsxs(h,{display:"flex",gap:1,children:[e.jsx(et,{checked:t.isActive,onChange:a=>kt(t.id,a.target.checked),size:"small"}),e.jsx(pe,{onClick:()=>St(t.id),size:"small",color:"error",children:e.jsx(st,{fontSize:"small"})})]})]})})},t.id))})]})]})}),e.jsx(he,{children:e.jsx(y,{onClick:()=>J(!1),children:"Close"})})]}),e.jsxs(ue,{open:ht,onClose:()=>ie(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsxs(ge,{children:["Contact Multiple ",M.size>0&&Array.from(M).some(t=>t.startsWith("vacancy"))?"Teams":"Players"]}),e.jsxs(me,{children:[e.jsxs(d,{variant:"body2",color:"text.secondary",sx:{mb:2},children:["Send a message to ",M.size," selected ",M.size===1?"contact":"contacts"]}),e.jsx(de,{fullWidth:!0,label:"Subject",value:U.subject,onChange:t=>Oe(a=>({...a,subject:t.target.value})),sx:{mb:2}}),e.jsx(de,{fullWidth:!0,label:"Message",multiline:!0,rows:6,value:U.message,onChange:t=>Oe(a=>({...a,message:t.target.value})),placeholder:"Introduce yourself and explain your interest...",sx:{mb:2}}),e.jsxs(h,{sx:{p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"Selected contacts:"}),He().slice(0,3).map((t,a)=>e.jsxs(d,{variant:"body2",children:["â€¢ ",t.item.title," (",t.type==="vacancy"?"Team":"Player",")"]},a)),M.size>3&&e.jsxs(d,{variant:"body2",color:"text.secondary",children:["... and ",M.size-3," more"]})]})]}),e.jsxs(he,{children:[e.jsx(y,{onClick:()=>ie(!1),children:"Cancel"}),e.jsxs(y,{onClick:wt,variant:"contained",disabled:!U.subject.trim()||!U.message.trim(),children:["Send Messages (",M.size,")"]})]})]})]})})};export{ca as G,ba as M,ha as _,ja as g};
