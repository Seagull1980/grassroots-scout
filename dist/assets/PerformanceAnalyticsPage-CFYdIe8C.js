import{j as e,ae as P,i as u,B as n,k as p,I as d,bu as ne,T as t,g as re,b6 as B,aj as F,R as ae,c9 as ie,M as le,q as v,h as R,r as oe,s as M,bA as ce,w as de,J as xe,K as he,N as je,Q as ue,v as x,bv as me,am as N,x as z,y as E,z as L,E as G,G as r,D as ge,a6 as pe,ab as ye,ca as Q,C as m,a as g,a4 as fe,S as be,o as V,e as ve,H as Ce,az as Se,p as we}from"./mui-vendor-rZ0WLTig.js";import{u as Ie,r as i}from"./react-vendor-CRXLTmIH.js";import{L as ke}from"./charts-vendor-B0AXBVgz.js";import{u as Ae}from"./admin-features-d6LVy8Ft.js";import{a as O,A as C}from"./analytics-features-CT0hzqEO.js";const Fe=()=>{const{user:l}=Ae(),h=Ie(),[S,w]=i.useState("overview"),[q,y]=i.useState(!1),[H,I]=i.useState(!1),[k,f]=i.useState(""),[o,A]=i.useState(null),[c,$]=i.useState([]),[b,J]=i.useState([]),[D,T]=i.useState(null),[K,j]=i.useState(!1);i.useEffect(()=>{l&&(W(),U())},[l]);const W=async()=>{try{if(I(!0),f(""),l?.role==="Player"){const s=await O.getPlayerStats(l.id,{type:"season",label:"Current Season"});A(s);const a=await O.getPlayerTrends(l.id,"rating",{type:"month",label:"This Month"});J(a)}else l?.role==="Coach"&&A({goalsFor:45,wins:12,winRate:75,matchesPlayed:16})}catch(s){f("Failed to load analytics data"),console.error("Analytics loading error:",s)}finally{I(!1)}},U=async()=>{try{const s=[{id:"1",type:"success",title:"Great Performance!",message:"Your last match rating was 8.5/10",read:!1,createdAt:new Date().toISOString()}];$(s)}catch(s){console.error("Failed to load notifications:",s)}},Y=s=>{w(s),y(!1)},Z=()=>{if(!o)return e.jsx(r,{container:!0,spacing:3,children:[1,2,3,4].map(a=>e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{children:e.jsx(g,{children:e.jsx(fe,{variant:"rectangular",height:80})})})},a))});const s=l?.role==="Player";return e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{sx:{background:"linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%)"},children:e.jsx(g,{sx:{color:"white"},children:e.jsxs(n,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",children:s?o.goals:o.goalsFor||0}),e.jsxs(t,{variant:"subtitle2",sx:{opacity:.9},children:["Goals ",s?"Scored":"For"]})]}),e.jsx(be,{sx:{fontSize:48,opacity:.8}})]})})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{sx:{background:"linear-gradient(135deg, #64748B 0%, #475569 100%)"},children:e.jsx(g,{sx:{color:"white"},children:e.jsxs(n,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",children:s?o.assists:o.wins||0}),e.jsx(t,{variant:"subtitle2",sx:{opacity:.9},children:s?"Assists":"Wins"})]}),e.jsx(V,{sx:{fontSize:48,opacity:.8}})]})})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{sx:{background:"linear-gradient(135deg, #8B5CF6 0%, #A855F7 100%)"},children:e.jsx(g,{sx:{color:"white"},children:e.jsxs(n,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",children:s?`${o.formRating.toFixed(1)}`:`${o.winRate?.toFixed(0)||0}%`}),e.jsx(t,{variant:"subtitle2",sx:{opacity:.9},children:s?"Form Rating":"Win Rate"})]}),e.jsx(ve,{sx:{fontSize:48,opacity:.8}})]})})})}),e.jsx(r,{item:!0,xs:12,sm:6,md:3,children:e.jsx(m,{sx:{background:"linear-gradient(135deg, #94A3B8 0%, #64748B 100%)"},children:e.jsx(g,{sx:{color:"white"},children:e.jsxs(n,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(t,{variant:"h4",fontWeight:"bold",children:s?o.minutesPlayed:o.matchesPlayed||0}),e.jsx(t,{variant:"subtitle2",sx:{opacity:.9},children:s?"Minutes":"Matches"})]}),e.jsx(Ce,{sx:{fontSize:48,opacity:.8}})]})})})})]})},X=()=>{if(b.length===0)return null;const s={labels:b.map(a=>a.period),datasets:[{label:"Performance Trend",data:b.map(a=>a.value),borderColor:"#1976d2",backgroundColor:"rgba(25, 118, 210, 0.1)",fill:!0,tension:.4}]};return e.jsxs(p,{sx:{p:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Recent Performance Trend"}),e.jsx(n,{height:300,children:e.jsx(ke,{data:s,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0}}}})})]})},_=()=>e.jsxs(p,{sx:{p:3},children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,children:[e.jsx(t,{variant:"h6",children:"Analytics Insights"}),e.jsx(d,{size:"small",onClick:()=>j(!0),children:e.jsx(B,{badgeContent:c.filter(s=>!s.read).length,color:"error",children:e.jsx(F,{})})})]}),c.slice(0,3).map(s=>e.jsxs(u,{severity:s.type,sx:{mb:1},action:e.jsx(d,{size:"small",children:e.jsx(Se,{})}),children:[e.jsx(t,{variant:"subtitle2",fontWeight:"bold",children:s.title}),e.jsx(t,{variant:"body2",children:s.message})]},s.id)),c.length>3&&e.jsxs(x,{fullWidth:!0,variant:"text",onClick:()=>j(!0),children:["View All Insights (",c.length,")"]})]}),ee=()=>e.jsxs(p,{sx:{p:3},children:[e.jsx(t,{variant:"h6",gutterBottom:!0,children:"Quick Actions"}),e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(we,{}),onClick:()=>h("/analytics/reports"),children:"Generate Report"})}),e.jsx(r,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(Q,{}),onClick:()=>w("comparison"),children:"Compare Stats"})}),e.jsx(r,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(V,{}),onClick:()=>h("/analytics/goals"),children:"Set Goals"})}),e.jsx(r,{item:!0,xs:6,children:e.jsx(x,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(M,{}),onClick:()=>{},children:"Export Data"})})]})]}),se=()=>{const s=[{id:"overview",label:"Overview",icon:e.jsx(ge,{})},{id:"player",label:"Player Analytics",icon:e.jsx(pe,{})},{id:"team",label:"Team Analytics",icon:e.jsx(ye,{})},{id:"comparison",label:"Comparisons",icon:e.jsx(Q,{})}];return e.jsxs(me,{anchor:"left",open:q,onClose:()=>y(!1),sx:{"& .MuiDrawer-paper":{width:280,boxSizing:"border-box"}},children:[e.jsx(n,{sx:{p:2},children:e.jsx(t,{variant:"h6",fontWeight:"bold",children:"Analytics Menu"})}),e.jsx(N,{}),e.jsx(z,{children:s.map(a=>e.jsxs(E,{button:!0,selected:S===a.id,onClick:()=>Y(a.id),children:[e.jsx(L,{children:a.icon}),e.jsx(G,{primary:a.label})]},a.id))}),e.jsx(N,{}),e.jsx(z,{children:e.jsxs(E,{button:!0,onClick:()=>h("/analytics/settings"),children:[e.jsx(L,{children:e.jsx(R,{})}),e.jsx(G,{primary:"Settings"})]})})]})},te=()=>{switch(S){case"overview":return e.jsxs(r,{container:!0,spacing:3,children:[e.jsx(r,{item:!0,xs:12,children:Z()}),e.jsx(r,{item:!0,xs:12,md:8,children:X()}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsxs(n,{display:"flex",flexDirection:"column",gap:2,children:[_(),ee()]})})]});case"player":return e.jsx(C,{targetType:"player"});case"team":return e.jsx(C,{targetType:"team",targetId:l?.teamId});case"comparison":return e.jsx(C,{targetType:"player"});default:return null}};return l?e.jsxs(n,{sx:{display:"flex",minHeight:"100vh",bgcolor:"background.default"},children:[se(),e.jsxs(n,{component:"main",sx:{flexGrow:1},children:[e.jsx(p,{sx:{p:2,mb:2,borderRadius:0},children:e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsx(d,{onClick:()=>y(!0),children:e.jsx(ne,{})}),e.jsxs(t,{variant:"h5",fontWeight:"bold",sx:{ml:1},children:[e.jsx(re,{sx:{mr:1,verticalAlign:"middle"}}),"Performance Analytics"]})]}),e.jsxs(n,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(d,{onClick:()=>j(!0),children:e.jsx(B,{badgeContent:c.filter(s=>!s.read).length,color:"error",children:e.jsx(F,{})})}),e.jsx(d,{onClick:W,disabled:H,children:e.jsx(ae,{})}),e.jsx(d,{onClick:s=>T(s.currentTarget),children:e.jsx(ie,{})})]})]})}),e.jsxs(P,{maxWidth:"xl",sx:{py:2},children:[k&&e.jsx(u,{severity:"error",sx:{mb:2},onClose:()=>f(""),children:k}),te()]}),e.jsxs(le,{anchorEl:D,open:!!D,onClose:()=>T(null),children:[e.jsxs(v,{onClick:()=>h("/analytics/settings"),children:[e.jsx(R,{sx:{mr:1}})," Settings"]}),e.jsxs(v,{onClick:()=>{},children:[e.jsx(oe,{sx:{mr:1}})," Share Dashboard"]}),e.jsxs(v,{onClick:()=>{},children:[e.jsx(M,{sx:{mr:1}})," Export All Data"]})]}),e.jsx(ce,{color:"primary","aria-label":"add",sx:{position:"fixed",bottom:16,right:16},onClick:()=>h("/analytics/goals"),children:e.jsx(de,{})}),e.jsxs(xe,{open:K,onClose:()=>j(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(he,{children:"Analytics Insights & Notifications"}),e.jsx(je,{children:c.length===0?e.jsx(u,{severity:"info",children:"No new insights available."}):c.map(s=>e.jsxs(u,{severity:s.type,sx:{mb:2},children:[e.jsx(t,{variant:"subtitle1",fontWeight:"bold",children:s.title}),e.jsx(t,{variant:"body2",children:s.message}),e.jsx(t,{variant:"caption",color:"text.secondary",children:new Date(s.createdAt).toLocaleString()})]},s.id))}),e.jsx(ue,{children:e.jsx(x,{onClick:()=>j(!1),children:"Close"})})]})]})]}):e.jsx(P,{maxWidth:"lg",sx:{py:4},children:e.jsx(u,{severity:"warning",children:"Please log in to access analytics."})})};export{Fe as default};
