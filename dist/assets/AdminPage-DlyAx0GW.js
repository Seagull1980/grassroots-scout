import{av as Ie,aw as ke,j as e,b8 as P,B as t,T as n,s as o,A as Se,aE as Te,bW as U,I as z,bP as Le,M as We,i as W,al as H,H as De,v as N,aY as R,aJ as Y,n as $,G as c,C as m,a as j,b5 as te,bX as O,aB as Pe,z as ze,ah as Ne,ai as q,aA as Fe,af as re,y as Ge,am as Ee,an as Me,ao as Be,ap as V,aq as r,ar as Ue,ag as He,bi as Re,N as Ye,bh as $e,aN as Oe,ab as qe,b9 as Q,ak as Ve,b2 as Qe,a6 as ae,a7 as ie,a8 as oe,a0 as x,a9 as le}from"./mui-vendor-JAsu9f5S.js";import{u as _e,r as l}from"./react-vendor-BTglNIF_.js";import{u as Je,S as Xe,l as b,m as Ke,o as ce}from"./admin-features-R-myf6Sn.js";const ns=()=>{console.log("ðŸ” AdminPage render start"),console.log("ðŸ”— Hook 1: useAuth");const{impersonateUser:de,stopImpersonation:xe,isImpersonating:p,user:h}=Je();console.log("ðŸ”— Hook 2: useNavigate");const k=_e();console.log("ðŸ”— Hook 3: useTheme");const he=Ie();console.log("ðŸ”— Hook 4: useMediaQuery");const D=ke(he.breakpoints.down("md"));console.log("ðŸ”— Hook 5-19: useState hooks");const[F,S]=l.useState([]),[ue,_]=l.useState(!1),[J,u]=l.useState(null),[X,f]=l.useState(null),[ge,v]=l.useState(!1),[y,G]=l.useState(null),[T,me]=l.useState(0),[K,Z]=l.useState(null),[i,d]=l.useState({name:"",region:"",ageGroup:"",country:"",url:"",description:""}),[g,L]=l.useState({email:"",firstName:"",lastName:"",password:""}),[je,C]=l.useState(!1),[ee,A]=l.useState(!1);if(console.log("ðŸ” All hooks declared, user check:",h?"exists":"null"),l.useEffect(()=>{(async()=>{if(!(!h||h.role!=="Admin"))try{_(!0);const a=await b.getAll();S(a.leagues||[])}catch(a){u(Ke(a))}finally{_(!1)}})()},[h]),!h)return e.jsx(P,{maxWidth:"lg",children:e.jsx(t,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e.jsxs("div",{children:[e.jsx(n,{variant:"h4",color:"error",gutterBottom:!0,children:"Access Denied"}),e.jsx(n,{variant:"body1",children:"Please log in to access the admin panel."}),e.jsx(o,{variant:"contained",onClick:()=>k("/login"),sx:{mt:2},children:"Go to Login"})]})})});if(h.role!=="Admin")return e.jsx(P,{maxWidth:"lg",children:e.jsxs(t,{sx:{textAlign:"center",mt:4},children:[e.jsx(n,{variant:"h4",color:"error",gutterBottom:!0,children:"Access Denied"}),e.jsx(n,{variant:"body1",children:"You do not have permission to access this page."}),e.jsx(o,{variant:"contained",onClick:()=>k("/dashboard"),sx:{mt:2},children:"Go to Dashboard"})]})});const se=()=>{u(null),f(null)},pe=(s,a)=>{me(a)},be=s=>{Z(s.currentTarget)},w=()=>{Z(null)},ye=async()=>{try{await b.create(i),f("League created successfully"),v(!1),d({name:"",region:"",ageGroup:"",country:"",url:"",description:""});const s=await b.getAll();S(s.leagues||[])}catch(s){u(s.response?.data?.error||"Failed to create league")}},fe=async()=>{if(y)try{await b.update(typeof y.id=="string"?parseInt(y.id):y.id,i),f("League updated successfully"),v(!1),G(null),d({name:"",region:"",ageGroup:"",country:"",url:"",description:""});const s=await b.getAll();S(s.leagues||[])}catch(s){u(s.response?.data?.error||"Failed to update league")}},ve=async s=>{if(window.confirm("Are you sure you want to delete this league? This action cannot be undone."))try{await b.delete(s),f("League deleted successfully");const a=await b.getAll();S(a.leagues||[])}catch(a){u(a.response?.data?.error||"Failed to delete league")}},Ce=async(s,a)=>{const M=a?"freeze":"unfreeze";if(window.confirm(`Are you sure you want to ${M} this league? ${a?"Users will not be able to select it.":"Users will be able to select it again."}`))try{await ce.freezeLeague(s,!a),f(`League ${M}d successfully`);const B=await b.getAll();S(B.leagues||[])}catch(B){u(B.response?.data?.error||`Failed to ${M} league`)}},Ae=s=>{G(s),d({name:s.name,region:s.region||"",ageGroup:s.ageGroup||"",country:s.country||"",url:s.url||"",description:s.description||""}),v(!0)},ne=()=>{G(null),d({name:"",region:"",ageGroup:"",country:"",url:"",description:""}),v(!0)},we=async()=>{try{await ce.createAdmin(g),f("Admin user created successfully"),C(!1),L({email:"",firstName:"",lastName:"",password:""})}catch(s){u(s.response?.data?.error||"Failed to create admin user")}},I=s=>{if(ee){console.log("â³ Impersonation already in progress, ignoring request");return}try{A(!0),console.log("ðŸ”„ Attempting to impersonate user type:",s),console.log("ðŸ‘¤ Current user:",h),console.log("ðŸ” Is impersonating:",p),de(s),console.log("âœ… Impersonation successful, navigating to dashboard..."),setTimeout(()=>{k("/dashboard"),A(!1)},100)}catch(a){console.error("âŒ Error during user impersonation:",a),u("Failed to switch user. Please try again."),A(!1)}},E=()=>{if(ee){console.log("â³ Impersonation operation already in progress, ignoring request");return}try{A(!0),console.log("ðŸ”„ Stopping impersonation..."),xe(),console.log("âœ… Impersonation stopped, navigating to admin..."),setTimeout(()=>{k("/admin"),A(!1)},100)}catch(s){console.error("âŒ Error stopping impersonation:",s),u("Failed to stop impersonation. Please try again."),A(!1)}};return e.jsxs(t,{sx:{flexGrow:1,minHeight:"100vh",backgroundColor:"background.default"},children:[e.jsx(t,{sx:{background:"linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%)",borderRadius:0,mb:3},children:e.jsx(P,{maxWidth:"lg",children:e.jsxs(t,{sx:{py:3,px:2},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",flexGrow:1},children:[e.jsx(Se,{sx:{mr:2,bgcolor:"rgba(255,255,255,0.2)",width:56,height:56},children:e.jsx(Te,{sx:{fontSize:32}})}),e.jsxs(t,{children:[e.jsx(n,{variant:D?"h5":"h4",component:"h1",sx:{fontWeight:700,color:"white",textShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:"Admin Dashboard"}),e.jsx(n,{variant:"body1",sx:{color:"rgba(255,255,255,0.9)",fontWeight:500},children:p?`Currently viewing as ${h.role}`:"System Management & Analytics"})]})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[!D&&e.jsx(e.Fragment,{children:p&&e.jsx(o,{startIcon:e.jsx(U,{}),variant:"outlined",sx:{borderColor:"rgba(255,255,255,0.5)",color:"white","&:hover":{borderColor:"white",bgcolor:"rgba(255,255,255,0.1)"}},onClick:E,children:"Stop Impersonation"})}),e.jsx(z,{color:"inherit",onClick:be,sx:{bgcolor:"rgba(255,255,255,0.1)","&:hover":{bgcolor:"rgba(255,255,255,0.2)"}},children:e.jsx(Le,{})})]})]})})}),e.jsxs(We,{anchorEl:K,open:!!K,onClose:w,PaperProps:{sx:{minWidth:200}},children:[e.jsxs(W,{onClick:()=>{w(),C(!0)},children:[e.jsx(H,{sx:{mr:2}}),"Create Admin"]}),e.jsx(De,{}),p?e.jsxs(W,{onClick:()=>{w(),E()},children:[e.jsx(U,{sx:{mr:2}}),"Stop Impersonation"]}):e.jsxs(e.Fragment,{children:[e.jsxs(W,{onClick:()=>{w(),I("Player")},children:[e.jsx(N,{sx:{mr:2}}),"Test as Player"]}),e.jsxs(W,{onClick:()=>{w(),I("Coach")},children:[e.jsx(R,{sx:{mr:2}}),"Test as Coach"]}),e.jsxs(W,{onClick:()=>{w(),I("Parent/Guardian")},children:[e.jsx(Y,{sx:{mr:2}}),"Test as Parent"]})]})]}),e.jsxs(P,{maxWidth:"lg",sx:{py:4},children:[J&&e.jsx($,{severity:"error",sx:{mb:3},onClose:se,children:J}),X&&e.jsx($,{severity:"success",sx:{mb:3},onClose:se,children:X}),p&&e.jsxs($,{severity:"info",sx:{mb:3},action:e.jsx(o,{color:"inherit",size:"small",onClick:E,startIcon:e.jsx(U,{}),children:"Stop"}),children:[e.jsx(n,{variant:"body2",fontWeight:"bold",children:"Impersonation Mode Active"}),"You are currently viewing the platform as a ",e.jsx("strong",{children:h.role}),'. Click "Stop" to return to admin view.']}),e.jsxs(c,{container:!0,spacing:3,sx:{mb:4},children:[e.jsx(c,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(m,{sx:{background:"linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%)",color:"white"},children:e.jsx(j,{children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(t,{children:[e.jsx(n,{variant:"h4",fontWeight:"bold",children:F.length}),e.jsx(n,{variant:"body2",sx:{opacity:.9},children:"Active Leagues"})]}),e.jsx(te,{sx:{fontSize:40,opacity:.8}})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(m,{sx:{background:"linear-gradient(135deg, #64748B 0%, #475569 100%)",color:"white"},children:e.jsx(j,{children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(t,{children:[e.jsx(n,{variant:"h4",fontWeight:"bold",children:"1,247"}),e.jsx(n,{variant:"body2",sx:{opacity:.9},children:"Total Users"})]}),e.jsx(O,{sx:{fontSize:40,opacity:.8}})]})})})}),e.jsx(c,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(m,{sx:{background:"linear-gradient(135deg, #94A3B8 0%, #64748B 100%)",color:"white"},children:e.jsx(j,{children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(t,{children:[e.jsx(n,{variant:"h4",fontWeight:"bold",children:"342"}),e.jsx(n,{variant:"body2",sx:{opacity:.9},children:"Active Matches"})]}),e.jsx(Pe,{sx:{fontSize:40,opacity:.8}})]})})})})]}),e.jsxs(ze,{elevation:2,sx:{mb:4},children:[e.jsxs(Ne,{value:T,onChange:pe,variant:D?"scrollable":"fullWidth",scrollButtons:"auto",sx:{borderBottom:1,borderColor:"divider"},children:[e.jsx(q,{label:"League Management",icon:e.jsx(te,{}),iconPosition:"start",sx:{minHeight:64}}),e.jsx(q,{label:"User Testing",icon:e.jsx(N,{}),iconPosition:"start",sx:{minHeight:64}}),e.jsx(q,{label:"System Settings",icon:e.jsx(Fe,{}),iconPosition:"start",sx:{minHeight:64}})]}),e.jsxs(t,{sx:{p:3},children:[T===0&&e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(n,{variant:"h5",component:"h2",children:"League Management"}),e.jsx(o,{variant:"contained",startIcon:e.jsx(re,{}),onClick:ne,children:"Add League"})]}),ue?e.jsx(t,{sx:{display:"flex",justifyContent:"center",p:4},children:e.jsx(Ge,{})}):e.jsx(Ee,{children:e.jsxs(Me,{children:[e.jsx(Be,{children:e.jsxs(V,{children:[e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Country"}),e.jsx(r,{children:"Region"}),e.jsx(r,{children:"Age Group"}),e.jsx(r,{children:"URL"}),e.jsx(r,{children:"Description"}),e.jsx(r,{align:"center",children:"Status"}),e.jsx(r,{align:"center",children:"Actions"})]})}),e.jsxs(Ue,{children:[F.map(s=>e.jsxs(V,{hover:!0,children:[e.jsx(r,{children:e.jsx(n,{variant:"subtitle2",fontWeight:"bold",children:s.name})}),e.jsx(r,{children:e.jsx(n,{variant:"body2",color:"text.secondary",children:s.country||"England"})}),e.jsx(r,{children:e.jsx(n,{variant:"body2",color:"text.secondary",children:s.region||"N/A"})}),e.jsx(r,{children:e.jsx(n,{variant:"body2",color:"text.secondary",children:s.ageGroup||"N/A"})}),e.jsx(r,{children:s.url?e.jsx(n,{variant:"body2",color:"primary",component:"a",href:s.url,target:"_blank",rel:"noopener noreferrer",sx:{textDecoration:"none","&:hover":{textDecoration:"underline"}},children:"View League"}):e.jsx(n,{variant:"body2",color:"text.secondary",children:"No URL"})}),e.jsx(r,{children:e.jsx(n,{variant:"body2",color:"text.secondary",children:s.description||"No description"})}),e.jsx(r,{align:"center",children:s.isActive?e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:.5},children:[e.jsx(He,{fontSize:"small",sx:{color:"success.main"}}),e.jsx(n,{variant:"body2",color:"success.main",children:"Active"})]}):e.jsxs(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:.5},children:[e.jsx(Re,{fontSize:"small",sx:{color:"warning.main"}}),e.jsx(n,{variant:"body2",color:"warning.main",children:"Frozen"})]})}),e.jsxs(r,{align:"center",children:[e.jsx(z,{color:"primary",onClick:()=>Ae(s),size:"small",title:"Edit league",children:e.jsx(Ye,{})}),e.jsx(z,{color:s.isActive?"warning":"success",onClick:()=>Ce(typeof s.id=="string"?parseInt(s.id):s.id,s.isActive??!1),size:"small",title:s.isActive?"Freeze league":"Unfreeze league",children:s.isActive?e.jsx($e,{}):e.jsx(Oe,{})}),e.jsx(z,{color:"error",onClick:()=>ve(typeof s.id=="string"?parseInt(s.id):s.id),size:"small",title:"Delete league",children:e.jsx(qe,{})})]})]},s.id)),F.length===0&&e.jsx(V,{children:e.jsx(r,{colSpan:3,align:"center",sx:{py:4},children:e.jsx(n,{variant:"body2",color:"text.secondary",children:"No leagues found. Create your first league to get started."})})})]})]})})]}),T===1&&e.jsxs(t,{children:[e.jsx(n,{variant:"h5",component:"h2",sx:{mb:2},children:"User Testing (Impersonation)"}),e.jsx(n,{variant:"body1",color:"text.secondary",sx:{mb:3},children:"Test the platform from different user perspectives without creating separate accounts."}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(m,{sx:{height:"100%",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-4px)",boxShadow:4}},children:[e.jsxs(j,{sx:{textAlign:"center",pb:1},children:[e.jsx(N,{sx:{fontSize:48,color:"info.main",mb:2}}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Player"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Test player features like availability posting and team searching"})]}),e.jsx(Q,{sx:{px:2,pb:2},children:e.jsx(o,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(N,{}),onClick:()=>I("Player"),disabled:p,children:"Test as Player"})})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(m,{sx:{height:"100%",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-4px)",boxShadow:4}},children:[e.jsxs(j,{sx:{textAlign:"center",pb:1},children:[e.jsx(R,{sx:{fontSize:48,color:"warning.main",mb:2}}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Coach"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Test coach features like team management and player recruitment"})]}),e.jsx(Q,{sx:{px:2,pb:2},children:e.jsx(o,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(R,{}),onClick:()=>I("Coach"),disabled:p,children:"Test as Coach"})})]})}),e.jsx(c,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(m,{sx:{height:"100%",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-4px)",boxShadow:4}},children:[e.jsxs(j,{sx:{textAlign:"center",pb:1},children:[e.jsx(Y,{sx:{fontSize:48,color:"success.main",mb:2}}),e.jsx(n,{variant:"h6",gutterBottom:!0,children:"Parent"}),e.jsx(n,{variant:"body2",color:"text.secondary",children:"Test parent features for managing children's football activities"})]}),e.jsx(Q,{sx:{px:2,pb:2},children:e.jsx(o,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(Y,{}),onClick:()=>I("Parent/Guardian"),disabled:p,children:"Test as Parent"})})]})})]})]}),T===2&&e.jsxs(t,{children:[e.jsx(n,{variant:"h5",component:"h2",sx:{mb:3},children:"System Settings"}),e.jsxs(c,{container:!0,spacing:3,children:[e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{children:e.jsxs(j,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(H,{sx:{mr:2,color:"primary.main"}}),e.jsx(n,{variant:"h6",children:"Create Admin User"})]}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Create a new administrator account with full system access."}),e.jsx(o,{variant:"outlined",startIcon:e.jsx(H,{}),onClick:()=>C(!0),fullWidth:!0,children:"Create Admin Account"})]})})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{children:e.jsxs(j,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(O,{sx:{mr:2,color:"info.main"}}),e.jsx(n,{variant:"h6",children:"User Management"})]}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Manage users, grant beta access, view user details, and moderate accounts."}),e.jsx(o,{variant:"outlined",startIcon:e.jsx(O,{}),onClick:()=>k("/admin/users"),fullWidth:!0,children:"Manage Users"})]})})}),e.jsx(c,{item:!0,xs:12,md:6,children:e.jsx(m,{children:e.jsxs(j,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Ve,{sx:{mr:2,color:"success.main"}}),e.jsx(n,{variant:"h6",children:"Site Activity & Traffic"})]}),e.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"View platform activity, user growth, and recent site traffic."}),e.jsx(Xe,{})]})})})]})]})]})]}),D&&e.jsx(Qe,{color:"primary","aria-label":"add",sx:{position:"fixed",bottom:16,right:16,zIndex:1e3},onClick:T===0?ne:()=>C(!0),children:e.jsx(re,{})})]}),e.jsxs(ae,{open:ge,onClose:()=>v(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{children:y?"Edit League":"Create New League"}),e.jsxs(oe,{children:[e.jsx(x,{autoFocus:!0,margin:"dense",label:"League Name",type:"text",fullWidth:!0,variant:"outlined",value:i.name,onChange:s=>d({...i,name:s.target.value}),sx:{mb:2}}),e.jsx(x,{margin:"dense",label:"Region",type:"text",fullWidth:!0,variant:"outlined",value:i.region,onChange:s=>d({...i,region:s.target.value}),sx:{mb:2}}),e.jsx(x,{margin:"dense",label:"Age Group",type:"text",fullWidth:!0,variant:"outlined",value:i.ageGroup,onChange:s=>d({...i,ageGroup:s.target.value}),sx:{mb:2}}),e.jsx(x,{margin:"dense",label:"Country",type:"text",fullWidth:!0,variant:"outlined",value:i.country,onChange:s=>d({...i,country:s.target.value}),placeholder:"England",sx:{mb:2}}),e.jsx(x,{margin:"dense",label:"League URL",type:"url",fullWidth:!0,variant:"outlined",value:i.url,onChange:s=>d({...i,url:s.target.value}),sx:{mb:2}}),e.jsx(x,{margin:"dense",label:"Description",type:"text",fullWidth:!0,variant:"outlined",multiline:!0,rows:3,value:i.description,onChange:s=>d({...i,description:s.target.value})})]}),e.jsxs(le,{children:[e.jsx(o,{onClick:()=>v(!1),children:"Cancel"}),e.jsx(o,{onClick:y?fe:ye,variant:"contained",children:y?"Update":"Create"})]})]}),e.jsxs(ae,{open:je,onClose:()=>C(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{children:"Create Admin User"}),e.jsxs(oe,{children:[e.jsx(x,{autoFocus:!0,margin:"dense",label:"Email",type:"email",fullWidth:!0,variant:"outlined",value:g.email,onChange:s=>L({...g,email:s.target.value}),sx:{mb:2}}),e.jsx(x,{margin:"dense",label:"First Name",type:"text",fullWidth:!0,variant:"outlined",value:g.firstName,onChange:s=>L({...g,firstName:s.target.value}),sx:{mb:2}}),e.jsx(x,{margin:"dense",label:"Last Name",type:"text",fullWidth:!0,variant:"outlined",value:g.lastName,onChange:s=>L({...g,lastName:s.target.value}),sx:{mb:2}}),e.jsx(x,{margin:"dense",label:"Password",type:"password",fullWidth:!0,variant:"outlined",value:g.password,onChange:s=>L({...g,password:s.target.value})})]}),e.jsxs(le,{children:[e.jsx(o,{onClick:()=>C(!1),children:"Cancel"}),e.jsx(o,{onClick:we,variant:"contained",children:"Create Admin"})]})]})]})};export{ns as default};
