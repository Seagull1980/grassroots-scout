import{j as e,B as l,i as y,T as i,v as p,w as k,k as K,a6 as Q,G as a,C as R,a as U,I as E,ap as H,ay as V,an as X,cn as Z,d as _,bx as ee,co as re,cp as te,J as ae,K as ne,N as se,O as h,F as B,t as T,u as D,q as m,Q as le}from"./mui-vendor-rZ0WLTig.js";import{r as d}from"./react-vendor-CRXLTmIH.js";import{u as ie,a as C}from"./admin-features-d6LVy8Ft.js";const he=()=>{const{user:v}=ie(),[A,O]=d.useState([]),[W,M]=d.useState(!0),[x,n]=d.useState(""),[S,f]=d.useState(""),[z,g]=d.useState(!1),[u,b]=d.useState(null),[t,N]=d.useState({firstName:"",lastName:"",dateOfBirth:"",gender:"",preferredPosition:"",preferredTeamGender:"Mixed",medicalInfo:"",emergencyContact:"",emergencyPhone:"",schoolName:""}),$=["Goalkeeper","Defender","Midfielder","Forward","Centre-Back","Full-Back","Wing-Back","Defensive Midfielder","Central Midfielder","Attacking Midfielder","Winger","Striker"];d.useEffect(()=>{v?.role==="Parent/Guardian"&&j()},[v]);const j=async()=>{try{M(!0);const r=await C.get("/api/children");O(r.data.children)}catch(r){console.error("Error loading children:",r),n("Failed to load children information")}finally{M(!1)}},I=r=>{const c=new Date,o=new Date(r);let F=c.getFullYear()-o.getFullYear();const G=c.getMonth()-o.getMonth();return(G<0||G===0&&c.getDate()<o.getDate())&&F--,F},s=(r,c)=>{N(o=>({...o,[r]:c}))},q=async()=>{try{if(n(""),!t.firstName||!t.lastName||!t.dateOfBirth){n("Please fill in all required fields");return}const r=I(t.dateOfBirth);if(r>=16){n(`Children must be under 16 years old. This child is ${r} years old and should register their own account.`);return}await C.post("/api/children",t),f("Child added successfully!"),g(!1),P(),j()}catch(r){console.error("Error adding child:",r),n(r.response?.data?.error||"Failed to add child")}},L=async()=>{if(u)try{if(n(""),!t.firstName||!t.lastName||!t.dateOfBirth){n("Please fill in all required fields");return}const r=I(t.dateOfBirth);if(r>=16){n(`Children must be under 16 years old. This child is ${r} years old and should register their own account.`);return}await C.put(`/api/children/${u.id}`,t),f("Child information updated successfully!"),b(null),P(),j()}catch(r){console.error("Error updating child:",r),n(r.response?.data?.error||"Failed to update child information")}},Y=async(r,c)=>{if(confirm(`Are you sure you want to remove ${c}? This will also deactivate any player availability postings for this child.`))try{await C.delete(`/api/children/${r}`),f("Child removed successfully!"),j()}catch(o){console.error("Error deleting child:",o),n(o.response?.data?.error||"Failed to remove child")}},P=()=>{N({firstName:"",lastName:"",dateOfBirth:"",gender:"",preferredPosition:"",preferredTeamGender:"Mixed",medicalInfo:"",emergencyContact:"",emergencyPhone:"",schoolName:""})},J=r=>{b(r),N({firstName:r.firstName,lastName:r.lastName,dateOfBirth:r.dateOfBirth,gender:r.gender||"",preferredPosition:r.preferredPosition||"",preferredTeamGender:r.preferredTeamGender||"Mixed",medicalInfo:r.medicalInfo||"",emergencyContact:r.emergencyContact||"",emergencyPhone:r.emergencyPhone||"",schoolName:r.schoolName||""})},w=()=>{g(!1),b(null),P(),n("")};return v?.role!=="Parent/Guardian"?e.jsx(l,{p:3,children:e.jsx(y,{severity:"error",children:"Access denied. This page is only available to Parent/Guardian accounts."})}):e.jsxs(l,{p:3,children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(i,{variant:"h4",component:"h1",children:"Manage Children"}),e.jsx(p,{variant:"contained",startIcon:e.jsx(k,{}),onClick:()=>g(!0),children:"Add Child"})]}),x&&e.jsx(y,{severity:"error",sx:{mb:2},onClose:()=>n(""),children:x}),S&&e.jsx(y,{severity:"success",sx:{mb:2},onClose:()=>f(""),children:S}),W?e.jsx(i,{children:"Loading children..."}):A.length===0?e.jsxs(K,{sx:{p:3,textAlign:"center"},children:[e.jsx(Q,{sx:{fontSize:64,color:"text.secondary",mb:2}}),e.jsx(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Children Added Yet"}),e.jsx(i,{color:"text.secondary",mb:2,children:"Add your children to manage their football activities and create player availability postings on their behalf."}),e.jsx(p,{variant:"contained",startIcon:e.jsx(k,{}),onClick:()=>g(!0),children:"Add Your First Child"})]}):e.jsx(a,{container:!0,spacing:3,children:A.map(r=>e.jsx(a,{item:!0,xs:12,md:6,lg:4,children:e.jsx(R,{children:e.jsxs(U,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[e.jsxs(i,{variant:"h6",component:"h2",children:[r.firstName," ",r.lastName]}),e.jsxs(l,{children:[e.jsx(E,{size:"small",onClick:()=>J(r),sx:{mr:1},children:e.jsx(H,{})}),e.jsx(E,{size:"small",color:"error",onClick:()=>Y(r.id,`${r.firstName} ${r.lastName}`),children:e.jsx(V,{})})]})]}),e.jsxs(X,{spacing:1,children:[e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(Z,{sx:{mr:1,fontSize:16,color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["Age: ",I(r.dateOfBirth)," years old"]})]}),r.gender&&e.jsxs(i,{variant:"body2",color:"text.secondary",children:["Gender: ",r.gender]}),r.preferredPosition&&e.jsx(l,{children:e.jsx(_,{label:r.preferredPosition,size:"small",variant:"outlined"})}),r.schoolName&&e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(ee,{sx:{mr:1,fontSize:16,color:"text.secondary"}}),e.jsx(i,{variant:"body2",color:"text.secondary",children:r.schoolName})]}),r.emergencyContact&&e.jsxs(l,{display:"flex",alignItems:"center",children:[e.jsx(re,{sx:{mr:1,fontSize:16,color:"text.secondary"}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["Emergency: ",r.emergencyContact]})]}),r.medicalInfo&&e.jsxs(l,{display:"flex",alignItems:"flex-start",children:[e.jsx(te,{sx:{mr:1,fontSize:16,color:"text.secondary",mt:.5}}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["Medical: ",r.medicalInfo.length>50?`${r.medicalInfo.substring(0,50)}...`:r.medicalInfo]})]})]})]})})},r.id))}),e.jsxs(ae,{open:z||u!==null,onClose:w,maxWidth:"md",fullWidth:!0,children:[e.jsx(ne,{children:u?"Edit Child Information":"Add New Child"}),e.jsxs(se,{children:[x&&e.jsx(y,{severity:"error",sx:{mb:2},children:x}),e.jsxs(a,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"First Name",fullWidth:!0,required:!0,value:t.firstName,onChange:r=>s("firstName",r.target.value)})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Last Name",fullWidth:!0,required:!0,value:t.lastName,onChange:r=>s("lastName",r.target.value)})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Date of Birth",type:"date",fullWidth:!0,required:!0,value:t.dateOfBirth,onChange:r=>s("dateOfBirth",r.target.value),InputLabelProps:{shrink:!0},helperText:"Child must be under 16 years old"})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(B,{fullWidth:!0,children:[e.jsx(T,{children:"Gender"}),e.jsxs(D,{value:t.gender,label:"Gender",onChange:r=>s("gender",r.target.value),children:[e.jsx(m,{value:"Male",children:"Male"}),e.jsx(m,{value:"Female",children:"Female"}),e.jsx(m,{value:"Other",children:"Other"})]})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(B,{fullWidth:!0,children:[e.jsx(T,{children:"Preferred Position"}),e.jsx(D,{value:t.preferredPosition,label:"Preferred Position",onChange:r=>s("preferredPosition",r.target.value),children:$.map(r=>e.jsx(m,{value:r,children:r},r))})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(B,{fullWidth:!0,children:[e.jsx(T,{children:"Preferred Team Type"}),e.jsxs(D,{value:t.preferredTeamGender,label:"Preferred Team Type",onChange:r=>s("preferredTeamGender",r.target.value),children:[e.jsx(m,{value:"Boys",children:"Boys Team"}),e.jsx(m,{value:"Girls",children:"Girls Team"}),e.jsx(m,{value:"Mixed",children:"Mixed Team"})]})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"School Name",fullWidth:!0,value:t.schoolName,onChange:r=>s("schoolName",r.target.value)})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Emergency Contact Name",fullWidth:!0,value:t.emergencyContact,onChange:r=>s("emergencyContact",r.target.value)})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(h,{label:"Emergency Contact Phone",fullWidth:!0,value:t.emergencyPhone,onChange:r=>s("emergencyPhone",r.target.value)})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(h,{label:"Medical Information",fullWidth:!0,multiline:!0,rows:3,value:t.medicalInfo,onChange:r=>s("medicalInfo",r.target.value),placeholder:"Any medical conditions, allergies, medications, or special requirements..."})})]})]}),e.jsxs(le,{children:[e.jsx(p,{onClick:w,children:"Cancel"}),e.jsxs(p,{onClick:u?L:q,variant:"contained",children:[u?"Update":"Add"," Child"]})]})]})]})};export{he as default};
