# Northflank Deployment Guide

## Prerequisites
1. Northflank account
2. GitHub repository connected to Northflank
3. PostgreSQL database (recommended for production)

## Deployment Steps

### 1. Connect Repository
- Go to Northflank dashboard
- Connect your GitHub repository: `grassroots-scout`

### 2. Create Services

#### Frontend + Backend Service
- **Service Type**: Combined (Full-stack)
- **Build Context**: `/` (root directory)
- **Dockerfile Path**: `./Dockerfile`
- **Port**: `3001`

#### Database Service (Optional - if not using Northflank managed DB)
- **Service Type**: PostgreSQL
- **Version**: 15 or latest

### 3. Environment Variables

Set these environment variables in your Northflank service:

#### Required
```
NODE_ENV=production
JWT_SECRET=<generate-a-secure-random-string>
DATABASE_URL=<your-postgresql-connection-string>
```

#### API Keys (get from respective services)
```
VITE_GOOGLE_MAPS_API_KEY=<your-google-maps-api-key>
VITE_GOOGLE_CLIENT_ID=<your-google-oauth-client-id>
VITE_OUTLOOK_CLIENT_ID=<your-outlook-client-id>
```

#### Email Configuration
```
EMAIL_USER=<your-email-username>
EMAIL_PASS=<your-email-password>
```

#### URLs (will be auto-generated by Northflank)
```
FRONTEND_URL=<auto-generated-by-northflank>
VITE_API_URL=<auto-generated-by-northflank>
```

### 4. Build Settings
- **Build Command**: Automatically handled by Dockerfile
- **Start Command**: `npm start`
- **Health Check**: `/api/health` (if you add this endpoint)

### 5. Domain Configuration
- Add your custom domain in Northflank
- Update DNS records as instructed

## Database Setup

If using Northflank managed PostgreSQL:
1. Create a PostgreSQL service in Northflank
2. Copy the connection string to `DATABASE_URL`
3. The database will be automatically created and migrated on first run

## Troubleshooting

### Build Issues
- Check that all dependencies are properly listed in package.json
- Ensure the Dockerfile is in the root directory

### Runtime Issues
- Check environment variables are set correctly
- Verify database connectivity
- Check application logs in Northflank dashboard

### Common Errors
- **Port conflicts**: Ensure your app listens on the PORT environment variable
- **Database connection**: Verify DATABASE_URL format
- **API keys**: Ensure all required API keys are set